<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grille d'√©valuation ECOS - [Titre de la station]</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); }
        .header { background: #2c5aa0; color: white; padding: 15px; margin: -20px -20px 20px -20px; border-radius: 8px 8px 0 0; }
        
        /* MINUTEUR */
        .timer-container {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.75);
            border: 3px solid #2c5aa0;
            border-radius: 15px;
            padding: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            z-index: 1000;
            text-align: center;
            min-width: 200px;
            backdrop-filter: blur(1px);
        }
        .timer-display {
            font-size: 40px;
            font-weight: bold;
            color: #2c5aa0;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
        }
        .timer-controls {
            display: flex;
            gap: 8px;
            justify-content: center;
        }
        .timer-btn {
            padding: 6px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 12px;
        }
        .start-btn {
            background: #28a745;
            color: white;
        }
        .start-btn:hover {
            background: #218838;
        }
        .stop-btn {
            background: #dc3545;
            color: white;
        }
        .stop-btn:hover {
            background: #c82333;
        }
        .reset-btn {
            background: #6c757d;
            color: white;
        }
        .reset-btn:hover {
            background: #5a6268;
        }
        .timer-status {
            margin-top: 10px;
            font-size: 14px;
            font-weight: bold;
        }
        .status-waiting { color: #6c757d; }
        .status-running { color: #28a745; }
        .status-warning { color: #ffc107; }
        .status-finished { color: #dc3545; }
        
        /* ANIMATIONS MINUTEUR */
        .timer-warning {
            animation: pulse-warning 1s infinite;
        }
        .timer-critical {
            animation: pulse-critical 0.5s infinite;
        }
        @keyframes pulse-warning {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes pulse-critical {
            0%, 100% { transform: scale(1); border-color: #dc3545; }
            50% { transform: scale(1.1); border-color: #ff0000; }
        }
        
        .section { margin-bottom: 30px; border: 1px solid #ddd; border-radius: 8px; overflow: hidden; }
        .section-header { background: #f8f9fa; padding: 15px; font-weight: bold; font-size: 18px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; }
        .section-content { padding: 15px; }
        .header-row { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px; gap: 10px; padding: 10px 0; border-bottom: 2px solid #ddd; font-weight: bold; text-align: center; }
        .header-row div:first-child { text-align: left; }
        .criteria-row { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px; gap: 10px; align-items: start; padding: 15px 0; border-bottom: 1px solid #eeeeee; }
        .criteria-row:last-child { border-bottom: none; }
        .criteria-text { font-weight: 500; }
        .sub-criteria { font-size: 0.9em; color: #666; margin-top: 5px; padding-left: 18px; line-height: 1.2; }
        .patient-response { font-size: 0.9em; color: rgba(44, 90, 160, 0.65); }
        .checkbox-group { text-align: center; }
        .points-display { text-align: center; font-weight: bold; color: #2c5aa0; font-size: 18px; }
        .scoring-rule { font-size: 0.85em; color: #888; font-style: italic; margin-top: 8px; padding-left: 20px; }
        input[type="radio"] { cursor: pointer; transform: scale(1.2); }
        input[type="radio"]:disabled { opacity: 0.3; cursor: not-allowed; }
        
        /* COLORATION POST-MINUTEUR */
        .criteria-zero-points {
            background-color: rgba(251, 234, 234, 0.6) !important;
        }
        .criteria-one-point {
            background-color: rgba(253, 245, 230, 0.6) !important;
        }
        .criteria-full-points {
            background-color: rgba(230, 244, 234, 0.6) !important;
        }
        .criteria-not-answered {
            background-color: rgba(240, 248, 255, 0.6) !important;
        }
        
        /* COLORATION COMMUNICATION */
        .communication-note-a {
            background-color: rgba(230, 244, 234, 0.6) !important;
        }
        .communication-note-b {
            background-color: rgba(233, 243, 253, 0.6) !important;
        }
        .communication-note-c {
            background-color: rgba(253, 245, 230, 0.6) !important;
        }
        .communication-note-d {
            background-color: rgba(252, 238, 227, 0.6) !important;
        }
        .communication-note-e {
            background-color: rgba(251, 234, 234, 0.6) !important;
        }
        .communication-not-answered {
            background-color: rgba(240, 248, 255, 0.6) !important;
        }
        
        .score { font-weight: bold; color: hsl(216, 57%, 40%); font-size: 18px; }
        .total-sections { display: grid; grid-template-columns: 1fr 2fr 1fr; gap: 20px; margin-bottom: 30px; }
        .total-section { display: flex; flex-direction: column; justify-content: space-between; text-align: center; background: #f0f8ff; border: 1px solid #ddd; border-radius: 8px; transition: all 0.3s; }
        .total-label { background: #f8f9fa; padding: 5px; font-weight: bold; font-size: 20px; border-bottom: 1px solid #ddd; }
        .total-body { flex: 1; display: flex; align-items: center; justify-content: center; padding: 5px; }
        .total-pourcent-body { flex: 1; padding: 10px; }
        .total-score, .total-note-globale { font-size: 56px; font-weight: bold; line-height: 1; }
        .total-pourcent-sections { display: flex; flex-wrap: nowrap; gap: 10px; height: 100%; align-items: stretch; }
        .total-pourcent-section { flex: 1 1 auto; min-width: 0; display: flex; flex-direction: column; text-align: center; background: #416caa; padding: 10px; border-radius: 5px; transition: all 0.3s; border: none; }
        .total-pourcent-section:last-child { border-right: none; }
        .total-section-label { color: #eeeeee; font-size: 14px; font-weight: normal; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .pourcent-body { flex: 1; display: flex; align-items: center; justify-content: center; }
        .total-pourcent-value { font-weight: bold; font-size: 28px; line-height: 1; color: white; transition: all 0.3s; }
        .note-a { background-color: #e6f4ea; color: #2c974b; }
        .note-a.total-pourcent-section { background-color: #2c974b; }
        .note-b { background-color: #e9f3fd; color: #4e9cf0; }
        .note-b.total-pourcent-section { background-color: #4e9cf0; }
        .note-c { background-color: #fdf5e6; color: #f0ad4e; }
        .note-c.total-pourcent-section { background-color: #f0ad4e; }
        .note-d { background-color: #fceee3; color: #e67e22; }
        .note-d.total-pourcent-section { background-color: #e67e22; }
        .note-e { background-color: #fbeaea; color: #d9534f; }
        .note-e.total-pourcent-section { background-color: #d9534f; }
        .note-neutral { background-color: #f0f8ff; color: #2c5aa0; }
        .note-neutral.total-pourcent-section { background-color: #6B8BC3; }
        .note-a.total-pourcent-body { background-color: #e6f4ea; }
        .note-b.total-pourcent-body { background-color: #e9f3fd; }
        .note-c.total-pourcent-body { background-color: #fdf5e6; }
        .note-d.total-pourcent-body { background-color: #fceee3; }
        .note-e.total-pourcent-body { background-color: #fbeaea; }
        .note-neutral.total-pourcent-body { background-color: #f0f8ff; }
        .grade-scale { margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; }
        .grade-scale h3 { margin-top: 0; }
        .grade-row { display: flex; justify-content: space-between; padding: 5px 0; }
        .missing-items { background: #fff3cd; border: 1px solid #ffeeba; color: #856404; padding: 15px; border-radius: 8px; margin-top: 20px; }
        .missing-items h3 { margin-top: 0; }
        .missing-item { color: #dc3545; font-weight: bold; }
        .annexes { margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #ddd; }
        .annexes h3 { margin-top: 0; color: #2c5aa0; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        .annexe-item { margin: 20px 0; padding: 15px; background: white; border-radius: 5px; border: 1px solid #e0e0e0; }
        .annexe-title { font-weight: bold; color: #2c5aa0; margin-bottom: 8px; font-size: 16px; }
        .annexe-description { color: #666; font-style: italic; margin-bottom: 10px; font-size: 14px; }
        .annexe-image { text-align: center; margin: 10px 0; }
        .annexe-image img { max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .annexe-document { background: #f0f8ff; padding: 10px; border-radius: 4px; border-left: 4px solid #2c5aa0; white-space: pre-wrap; font-family: "Courier New", monospace; font-size: 13px; }
        .communication-section { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px 80px; gap: 10px; align-items: start; padding: 15px 0; border-bottom: 1px solid #eee; }
        .communication-text { font-weight: 500; }
        .communication-desc { font-size: 0.85em; color: #666; margin-top: 5px; font-style: italic; }
        .scale-header { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px 80px; gap: 10px; font-weight: bold; text-align: center; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 2px solid #ddd; }
        .scale-header div:first-child { text-align: left; }
        .vital-signs { margin-top: 10px; margin-bottom: 0px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; font-size: 0.9em; }
        .vital-sign { text-align: center; background: #416caa; padding: 10px; border-radius: 5px; }
        .vital-sign-label { color: #eeeeee; }
        .vital-sign-value { color: rgb(255, 255, 255); margin-top: 2px; }
        .dd-section { background: #f0f8ff; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .dd-title { font-weight: bold; margin-bottom: 10px; color: #2c5aa0; }
        .dd-category { margin: 10px 0; font-weight: bold; }
        .dd-item { margin-left: 20px; margin-bottom: 5px; font-weight: normal; }
        .dd-test { color: #666; font-style: italic; margin-left: 10px; }
        .therapy-section { background: #f8f9fa; padding: 10px; margin: 5px 0; border-radius: 5px; }
        .therapy-title { font-weight: bold; margin-bottom: 5px; }
        
        .print-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2c5aa0;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 4px 12px rgba(44, 90, 160, 0.3);
            z-index: 1000;
        }
        .print-button:hover {
            background: #1e3f70;
        }
        @media print {
            .timer-container, .print-button {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- MINUTEUR -->
    <div class="timer-container" id="timerContainer">
        <div class="timer-display" id="timerDisplay">13:00</div>
        <div class="timer-controls">
            <button class="timer-btn start-btn" id="startBtn" onclick="startTimer()">‚ñ∂ D√©marrer</button>
            <button class="timer-btn stop-btn" id="stopBtn" onclick="stopTimer()" style="display: none;">‚è∏ Arr√™ter</button>
            <button class="timer-btn reset-btn" id="resetBtn" onclick="resetTimer()">üîÑ Reset</button>
        </div>
        <div class="timer-status status-waiting" id="timerStatus">En attente</div>
    </div>

    <div class="container">
        <div class="header">
            <h1>Grille d'√©valuation ECOS - [Titre de la station]</h1>
            <p style="margin: 5px 0;">Contexte : [Type de cabinet/service]</p>
            <p style="margin: 5px 0;">Patient : [Nom], [√¢ge] ans, se pr√©sente chez [praticien] avec [motif de consultation]</p>
            <div class="vital-signs">
                <div class="vital-sign">
                    <div class="vital-sign-label">TA</div>
                    <div class="vital-sign-value">[valeur] mmHg</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">FC</div>
                    <div class="vital-sign-value">[valeur] bpm</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">FR</div>
                    <div class="vital-sign-value">[valeur]/min</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">T¬∞</div>
                    <div class="vital-sign-value">[valeur]¬∞C</div>
                </div>
            </div>
        </div>
        
        <!-- ANAMN√àSE -->
        <div class="section">
            <div class="section-header">
                <span>Anamn√®se (40%)</span>
                <span class="score">Score : <span id="anamneseScore">0</span>/6</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Crit√®res</div>
                    <div>Oui</div>
                    <div>¬±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
                <div class="criteria-row" id="criteria-a1">
                    <div>
                        <div class="criteria-text">1. [Crit√®re anamn√®se 1] <span class="patient-response">([R√©ponse attendue du patient/accompagnant])</span></div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="a1" value="2" data-criteria="[Crit√®re anamn√®se 1]" onchange="updateScore('a', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" disabled style="visibility: hidden;" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="a1" value="0" onchange="updateScore('a', this)" />
                    </div>
                    <div class="points-display" id="points-a1">0</div>
                </div>
                <div class="criteria-row" id="criteria-a2">
                    <div>
                        <div class="criteria-text">2. [Crit√®re anamn√®se 2] <span class="patient-response">([R√©ponse attendue du patient/accompagnant])</span></div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="a2" value="2" data-criteria="[Crit√®re anamn√®se 2]" onchange="updateScore('a', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" disabled style="visibility: hidden;" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="a2" value="0" onchange="updateScore('a', this)" />
                    </div>
                    <div class="points-display" id="points-a2">0</div>
                </div>
                <div class="criteria-row" id="criteria-a3">
                    <div>
                        <div class="criteria-text">3. [Crit√®re anamn√®se 3] <span class="patient-response">([R√©ponse attendue du patient/accompagnant])</span></div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="a3" value="2" data-criteria="[Crit√®re anamn√®se 3]" onchange="updateScore('a', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="a3" value="1" onchange="updateScore('a', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="a3" value="0" onchange="updateScore('a', this)" />
                    </div>
                    <div class="points-display" id="points-a3">0</div>
                </div>
            </div>
        </div>
        
        <!-- EXAMEN CLINIQUE -->
        <div class="section">
            <div class="section-header">
                <span>Examen clinique (30%)</span>
                <span class="score">Score : <span id="statusScore">0</span>/4</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Crit√®res</div>
                    <div>Oui</div>
                    <div>¬±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
                <div class="criteria-row" id="criteria-e1">
                    <div>
                        <div class="criteria-text">1. [Crit√®re examen 1] <span class="patient-response">([R√©sultat attendu de l'examen])</span></div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="e1" value="2" data-criteria="[Crit√®re examen 1]" onchange="updateScore('e', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="e1" value="1" onchange="updateScore('e', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="e1" value="0" onchange="updateScore('e', this)" />
                    </div>
                    <div class="points-display" id="points-e1">0</div>
                </div>
                <div class="criteria-row" id="criteria-e2">
                    <div>
                        <div class="criteria-text">2. [Crit√®re examen 2] <span class="patient-response">([R√©sultat attendu de l'examen])</span></div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="e2" value="2" data-criteria="[Crit√®re examen 2]" onchange="updateScore('e', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" disabled style="visibility: hidden;" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="e2" value="0" onchange="updateScore('e', this)" />
                    </div>
                    <div class="points-display" id="points-e2">0</div>
                </div>
            </div>
        </div>
        
        <!-- MANAGEMENT -->
        <div class="section">
            <div class="section-header">
                <span>Management (20%)</span>
                <span class="score">Score : <span id="managementScore">0</span>/8</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Crit√®res</div>
                    <div>Oui</div>
                    <div>¬±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
                <div class="criteria-row" id="criteria-m1">
                    <div>
                        <div class="criteria-text">1. [Crit√®re management 1] <span class="patient-response">([Information compl√©mentaire si n√©cessaire])</span></div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="m1" value="2" data-criteria="[Crit√®re management 1]" onchange="updateScore('m', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="m1" value="1" onchange="updateScore('m', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="m1" value="0" onchange="updateScore('m', this)" />
                    </div>
                    <div class="points-display" id="points-m1">0</div>
                </div>
                <div class="criteria-row" id="criteria-m2">
                    <div>
                        <div class="criteria-text">2. [Crit√®re management 2]</div>
                        <div class="scoring-rule">[R√®gle de notation sp√©cifique]</div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="m2" value="2" data-criteria="[Crit√®re management 2]" onchange="updateScore('m', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="m2" value="1" onchange="updateScore('m', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="m2" value="0" onchange="updateScore('m', this)" />
                    </div>
                    <div class="points-display" id="points-m2">0</div>
                </div>
                <div class="criteria-row" id="criteria-m3">
                    <div>
                        <div class="criteria-text">3. [Crit√®re management avec examens compl√©mentaires] <span class="patient-response">([Examens compl√©mentaires appropri√©s])</span></div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="m3" value="2" data-criteria="[Crit√®re management avec examens compl√©mentaires]" onchange="updateScore('m', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" disabled style="visibility: hidden;" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="m3" value="0" onchange="updateScore('m', this)" />
                    </div>
                    <div class="points-display" id="points-m3">0</div>
                </div>
                <div class="criteria-row" id="criteria-m4">
                    <div>
                        <div class="criteria-text">4. [Crit√®re management avec th√©rapeutique]</div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="m4" value="2" data-criteria="[Crit√®re management avec th√©rapeutique]" onchange="updateScore('m', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="m4" value="1" onchange="updateScore('m', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="m4" value="0" onchange="updateScore('m', this)" />
                    </div>
                    <div class="points-display" id="points-m4">0</div>
                </div>
            </div>
        </div>
        
        <!-- COMMUNICATION -->
        <div class="section">
            <div class="section-header">
                <span>Communication (10%)</span>
                <span class="score">Score : <span id="communicationScore">0</span>/16</span>
            </div>
            <div class="section-content">
                <div class="scale-header">
                    <div>Crit√®res</div>
                    <div>A</div>
                    <div>B</div>
                    <div>C</div>
                    <div>D</div>
                    <div>E</div>
                </div>
                <div class="communication-section" id="criteria-c1">
                    <div>
                        <div class="communication-text">1. R√©ponse aux sentiments du patient</div>
                        <div class="communication-desc">Empathie, √©coute active, validation des √©motions</div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="A" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="B" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="C" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="D" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="E" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c2">
                    <div>
                        <div class="communication-text">2. Structure de l'entretien</div>
                        <div class="communication-desc">Organisation logique, transitions fluides, gestion du temps</div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="A" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="B" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="C" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="D" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="E" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c3">
                    <div>
                        <div class="communication-text">3. Expression verbale</div>
                        <div class="communication-desc">Clart√©, vocabulaire adapt√©, v√©rification de la compr√©hension</div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="A" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="B" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="C" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="D" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="E" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c4">
                    <div>
                        <div class="communication-text">4. Expression non verbale</div>
                        <div class="communication-desc">Contact visuel, posture, gestuelle appropri√©e</div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="A" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="B" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="C" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="D" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="E" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
            </div>
        </div>
        
        <!-- TOTAUX -->
        <div class="total-sections">
            <div class="total-section">
                <div class="total-label">Score Global</div>
                <div class="total-body">
                    <div class="total-score" id="totalScore">0/34</div>
                </div>
            </div>
            <div class="total-section">
                <div class="total-label">% par Section</div>
                <div class="total-pourcent-body">
                    <div class="total-pourcent-sections">
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Anamn√®se</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="anamnese-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Examen clinique</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="examen-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Management</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="management-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Communication</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="communication-percentage">0</span>%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="total-section">
                <div class="total-label">Note Globale</div>
                <div class="total-body">
                    <div class="total-note-globale" id="globalGrade">E</div>
                </div>
            </div>
        </div>
        
        <!-- √âCHELLE DE NOTATION -->
        <div class="grade-scale">
            <h3>√âchelle de notation</h3>
            <div class="grade-row">
                <span>A (Excellent)</span>
                <span>‚â• 31 points (90%)</span>
            </div>
            <div class="grade-row">
                <span>B (Tr√®s bien)</span>
                <span>27-30 points (80-89%)</span>
            </div>
            <div class="grade-row">
                <span>C (Bien)</span>
                <span>24-26 points (70-79%)</span>
            </div>
            <div class="grade-row">
                <span>D (Suffisant)</span>
                <span>20-23 points (60-69%)</span>
            </div>
            <div class="grade-row">
                <span>E (Insuffisant)</span>
                <span>&lt; 20 points (&lt; 60%)</span>
            </div>
        </div>
        
        <!-- √âL√âMENTS MANQUANTS -->
        <div class="missing-items" id="missingItems" style="display: none;">
            <h3>√âl√©ments non √©valu√©s</h3>
            <div id="missingList"></div>
        </div>
    </div>

    <button class="print-button" onclick="window.print()">üñ®Ô∏è Imprimer en PDF</button>

    <script>
        // Variables globales pour le minuteur
        let timerInterval;
        let totalSeconds = 13 * 60; // 13 minutes
        let currentSeconds = totalSeconds;
        let isRunning = false;
        let hasStarted = false;
        let hasFinished = false;
        let hasStoppedManually = false;

        // Fonction pour cr√©er les sons avec synth√®se vocale
        function playBeep() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'fr-FR';
                utterance.rate = 0.9;
                utterance.volume = 0.8;
                speechSynthesis.speak(utterance);
            }
        }

        function playSound(message) {
            playBeep();
            setTimeout(() => speak(message), 500);
        }

        // Fonction pour formater le temps
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${minutes}:${secs.toString().padStart(2, '0')}`;
        }

        // Fonction pour activer/d√©sactiver les checkboxes
        function toggleCheckboxes(disabled) {
            const checkboxes = document.querySelectorAll('input[type="radio"]');
            checkboxes.forEach(checkbox => {
                checkbox.disabled = disabled;
            });
        }

        // Fonction pour colorer les crit√®res apr√®s la fin du minuteur ou arr√™t manuel
        function colorCriteriaByScore() {
            if (!hasFinished && !hasStoppedManually) return;

            // Pour les crit√®res normaux (anamn√®se, examen, management)
            const normalCriteriaRows = document.querySelectorAll('.criteria-row');
            normalCriteriaRows.forEach(row => {
                const id = row.id;
                if (!id) return;
                
                const criteriaName = id.replace('criteria-', '');
                const checkedRadio = document.querySelector(`input[name="${criteriaName}"]:checked`);
                
                // Supprimer les classes de couleur existantes
                row.classList.remove('criteria-zero-points', 'criteria-one-point', 'criteria-full-points', 'criteria-not-answered');
                
                if (checkedRadio) {
                    const score = Number(checkedRadio.value) || 0;
                    
                    // Appliquer la couleur selon le score
                    if (score === 0) {
                        row.classList.add('criteria-zero-points');
                    } else if (score === 1) {
                        row.classList.add('criteria-one-point');
                    } else if (score >= 2) {
                        row.classList.add('criteria-full-points');
                    }
                } else {
                    // Pas de r√©ponse
                    row.classList.add('criteria-not-answered');
                }
            });

            // Pour les crit√®res de communication
            const communicationRows = document.querySelectorAll('.communication-section');
            communicationRows.forEach(row => {
                const id = row.id;
                if (!id) return;
                
                const criteriaName = id.replace('criteria-', '');
                const checkedRadio = document.querySelector(`input[name="${criteriaName}"]:checked`);
                
                // Supprimer les classes de couleur existantes
                row.classList.remove('communication-note-a', 'communication-note-b', 'communication-note-c', 'communication-note-d', 'communication-note-e', 'communication-not-answered');
                
                if (checkedRadio) {
                    const grade = checkedRadio.value.toLowerCase();
                    row.classList.add(`communication-note-${grade}`);
                } else {
                    // Pas de r√©ponse
                    row.classList.add('communication-not-answered');
                }
            });
        }

        // Fonctions du minuteur
        function startTimer() {
            if (isRunning) return;
            
            isRunning = true;
            hasStarted = true;
            hasStoppedManually = false;
            
            // Activer les checkboxes pendant le minuteur
            toggleCheckboxes(false);
            
            // Jouer le son de d√©but
            playSound("D√©but de la station");
            
            // Mise √† jour de l'interface
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('stopBtn').style.display = 'inline-block';
            document.getElementById('timerStatus').textContent = 'En cours';
            document.getElementById('timerStatus').className = 'timer-status status-running';
            
            timerInterval = setInterval(() => {
                currentSeconds--;
                document.getElementById('timerDisplay').textContent = formatTime(currentSeconds);
                
                const container = document.getElementById('timerContainer');
                
                // V√©rifier les moments cl√©s
                if (currentSeconds === 2 * 60) { // 11 minutes √©coul√©es, 2 minutes restantes
                    playSound("Il vous reste 2 minutes");
                    container.classList.add('timer-warning');
                    document.getElementById('timerStatus').textContent = '2 min restantes';
                    document.getElementById('timerStatus').className = 'timer-status status-warning';
                }
                
                if (currentSeconds <= 30) {
                    container.classList.add('timer-critical');
                }
                
                if (currentSeconds <= 0) {
                    endTimer();
                }
            }, 1000);
        }

        function stopTimer() {
            if (!isRunning) return;
            
            clearInterval(timerInterval);
            isRunning = false;
            hasStoppedManually = true;
            
            // D√©sactiver les checkboxes apr√®s arr√™t manuel
            toggleCheckboxes(true);
            
            // Appliquer la coloration des crit√®res
            colorCriteriaByScore();
            
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            document.getElementById('timerStatus').textContent = 'Arr√™t√©';
            document.getElementById('timerStatus').className = 'timer-status status-waiting';
            
            const container = document.getElementById('timerContainer');
            container.classList.remove('timer-warning', 'timer-critical');
        }

        function endTimer() {
            clearInterval(timerInterval);
            isRunning = false;
            hasFinished = true;
            currentSeconds = 0;
            
            // Jouer le son de fin
            playSound("Fin de la station. Veuillez sortir");
            
            // Garder les checkboxes d√©sactiv√©es
            toggleCheckboxes(true);
            
            // Appliquer la coloration des crit√®res
            colorCriteriaByScore();
            
            document.getElementById('timerDisplay').textContent = formatTime(0);
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('stopBtn').style.display = 'none';
            document.getElementById('timerStatus').textContent = 'Termin√©';
            document.getElementById('timerStatus').className = 'timer-status status-finished';
            
            const container = document.getElementById('timerContainer');
            container.classList.add('timer-critical');
        }

        function resetTimer() {
            clearInterval(timerInterval);
            isRunning = false;
            hasStarted = false;
            hasFinished = false;
            hasStoppedManually = false;
            currentSeconds = totalSeconds;
            
            // D√©sactiver les checkboxes (√©tat initial)
            toggleCheckboxes(true);
            
            // Supprimer toutes les s√©lections de checkboxes
            const allRadios = document.querySelectorAll('input[type="radio"]');
            allRadios.forEach(radio => {
                radio.checked = false;
            });
            
            // Remettre tous les points √† z√©ro
            const allPointsDisplays = document.querySelectorAll('.points-display');
            allPointsDisplays.forEach(display => {
                display.textContent = '0';
            });
            
            // Supprimer la coloration des crit√®res
            const allCriteriaRows = document.querySelectorAll('.criteria-row, .communication-section');
            allCriteriaRows.forEach(row => {
                row.classList.remove('criteria-zero-points', 'criteria-one-point', 'criteria-full-points', 'criteria-not-answered');
                row.classList.remove('communication-note-a', 'communication-note-b', 'communication-note-c', 'communication-note-d', 'communication-note-e', 'communication-not-answered');
            });
            
            // Recalculer les scores pour remettre √† z√©ro
            calculateScores();
            
            document.getElementById('timerDisplay').textContent = formatTime(totalSeconds);
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            document.getElementById('timerStatus').textContent = 'En attente';
            document.getElementById('timerStatus').className = 'timer-status status-waiting';
            
            const container = document.getElementById('timerContainer');
            container.classList.remove('timer-warning', 'timer-critical');
        }

        // Initialisation: d√©sactiver les checkboxes au chargement
        document.addEventListener('DOMContentLoaded', function() {
            toggleCheckboxes(true);
        });

        // Fonctions de scoring originales (modifi√©es pour inclure la coloration)
        function updateScore(section, element) {
            const value = element.value;
            const name = element.name;
            let pointValue;

            if (section === "communication") {
                const map = { A: 4, B: 3, C: 2, D: 1, E: 0 };
                pointValue = map[value] || 0;
            } else {
                pointValue = Number(value) || 0;
            }

            const pointsElement = document.getElementById("points-" + name);
            if (pointsElement) {
                pointsElement.textContent = pointValue;
            }

            calculateScores();
            
            // Appliquer la coloration si le minuteur est termin√© ou arr√™t√© manuellement
            if (hasFinished || hasStoppedManually) {
                colorCriteriaByScore();
            }
        }

        function calculateScores() {
            let anamneseScore = 0, statusScore = 0, managementScore = 0, communicationScore = 0;
            const maxAnamnese = 6;
            const maxStatus = 4;
            const maxManagement = 8;
            const maxCommunication = 16;
            const missingItems = [];

            const coef = {
                anamnese: 0.4,
                status: 0.3,
                management: 0.2,
                communication: 0.1
            };

            // Anamn√®se
            for (let i = 1; i <= 3; i++) {
                const radio = document.querySelector("input[name=\"a" + i + "\"]:checked");
                if (radio) {
                    anamneseScore += Number(radio.value) || 0;
                } else {
                    const criteria = document.querySelector("input[name=\"a" + i + "\"][data-criteria]");
                    if (criteria) missingItems.push("Anamn√®se : " + criteria.dataset.criteria);
                }
            }
            document.getElementById("anamneseScore").textContent = anamneseScore;

            // Examen clinique
            for (let i = 1; i <= 2; i++) {
                const radio = document.querySelector("input[name=\"e" + i + "\"]:checked");
                if (radio) {
                    statusScore += Number(radio.value) || 0;
                } else {
                    const criteria = document.querySelector("input[name=\"e" + i + "\"][data-criteria]");
                    if (criteria) missingItems.push("Examen clinique : " + criteria.dataset.criteria);
                }
            }
            document.getElementById("statusScore").textContent = statusScore;

            // Management
            for (let i = 1; i <= 4; i++) {
                const radio = document.querySelector("input[name=\"m" + i + "\"]:checked");
                if (radio) {
                    managementScore += Number(radio.value) || 0;
                } else {
                    const criteria = document.querySelector("input[name=\"m" + i + "\"][data-criteria]");
                    if (criteria) missingItems.push("Management : " + criteria.dataset.criteria);
                }
            }
            document.getElementById("managementScore").textContent = managementScore;

            // Communication
            for (let i = 1; i <= 4; i++) {
                const radio = document.querySelector("input[name=\"c" + i + "\"]:checked");
                if (radio) {
                    const val = radio.value;
                    const map = { A: 4, B: 3, C: 2, D: 1, E: 0 };
                    communicationScore += map[val] || 0;
                } else {
                    const criteria = document.querySelector("input[name=\"c" + i + "\"][data-criteria]");
                    if (criteria) missingItems.push("Communication : " + criteria.dataset.criteria);
                }
            }
            document.getElementById("communicationScore").textContent = communicationScore;

            // Calcul des pourcentages et note globale
            const anamneseP = (anamneseScore / maxAnamnese) * 100;
            const statusP = (statusScore / maxStatus) * 100;
            const managementP = (managementScore / maxManagement) * 100;
            const communicationP = (communicationScore / maxCommunication) * 100;

            const globalPercentage = anamneseP * coef.anamnese + statusP * coef.status + managementP * coef.management + communicationP * coef.communication;

            const isStarted = anamneseScore + statusScore + managementScore + communicationScore > 0;

            const totalScoreText = isStarted ? Math.round(globalPercentage) : 0;
            document.getElementById("totalScore").textContent = totalScoreText + "%";

            document.getElementById("anamnese-percentage").textContent = Math.round(anamneseP);
            document.getElementById("examen-percentage").textContent = Math.round(statusP);
            document.getElementById("management-percentage").textContent = Math.round(managementP);
            document.getElementById("communication-percentage").textContent = Math.round(communicationP);

            const gradeElement = document.getElementById("globalGrade");
            const scoreBody = document.getElementById("totalScore").closest(".total-body");
            const gradeBody = gradeElement.closest(".total-body");
            const sections = ["anamnese", "examen", "management", "communication"];

            const allClasses = ["note-a", "note-b", "note-c", "note-d", "note-e", "note-neutral"];

            function getClass(p) {
                if (p === 0) return "note-neutral";
                if (p >= 90) return "note-a";
                if (p >= 80) return "note-b";
                if (p >= 70) return "note-c";
                if (p >= 60) return "note-d";
                return "note-e";
            }

            const gradeClass = getClass(globalPercentage);
            const gradeLabel = isStarted ? gradeClass.split("-")[1].toUpperCase() : "A-E";
            gradeElement.textContent = gradeLabel;

            const pourcentBody = document.querySelector(".total-pourcent-body");

            [gradeElement, scoreBody, gradeBody, pourcentBody].forEach(el => {
                el.classList.remove(...allClasses);
                el.classList.add(gradeClass);
            });

            sections.forEach(id => {
                const value = parseInt(document.getElementById(id + "-percentage").textContent);
                const section = document.getElementById(id + "-percentage").closest(".total-pourcent-section");
                const sectionClass = getClass(value);
                section.classList.remove(...allClasses);
                section.classList.add(sectionClass);
            });

            // Gestion des √©l√©ments manquants
            if (missingItems.length > 0) {
                document.getElementById("missingItems").style.display = "block";
                document.getElementById("missingList").innerHTML = missingItems.map(item =>
                    "<div class=\"missing-item\">‚Ä¢ " + item + "</div>"
                ).join("");
            } else {
                document.getElementById("missingItems").style.display = "none";
            }
        }

        // Initialisation
        calculateScores();
    </script>
</body>
</html>
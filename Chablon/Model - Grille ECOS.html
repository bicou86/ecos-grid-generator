<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grille d'évaluation ECOS - [Titre de la station]</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); }
        .header { background: #2c5aa0; color: white; padding: 15px; margin: -20px -20px 20px -20px; border-radius: 8px 8px 0 0; }
        .section { margin-bottom: 30px; border: 1px solid #ddd; border-radius: 8px; overflow: hidden; }
        .section-header { background: #f8f9fa; padding: 15px; font-weight: bold; font-size: 18px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; }
        .section-content { padding: 15px; }
        .header-row { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px; gap: 10px; padding: 10px 0; border-bottom: 2px solid #ddd; font-weight: bold; text-align: center; }
        .header-row div:first-child { text-align: left; }
        .criteria-row { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px; gap: 10px; align-items: start; padding: 15px 0; border-bottom: 1px solid #eeeeee; }
        .criteria-row:last-child { border-bottom: none; }
        .criteria-text { font-weight: 500; }
        .sub-criteria { font-size: 0.9em; color: #666; margin-top: 5px; padding-left: 18px; line-height: 1.2; }
        .patient-response { font-size: 0.9em; color: rgba(44, 90, 160, 0.65); }
        .checkbox-group { text-align: center; }
        .points-display { text-align: center; font-weight: bold; color: #2c5aa0; font-size: 18px; }
        .scoring-rule { font-size: 0.85em; color: #888; font-style: italic; margin-top: 8px; padding-left: 20px; }
        input[type="radio"] { cursor: pointer; transform: scale(1.2); }
        input[type="radio"]:disabled { opacity: 0.3; cursor: not-allowed; }
        .score { font-weight: bold; color: hsl(216, 57%, 40%); font-size: 18px; }
        .total-sections { display: grid; grid-template-columns: 1fr 2fr 1fr; gap: 20px; margin-bottom: 30px; }
        .total-section { display: flex; flex-direction: column; justify-content: space-between; text-align: center; background: #f0f8ff; border: 1px solid #ddd; border-radius: 8px; transition: all 0.3s; }
        .total-label { background: #f8f9fa; padding: 5px; font-weight: bold; font-size: 20px; border-bottom: 1px solid #ddd; }
        .total-body { flex: 1; display: flex; align-items: center; justify-content: center; padding: 5px; }
        .total-pourcent-body { flex: 1; padding: 10px; }
        .total-score, .total-note-globale { font-size: 56px; font-weight: bold; line-height: 1; }
        .total-pourcent-sections { display: flex; flex-wrap: nowrap; gap: 10px; height: 100%; align-items: stretch; }
        .total-pourcent-section { flex: 1 1 auto; min-width: 0; display: flex; flex-direction: column; text-align: center; background: #416caa; padding: 10px; border-radius: 5px; transition: all 0.3s; border: none; }
        .total-pourcent-section:last-child { border-right: none; }
        .total-section-label { color: #eeeeee; font-size: 14px; font-weight: normal; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .pourcent-body { flex: 1; display: flex; align-items: center; justify-content: center; }
        .total-pourcent-value { font-weight: bold; font-size: 28px; line-height: 1; color: white; transition: all 0.3s; }
        .note-a { background-color: #e6f4ea; color: #2c974b; }
        .note-a.total-pourcent-section { background-color: #2c974b; }
        .note-b { background-color: #e9f3fd; color: #4e9cf0; }
        .note-b.total-pourcent-section { background-color: #4e9cf0; }
        .note-c { background-color: #fdf5e6; color: #f0ad4e; }
        .note-c.total-pourcent-section { background-color: #f0ad4e; }
        .note-d { background-color: #fceee3; color: #e67e22; }
        .note-d.total-pourcent-section { background-color: #e67e22; }
        .note-e { background-color: #fbeaea; color: #d9534f; }
        .note-e.total-pourcent-section { background-color: #d9534f; }
        .note-neutral { background-color: #f0f8ff; color: #2c5aa0; }
        .note-neutral.total-pourcent-section { background-color: #6B8BC3; }
        .note-a.total-pourcent-body { background-color: #e6f4ea; }
        .note-b.total-pourcent-body { background-color: #e9f3fd; }
        .note-c.total-pourcent-body { background-color: #fdf5e6; }
        .note-d.total-pourcent-body { background-color: #fceee3; }
        .note-e.total-pourcent-body { background-color: #fbeaea; }
        .note-neutral.total-pourcent-body { background-color: #f0f8ff; }
        .grade-scale { margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; }
        .grade-scale h3 { margin-top: 0; }
        .grade-row { display: flex; justify-content: space-between; padding: 5px 0; }
        .missing-items { background: #fff3cd; border: 1px solid #ffeeba; color: #856404; padding: 15px; border-radius: 8px; margin-top: 20px; }
        .missing-items h3 { margin-top: 0; }
        .missing-item { color: #dc3545; font-weight: bold; }
        .annexes { margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #ddd; }
        .annexes h3 { margin-top: 0; color: #2c5aa0; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        .annexe-item { margin: 20px 0; padding: 15px; background: white; border-radius: 5px; border: 1px solid #e0e0e0; }
        .annexe-title { font-weight: bold; color: #2c5aa0; margin-bottom: 8px; font-size: 16px; }
        .annexe-description { color: #666; font-style: italic; margin-bottom: 10px; font-size: 14px; }
        .annexe-image { text-align: center; margin: 10px 0; }
        .annexe-image img { max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .annexe-document { background: #f0f8ff; padding: 10px; border-radius: 4px; border-left: 4px solid #2c5aa0; white-space: pre-wrap; font-family: "Courier New", monospace; font-size: 13px; }
        .communication-section { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px 80px; gap: 10px; align-items: start; padding: 15px 0; border-bottom: 1px solid #eee; }
        .communication-text { font-weight: 500; }
        .communication-desc { font-size: 0.85em; color: #666; margin-top: 5px; font-style: italic; }
        .scale-header { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px 80px; gap: 10px; font-weight: bold; text-align: center; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 2px solid #ddd; }
        .scale-header div:first-child { text-align: left; }
        .vital-signs { margin-top: 10px; margin-bottom: 0px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; font-size: 0.9em; }
        .vital-sign { text-align: center; background: #416caa; padding: 10px; border-radius: 5px; }
        .vital-sign-label { color: #eeeeee; }
        .vital-sign-value { color: rgb(255, 255, 255); margin-top: 2px; }
        .dd-section { background: #f0f8ff; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .dd-title { font-weight: bold; margin-bottom: 10px; color: #2c5aa0; }
        .dd-category { margin: 10px 0; font-weight: bold; }
        .dd-item { margin-left: 20px; margin-bottom: 5px; font-weight: normal; }
        .dd-test { color: #666; font-style: italic; margin-left: 10px; }
        .therapy-section { background: #f8f9fa; padding: 10px; margin: 5px 0; border-radius: 5px; }
        .therapy-title { font-weight: bold; margin-bottom: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Grille d'évaluation ECOS - [Titre de la station]</h1>
            <p style="margin: 5px 0;">Contexte : [Type de cabinet/service]</p>
            <p style="margin: 5px 0;">Patient : [Nom], [âge] ans, se présente chez [praticien] avec [motif de consultation]</p>
            <div class="vital-signs">
                <div class="vital-sign">
                    <div class="vital-sign-label">TA</div>
                    <div class="vital-sign-value">[valeur] mmHg (inclure seulement si mentionné dans le PDF)</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">FC</div>
                    <div class="vital-sign-value">[valeur] bpm (inclure seulement si mentionné dans le PDF)</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">FR</div>
                    <div class="vital-sign-value">[valeur]/min (inclure seulement si mentionné dans le PDF)</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">T°</div>
                    <div class="vital-sign-value">[valeur]°C (inclure seulement si mentionné dans le PDF)</div>
                </div>
            </div>
        </div>
        <!-- ANAMNÈSE -->
        <div class="section">
            <div class="section-header">
                <span>Anamnèse (40%)</span>
                <span class="score">Score : <span id="anamneseScore">0</span>/6</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Critères</div>
                    <div>Oui</div>
                    <div>±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row">
    <div>
        <div class="criteria-text">1. [Critère anamnèse 1] <span class="patient-response">([Réponse attendue du patient/accompagnant])</span></div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a1" value="2" data-criteria="[Critère anamnèse 1]" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a1" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a1">0</div>
</div>
<div class="criteria-row">
    <div>
        <div class="criteria-text">2. [Critère anamnèse 2] <span class="patient-response">([Réponse attendue du patient/accompagnant])</span></div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a2" value="2" data-criteria="[Critère anamnèse 2]" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a2" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a2">0</div>
</div>
<div class="criteria-row">
    <div>
        <div class="criteria-text">3. [Critère anamnèse 3] <span class="patient-response">([Réponse attendue du patient/accompagnant])</span></div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a3" value="2" data-criteria="[Critère anamnèse 3]" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a3" value="1" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a3" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a3">0</div>
</div>
            </div>
        </div>
        <!-- EXAMEN CLINIQUE -->
        <div class="section">
            <div class="section-header">
                <span>Examen clinique (30%)</span>
                <span class="score">Score : <span id="statusScore">0</span>/4</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Critères</div>
                    <div>Oui</div>
                    <div>±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row">
    <div>
        <div class="criteria-text">1. [Critère examen 1] <span class="patient-response">([Résultat attendu de l'examen])</span></div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="e1" value="2" data-criteria="[Critère examen 1]" onchange="updateScore('e', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="e1" value="1" onchange="updateScore('e', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="e1" value="0" onchange="updateScore('e', this)" />
    </div>
    <div class="points-display" id="points-e1">0</div>
</div>
<div class="criteria-row">
    <div>
        <div class="criteria-text">2. [Critère examen 2] <span class="patient-response">([Résultat attendu de l'examen])</span></div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="e2" value="2" data-criteria="[Critère examen 2]" onchange="updateScore('e', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="e2" value="0" onchange="updateScore('e', this)" />
    </div>
    <div class="points-display" id="points-e2">0</div>
</div>
            </div>
        </div>
        <!-- MANAGEMENT -->
        <div class="section">
            <div class="section-header">
                <span>Management (20%)</span>
                <span class="score">Score : <span id="managementScore">0</span>/8</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Critères</div>
                    <div>Oui</div>
                    <div>±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row">
    <div>
        <div class="criteria-text">1. [Critère management 1] <span class="patient-response">([Information complémentaire si nécessaire])</span></div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="2" data-criteria="[Critère management 1]" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="1" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="0" onchange="updateScore('m', this)" />
    </div>
    <div class="points-display" id="points-m1">0</div>
</div>
<div class="criteria-row">
    <div>
        <div class="criteria-text">2. [Critère management 2]</div>
<div class="scoring-rule">[Règle de notation spécifique]</div>    </div>
    <div class="checkbox-group">
        <input type="radio" name="m2" value="2" data-criteria="[Critère management 2]" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m2" value="1" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m2" value="0" onchange="updateScore('m', this)" />
    </div>
    <div class="points-display" id="points-m2">0</div>
</div>
<div class="dd-section">
    <div class="dd-title">[Titre de la section DD = Aparté explicatif]</div>
    <div class="dd-category">[Nom de la catégorie 1] :</div>
    <div class="dd-item">• [Diagnostic différentiel 1]</div>
    <div class="dd-causes" style="margin-left: 40px; margin-top: 5px; color: #666; font-size: 0.9em;">[	- Cause 1<br>	- Cause 2]</div>
    <div class="dd-item">• [Diagnostic différentiel 2] <span class="dd-test">[→ Examen complémentaire recommandé]</span></div>
    <div class="dd-item">• [Diagnostic différentiel 3] <span class="dd-test">[→ Examen complémentaire recommandé]</span></div>
    <div class="dd-causes" style="margin-left: 40px; margin-top: 5px; color: #666; font-size: 0.9em;">[	- Cause 1<br>	- Cause 2<br>	- Cause 3]</div>
    <div class="dd-category">[Nom de la catégorie 2] :</div>
    <div class="dd-item">• [Diagnostic différentiel 4] <span class="dd-test">[→ Examen complémentaire recommandé]</span></div>
    <div class="dd-causes" style="margin-left: 40px; margin-top: 5px; color: #666; font-size: 0.9em;">[	- Cause 1<br>	- Cause 2]</div>
    <div class="dd-item">• [Diagnostic différentiel 5] <span class="dd-test">[→ Examen complémentaire recommandé]</span></div>
</div>
<div class="criteria-row">
    <div>
        <div class="criteria-text">3. [Critère management avec examens complémentaires] <span class="patient-response">([Examens complémentaires appropriés])</span></div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m3" value="2" data-criteria="[Critère management avec examens complémentaires]" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m3" value="0" onchange="updateScore('m', this)" />
    </div>
    <div class="points-display" id="points-m3">0</div>
</div>
<div class="criteria-row">
    <div>
        <div class="criteria-text">4. [Critère management avec thérapeutique]</div>
        <div class="therapy-section">
            <div class="therapy-title">[Titre catégorie thérapeutique 1] :</div>
            [• Mesure thérapeutique 1]<br />
            [• Mesure thérapeutique 2]<br />
            [• Mesure thérapeutique 3]
        </div>
        <div class="therapy-section">
            <div class="therapy-title">[Titre catégorie thérapeutique 2] :</div>
            [• Traitement médicamenteux 1]<br />
            [• Traitement médicamenteux 2]
        </div>
        <div class="therapy-section">
            <div class="therapy-title">[Titre catégorie thérapeutique 3] :</div>
            [• Option chirurgicale 1]<br />
            [• Option de suivi 1]
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m4" value="2" data-criteria="[Critère management avec thérapeutique]" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m4" value="1" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m4" value="0" onchange="updateScore('m', this)" />
    </div>
    <div class="points-display" id="points-m4">0</div>
</div>
            </div>
        </div>
        <!-- COMMUNICATION -->
        <div class="section">
            <div class="section-header">
                <span>Communication (10%)</span>
                <span class="score">Score : <span id="communicationScore">0</span>/16</span>
            </div>
            <div class="section-content">
                <div class="scale-header">
                    <div>Critères</div>
                    <div>A</div>
                    <div>B</div>
                    <div>C</div>
                    <div>D</div>
                    <div>E</div>
                </div>
                <div class="communication-section">
                    <div>
                        <div class="communication-text">1. Réponse aux sentiments du patient</div>
                        <div class="communication-desc">Empathie, écoute active, validation des émotions</div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="A" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="B" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="C" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="D" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="E" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section">
                    <div>
                        <div class="communication-text">2. Structure de l'entretien</div>
                        <div class="communication-desc">Organisation logique, transitions fluides, gestion du temps</div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="A" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="B" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="C" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="D" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="E" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section">
                    <div>
                        <div class="communication-text">3. Expression verbale</div>
                        <div class="communication-desc">Clarté, vocabulaire adapté, vérification de la compréhension</div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="A" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="B" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="C" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="D" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="E" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section">
                    <div>
                        <div class="communication-text">4. Expression non verbale</div>
                        <div class="communication-desc">Contact visuel, posture, gestuelle appropriée</div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="A" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="B" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="C" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="D" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="E" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
            </div>
        </div>
        <!-- TOTAUX -->
        <div class="total-sections">
            <div class="total-section">
                <div class="total-label">Score Global</div>
                <div class="total-body">
                    <div class="total-score" id="totalScore">0/34</div>
                </div>
            </div>
            <div class="total-section">
                <div class="total-label">% par Section</div>
                <div class="total-pourcent-body">
                    <div class="total-pourcent-sections">
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Anamnèse</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="anamnese-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Examen clinique</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="examen-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Management</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="management-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Communication</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="communication-percentage">0</span>%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="total-section">
                <div class="total-label">Note Globale</div>
                <div class="total-body">
                    <div class="total-note-globale" id="globalGrade">E</div>
                </div>
            </div>
        </div>
        <!-- ÉCHELLE DE NOTATION -->
        <div class="grade-scale">
            <h3>Échelle de notation</h3>
            <div class="grade-row">
                <span>A (Excellent)</span>
                <span>≥ 31 points (90%)</span>
            </div>
            <div class="grade-row">
                <span>B (Très bien)</span>
                <span>27-30 points (80-89%)</span>
            </div>
            <div class="grade-row">
                <span>C (Bien)</span>
                <span>24-26 points (70-79%)</span>
            </div>
            <div class="grade-row">
                <span>D (Suffisant)</span>
                <span>20-23 points (60-69%)</span>
            </div>
            <div class="grade-row">
                <span>E (Insuffisant)</span>
                <span>&lt; 20 points (&lt; 60%)</span>
            </div>
        </div>
        <!-- ÉLÉMENTS MANQUANTS -->
        <div class="missing-items" id="missingItems" style="display: none;">
            <h3>Éléments non évalués</h3>
            <div id="missingList"></div>
        </div>
    </div>
    <script>
        function updateScore(section, element) {
            const value = element.value;
            const name = element.name;
            let pointValue;

            if (section === "communication") {
                const map = { A: 4, B: 3, C: 2, D: 1, E: 0 };
                pointValue = map[value] || 0;
            } else {
                pointValue = Number(value) || 0;
            }

            const pointsElement = document.getElementById("points-" + name);
            if (pointsElement) {
                pointsElement.textContent = pointValue;
            }

            calculateScores();
        }

        function calculateScores() {
            let anamneseScore = 0, statusScore = 0, managementScore = 0, communicationScore = 0;
            const maxAnamnese = 6;
            const maxStatus = 4;
            const maxManagement = 8;
            const maxCommunication = 16;
            const missingItems = [];

            const coef = {
                anamnese: 0.4,
                status: 0.3,
                management: 0.2,
                communication: 0.1
            };

            for (let i = 1; i <= 3; i++) {
                const radio = document.querySelector("input[name=\"a" + i + "\"]:checked");
                if (radio) {
                    anamneseScore += Number(radio.value) || 0;
                } else {
                    const criteria = document.querySelector("input[name=\"a" + i + "\"][data-criteria]");
                    if (criteria) missingItems.push("Anamnèse : " + criteria.dataset.criteria);
                }
            }
            document.getElementById("anamneseScore").textContent = anamneseScore;

            for (let i = 1; i <= 2; i++) {
                const radio = document.querySelector("input[name=\"e" + i + "\"]:checked");
                if (radio) {
                    statusScore += Number(radio.value) || 0;
                } else {
                    const criteria = document.querySelector("input[name=\"e" + i + "\"][data-criteria]");
                    if (criteria) missingItems.push("Examen clinique : " + criteria.dataset.criteria);
                }
            }
            document.getElementById("statusScore").textContent = statusScore;

            for (let i = 1; i <= 4; i++) {
                const radio = document.querySelector("input[name=\"m" + i + "\"]:checked");
                if (radio) {
                    managementScore += Number(radio.value) || 0;
                } else {
                    const criteria = document.querySelector("input[name=\"m" + i + "\"][data-criteria]");
                    if (criteria) missingItems.push("Management : " + criteria.dataset.criteria);
                }
            }
            document.getElementById("managementScore").textContent = managementScore;

            for (let i = 1; i <= 4; i++) {
                const radio = document.querySelector("input[name=\"c" + i + "\"]:checked");
                if (radio) {
                    const val = radio.value;
                    const map = { A: 4, B: 3, C: 2, D: 1, E: 0 };
                    communicationScore += map[val] || 0;
                } else {
                    const criteria = document.querySelector("input[name=\"c" + i + "\"][data-criteria]");
                    if (criteria) missingItems.push("Communication : " + criteria.dataset.criteria);
                }
            }
            document.getElementById("communicationScore").textContent = communicationScore;

            const anamneseP = (anamneseScore / maxAnamnese) * 100;
            const statusP = (statusScore / maxStatus) * 100;
            const managementP = (managementScore / maxManagement) * 100;
            const communicationP = (communicationScore / maxCommunication) * 100;

            const globalPercentage = anamneseP * coef.anamnese + statusP * coef.status + managementP * coef.management + communicationP * coef.communication;

            const isStarted = anamneseScore + statusScore + managementScore + communicationScore > 0;

            const totalScoreText = isStarted ? Math.round(globalPercentage) : 0;
            document.getElementById("totalScore").textContent = totalScoreText + "%";

            document.getElementById("anamnese-percentage").textContent = Math.round(anamneseP);
            document.getElementById("examen-percentage").textContent = Math.round(statusP);
            document.getElementById("management-percentage").textContent = Math.round(managementP);
            document.getElementById("communication-percentage").textContent = Math.round(communicationP);

            const gradeElement = document.getElementById("globalGrade");
            const scoreBody = document.getElementById("totalScore").closest(".total-body");
            const gradeBody = gradeElement.closest(".total-body");
            const sections = ["anamnese", "examen", "management", "communication"];

            const allClasses = ["note-a", "note-b", "note-c", "note-d", "note-e", "note-neutral"];

            function getClass(p) {
                if (p === 0) return "note-neutral";
                if (p >= 90) return "note-a";
                if (p >= 80) return "note-b";
                if (p >= 70) return "note-c";
                if (p >= 60) return "note-d";
                return "note-e";
            }

            const gradeClass = getClass(globalPercentage);
            const gradeLabel = isStarted ? gradeClass.split("-")[1].toUpperCase() : "A-E";
            gradeElement.textContent = gradeLabel;

            const pourcentBody = document.querySelector(".total-pourcent-body");

            [gradeElement, scoreBody, gradeBody, pourcentBody].forEach(el => {
                el.classList.remove(...allClasses);
                el.classList.add(gradeClass);
            });

            sections.forEach(id => {
                const value = parseInt(document.getElementById(id + "-percentage").textContent);
                const section = document.getElementById(id + "-percentage").closest(".total-pourcent-section");
                const sectionClass = getClass(value);
                section.classList.remove(...allClasses);
                section.classList.add(sectionClass);
            });

            if (missingItems.length > 0) {
                document.getElementById("missingItems").style.display = "block";
                document.getElementById("missingList").innerHTML = missingItems.map(item =>
                    "<div class=\"missing-item\">• " + item + "</div>"
                ).join("");
            } else {
                document.getElementById("missingItems").style.display = "none";
            }
        }
        calculateScores();
    </script>
    <!-- BOUTON IMPRIMER EN PDF -->
    <button class="print-button" onclick="window.print()">🖨️ Imprimer en PDF</button>

    <style>
        .print-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2c5aa0;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 4px 12px rgba(44, 90, 160, 0.3);
            z-index: 1000;
        }
        .print-button:hover {
            background: #1e3f70;
        }
        @media print {
            .print-button {
                display: none;
            }
            /* Optimiser les marges et la mise en page */
            @page {
                size: A4;
                margin: 10mm 10mm 10mm 10mm;
            }
            body {
                margin: 0;
                background: white;
                font-size: 10pt;
            }
            .container {
                max-width: 100%;
                margin: 0;
                box-shadow: none;
                padding: 0;
                border-radius: 8px;
            }
            .header {
                margin: 0;
                padding: 6px;
                border-radius: 8px;
                page-break-inside: avoid;
                margin-bottom: 8px;
            }
            .header h1 {
                margin: 5px 0;
                font-size: 20px;
            }
            .header p {
                margin: 3px 0;
            }
            .section {
                page-break-inside: avoid;
                margin-bottom: 8px;
            }
            .section-header {
                font-size: 15px;
                padding: 6px;
            }
            .section-content {
                padding: 6px;
            }
            /* Ajuster la grille pour mieux utiliser l'espace */
            .header-row,
            .criteria-row {
                grid-template-columns: 1fr 40px 40px 40px 65px;
                gap: 3px;
            }
            .communication-section,
            .scale-header {
                grid-template-columns: 1fr 50px 50px 50px 50px 50px;
                gap: 3px;
            }
            /* Réduire la taille des polices pour certains éléments */
            .criteria-text,
            .communication-text {
                font-size: 9.5pt;
            }
            .sub-criteria,
            .patient-response {
                font-size: 8.5pt;
            }
            .communication-desc {
                font-size: 8.5pt;
                margin-top: 2px;
            }
            .scoring-rule {
                font-size: 8pt;
                margin-top: 4px;
                padding-left: 18px;
            }
            .points-display {
                font-size: 14px;
            }
            /* Optimiser les sections de totaux */
            .total-sections {
                gap: 6px;
                margin-bottom: 6px;
            }
            .total-label {
                padding: 4px;
                font-size: 16px;
            }
            .total-body {
                padding: 3px;
            }
            .total-score,
            .total-note-globale {
                font-size: 32px;
            }
            /* ADAPTATION DES BLOCS DE POURCENTAGES */
            .total-pourcent-body {
                padding: 6px;
            }
            .total-pourcent-sections {
                display: flex;
                flex-wrap: nowrap;
                gap: 4px;
                align-items: stretch;
            }
            .total-pourcent-section {
                flex: 0 0 auto;
                min-width: 60px;
                padding: 6px 8px;
                white-space: nowrap;
            }
            .total-section-label {
                font-size: 11px;
                margin-bottom: 3px;
                white-space: nowrap;
            }
            .total-pourcent-value {
                font-size: 20px;
            }
            .pourcent-body {
                padding: 2px 0;
            }
            /* S'assurer que les sections importantes ne sont pas coupées */
            .total-sections,
            .grade-scale,
            .missing-items {
                page-break-inside: avoid;
            }
            /* Réduire l'espacement général */
            .criteria-row,
            .communication-section {
                padding: 4px 0;
            }
            .header-row,
            .scale-header {
                padding: 4px 0;
                margin-bottom: 6px;
            }
            /* Réduire l'espacement des signes vitaux */
            .vital-signs {
                gap: 8px;
                margin-top: 6px;
            }
            .vital-sign {
                padding: 6px;
                font-size: 0.85em;
            }
            /* Optimiser les DD sections */
            .dd-section {
                padding: 10px;
                margin: 6px 0;
            }
            .dd-title {
                margin-bottom: 6px;
                font-size: 11pt;
            }
            .dd-category {
                margin: 6px 0;
                font-size: 10pt;
            }
            .dd-item {
                margin-bottom: 3px;
                margin-left: 18px;
                font-size: 9pt;
                line-height: 1.2;
            }
            .dd-test {
                font-size: 8.5pt;
                margin-left: 8px;
            }
            /* Optimiser les therapy sections */
            .therapy-section {
                padding: 6px;
                margin: 3px 0;
            }
            .therapy-title {
                margin-bottom: 3px;
                font-size: 9.5pt;
            }
            /* Réduire les marges de l'échelle de notation */
            .grade-scale {
                margin-top: 10px;
                padding: 10px;
            }
            .grade-scale h3 {
                margin: 0 0 5px 0;
                font-size: 14px;
            }
            .grade-row {
                padding: 3px 0;
            }
            /* Forcer le fond blanc partout */
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            /* SOLUTION : Forcer l'anamnèse à commencer sur la page 1 */
            
            /* 1. Le header ne doit jamais être seul */
            .header {
                page-break-after: avoid;
            }
            
            /* 2. Permettre au container de se diviser */
            .container {
                page-break-inside: auto;
            }
            
            /* 3. Configuration spéciale pour l'anamnèse */
            .section:first-of-type {
                page-break-before: avoid !important; /* Jamais de saut avant */
                page-break-inside: auto !important; /* Peut se diviser */
            }
            
            /* 4. L'en-tête de l'anamnèse doit rester avec ses premiers critères */
            .section:first-of-type .section-header {
                page-break-after: avoid !important;
            }
            
            /* 5. Le contenu de l'anamnèse peut se diviser librement */
            .section:first-of-type .section-content {
                page-break-inside: auto !important;
            }
            
            /* 6. Mais chaque critère individuel reste intact */
            .criteria-row {
                page-break-inside: avoid;
            }
            
            /* 7. Les autres sections restent intactes */
            .section:not(:first-of-type) {
                page-break-inside: avoid;
                page-break-before: auto;
            }
            
            /* 8. IMPORTANT : Forcer le premier critère à commencer immédiatement */
            .section:first-of-type .header-row {
                page-break-after: avoid !important;
            }
            
            /* 9. Assurer une hauteur minimale pour le début de section */
            .section:first-of-type .section-content > :first-child,
            .section:first-of-type .section-content > :nth-child(2) {
                page-break-before: avoid !important;
            }
        }
    </style>
</body>
</html>
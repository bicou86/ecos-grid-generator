<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMBOSS-17 - Troubles de mémoire - Femme 70 ans - Grille ECOS</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); }
        .header { background: #2c5aa0; color: white; padding: 15px; margin: -20px -20px 20px -20px; border-radius: 8px 8px 0 0; }
        .section { margin-bottom: 30px; border: 2px solid #ddd; border-radius: 8px; overflow: hidden; background-color: #ffffff; }
        .section-header { background: #f8f9fa; padding: 15px; font-weight: bold; font-size: 18px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; }
        .section-content { padding: 15px; background-color: #ffffff; }
        .header-row { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px; gap: 10px; padding: 10px 0; border-bottom: 2px solid #ddd; font-weight: bold; text-align: center; color: #333333; }
        .header-row.communication-header { grid-template-columns: 2fr 80px 80px 80px 80px 80px; }
        .header-row div:first-child { text-align: left; }
        .criteria-row { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px; gap: 10px; align-items: start; padding: 15px 0 15px 5px; border-bottom: 1px solid #eeeeee; }
        .criteria-row:last-child { border-bottom: none; }
        .criteria-text { font-weight: 500; }
        .sub-criteria { font-size: 0.9em; color: #333; margin-top: 5px; padding-left: 18px; line-height: 1.2; }
        .details-with-checkboxes { margin-top: 8px; }
        .detail-row { display: grid; grid-template-columns: 1fr 100px; align-items: center; padding: 2px 0 2px 18px; gap: 10px; line-height: 1.1; }
        .detail-text { font-size: 0.9em; color: #333; }
        .patient-response-highlight { color: rgb(44, 90, 160) !important; }
        .detail-text .patient-response-highlight { color: rgb(44, 90, 160) !important; }
        .criteria-detail .patient-response-highlight { color: rgb(44, 90, 160) !important; }
        .detail-checkboxes { text-align: center; }
        .detail-checkbox input[type="checkbox"] { cursor: pointer; transform: scale(1.1); }
        .patient-response { font-size: 0.9em; color: rgb(44, 90, 160); font-weight: 500; }
        .checkbox-group { text-align: center; }
        .points-display { text-align: center; font-weight: bold; color: #2c5aa0; font-size: 18px; }
        .scoring-rule { font-size: 0.85em; color: #888; font-style: italic; margin-top: 8px; padding-left: 20px; }
        .criteria-subheader { background: #fffbe6; padding: 10px 15px; margin: 10px 0 5px 0; border-left: 4px solid #faad14; font-weight: bold; color: #8b6914; }
        input[type="radio"] { cursor: pointer; transform: scale(1.2); }
        input[type="radio"]:disabled { opacity: 0.3; cursor: not-allowed; }
        .score { font-weight: bold; color: hsl(216, 57%, 40%); font-size: 18px; }
        .total-sections { display: grid; grid-template-columns: 1fr 2fr 1fr; gap: 20px; margin-bottom: 30px; }
        .total-section { display: flex; flex-direction: column; justify-content: space-between; text-align: center; background: #f0f8ff; border: 1px solid #ddd; border-radius: 8px; transition: all 0.3s; }
        .total-label { background: #f8f9fa; padding: 5px; font-weight: bold; font-size: 20px; border-bottom: 1px solid #ddd; }
        .total-body { flex: 1; display: flex; align-items: center; justify-content: center; padding: 5px; }
        .total-pourcent-body { flex: 1; padding: 10px; }
        .total-score, .total-note-globale { font-size: 56px; font-weight: bold; line-height: 1; }
        .total-pourcent-sections { display: flex; flex-wrap: nowrap; gap: 10px; height: 100%; align-items: stretch; }
        .total-pourcent-section { flex: 1 1 auto; min-width: 0; display: flex; flex-direction: column; text-align: center; background: #416caa; padding: 10px; border-radius: 5px; transition: all 0.3s; border: none; }
        .total-pourcent-section:last-child { border-right: none; }
        .total-section-label { color: #eeeeee; font-size: 14px; font-weight: normal; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .pourcent-body { flex: 1; display: flex; align-items: center; justify-content: center; }
        .total-pourcent-value { font-weight: bold; font-size: 28px; line-height: 1; color: white; transition: all 0.3s; }
        .note-a { background-color: #e6f4ea; color: #2c974b; }
        .note-a.total-pourcent-section { background-color: #2c974b; }
        .note-b { background-color: #e9f3fd; color: #4e9cf0; }
        .note-b.total-pourcent-section { background-color: #4e9cf0; }
        .note-c { background-color: #fdf5e6; color: #f0ad4e; }
        .note-c.total-pourcent-section { background-color: #f0ad4e; }
        .note-d { background-color: #fceee3; color: #e67e22; }
        .note-d.total-pourcent-section { background-color: #e67e22; }
        .note-e { background-color: #fbeaea; color: #d9534f; }
        .note-e.total-pourcent-section { background-color: #d9534f; }
        .note-neutral { background-color: #f0f8ff; color: #2c5aa0; }
        .note-neutral.total-pourcent-section { background-color: #6B8BC3; }
        .note-a.total-pourcent-body { background-color: #e6f4ea; }
        .note-b.total-pourcent-body { background-color: #e9f3fd; }
        .note-c.total-pourcent-body { background-color: #fdf5e6; }
        .note-d.total-pourcent-body { background-color: #fceee3; }
        .note-e.total-pourcent-body { background-color: #fbeaea; }
        .note-neutral.total-pourcent-body { background-color: #f0f8ff; }
        /* Styles pour les sections avec coloration selon le score */
        .section.note-a { border-color: #2c974b; }
        .section.note-a .section-header { background-color: #e6f4ea; color: #2c974b; }
        .section.note-b { border-color: #4e9cf0; }
        .section.note-b .section-header { background-color: #e9f3fd; color: #4e9cf0; }
        .section.note-c { border-color: #f0ad4e; }
        .section.note-c .section-header { background-color: #fdf5e6; color: #f0ad4e; }
        .section.note-d { border-color: #e67e22; }
        .section.note-d .section-header { background-color: #fceee3; color: #e67e22; }
        .section.note-e { border-color: #d9534f; }
        .section.note-e .section-header { background-color: #fbeaea; color: #d9534f; }
        .section.note-neutral { border-color: #ddd; }
        .section.note-neutral .section-header { background-color: #f8f9fa; color: #333333; }
        /* Styles pour les critères individuels */
        .criteria-row.score-2 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-2 .criteria-text { color: #2c974b; }
        .criteria-row.score-max { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-max .criteria-text { color: #2c974b; }
        .criteria-row.score-1 { background-color: rgba(240, 173, 78, 0.1); }
        .criteria-row.score-1 .criteria-text { color: #f0ad4e; }
        .criteria-row.score-0 { background-color: rgba(217, 83, 79, 0.1); }
        .criteria-row.score-0 .criteria-text { color: #d9534f; }
        .criteria-row:not(.score-0):not(.score-1):not(.score-2):not(.score-max) .criteria-text { color: #000; }
        /* Styles supplémentaires pour les scores plus élevés */
        .criteria-row.score-3 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-3 .criteria-text { color: #2c974b; }
        .criteria-row.score-4 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-4 .criteria-text { color: #2c974b; }
        .criteria-row.score-5 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-5 .criteria-text { color: #2c974b; }
        .communication-section.score-a { background-color: rgba(44, 151, 75, 0.1); }
        .communication-section.score-a .communication-text { color: #2c974b; }
        .communication-section.score-b { background-color: rgba(78, 156, 240, 0.1); }
        .communication-section.score-b .communication-text { color: #4e9cf0; }
        .communication-section.score-c { background-color: rgba(240, 173, 78, 0.1); }
        .communication-section.score-c .communication-text { color: #f0ad4e; }
        .communication-section.score-d { background-color: rgba(230, 126, 34, 0.1); }
        .communication-section.score-d .communication-text { color: #e67e22; }
        .communication-section.score-e { background-color: rgba(217, 83, 79, 0.1); }
        .communication-section.score-e .communication-text { color: #d9534f; }
        .grade-scale { margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; }
        .grade-scale h3 { margin-top: 0; }
        .grade-row { display: flex; justify-content: space-between; padding: 5px 0; }
        .missing-items { display: none !important; }
        .missing-items h3 { margin-top: 0; }
        .missing-item { color: #dc3545; font-weight: bold; }
        .redflags-main-section { margin-top: 30px; padding: 20px; background: #fff5f5; border-radius: 8px; border: 1px solid #f5c6cb; }
        .redflags-main-section h3 { margin-top: 0; border-bottom: 2px solid #f5c6cb; padding-bottom: 10px; }
        .redflags-category-section { margin: 15px 0; padding: 10px; background: white; border-radius: 5px; border-left: 4px solid #dc3545; }
        .annexes { margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #ddd; }
        .annexes h3 { margin-top: 0; color: #2c5aa0; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        .annexes-grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin-top: 20px; }
        .annexe-item { padding: 15px; background: white; border-radius: 5px; border: 1px solid #e0e0e0; }
        .annexe-title { font-weight: bold; color: #2c5aa0; margin-bottom: 8px; font-size: 16px; }
        .annexe-description { color: #666; font-style: italic; margin-bottom: 10px; font-size: 14px; }
        .annexe-image { text-align: center; margin: 10px 0; }
        .annexe-image img { max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .annexe-document { background: #f0f8ff; padding: 10px; border-radius: 4px; border-left: 4px solid #2c5aa0; white-space: pre-wrap; font-family: "Courier New", monospace; font-size: 13px; }
        
        /* Styles pour le scénario de la patiente standardisée */
        .annexe-scenario { grid-column: 1 / -1; max-width: none; }
        .annexe-scenario-content { padding: 15px; background: #fafafa; border-radius: 4px; }
        .scenario-info { background: #e8f4f8; padding: 10px 15px; border-radius: 4px; margin-bottom: 15px; font-size: 15px; }
        .scenario-section { margin-bottom: 20px; }
        .scenario-subsection { margin-bottom: 15px; }
        .scenario-subsection strong { color: #2c5aa0; }
        .scenario-section h4 { color: #2c5aa0; margin: 15px 0 10px 0; font-size: 16px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        .scenario-section ul { margin: 10px 0; padding-left: 25px; }
        .scenario-section li { margin: 5px 0; line-height: 1.5; }
        .scenario-subsection { margin: 10px 0 15px 0; }
        .scenario-subsection strong { color: #555; }
        .scenario-subsection ul { margin-top: 5px; }
        
        /* Styles pour les interventions de l'expert */
        .annexe-interventions { grid-column: 1 / -1; max-width: none; }
        .annexe-interventions-content { padding: 15px; }
        .intervention-item { background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 12px; margin-bottom: 12px; }
        .intervention-header { font-size: 15px; margin-bottom: 8px; color: #856404; }
        .intervention-moment { font-weight: normal; font-style: italic; color: #666; }
        .intervention-instruction { margin: 8px 0; color: #333; }
        .intervention-message { background: #fff; padding: 8px 12px; border-left: 3px solid #ffc107; font-style: italic; color: #721c24; margin-top: 8px; }
        
        /* Styles pour les informations de l'expert */
        .annexe-informations-expert { grid-column: 1 / -1; max-width: none; }
        .annexe-informations-content { padding: 15px; background: #f5f5f5; border-radius: 4px; }
        .info-section { margin-bottom: 20px; }
        .info-section:last-child { margin-bottom: 0; }
        .info-section h4 { color: #2c5aa0; margin: 0 0 10px 0; font-size: 16px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        .info-section p { margin: 10px 0; line-height: 1.6; }
        .info-section ul { margin: 10px 0; padding-left: 25px; }
        .info-section li { margin: 5px 0; line-height: 1.5; }
        
        /* Styles pour la théorie pratique */
        .annexe-theorie-pratique { grid-column: 1 / -1; max-width: none; }
        .annexe-theorie-content { padding: 15px; background: #f0f5ff; border-radius: 4px; }
        .theorie-text { line-height: 1.6; color: #333; }
        .theorie-section { margin-bottom: 20px; }
        .theorie-section:last-child { margin-bottom: 0; }
        .theorie-section h4 { color: #1a4b84; margin: 0 0 10px 0; font-size: 16px; }
        .theorie-section p { margin: 10px 0; line-height: 1.6; }
        .theorie-section ul { margin: 10px 0; padding-left: 25px; }
        .theorie-section li { margin: 5px 0; line-height: 1.5; }
        /* Styles pour rappels thérapeutiques et examens complémentaires */
        .annexe-rappels-therapeutiques, .annexe-examens-complementaires { grid-column: 1 / -1; max-width: none; }
        .rappels-list, .examens-list { margin: 0; padding-left: 25px; }
        .rappels-list li, .examens-list li { margin: 8px 0; line-height: 1.6; color: #333; }
        .annexe-rappels-therapeutiques .annexe-title { color: #998800; }
        .annexe-examens-complementaires .annexe-title { color: #346929; }
        .communication-section { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px 80px; gap: 10px; align-items: start; padding: 15px 0 15px 5px; border-bottom: 1px solid #eee; }
        .communication-text { font-weight: 500; }
        .communication-desc { font-size: 0.85em; color: #666; margin-top: 5px; font-style: italic; }
        /* Section Clôture */
        .cloture-section { margin-bottom: 20px; }
        .cloture-section .section-header { background-color: #f0f4f8; }
        .cloture-item { margin-bottom: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 5px; }
        .cloture-title { color: #2c5aa0; margin: 0 0 10px 0; font-size: 16px; font-weight: bold; }
        .cloture-content { color: #333; line-height: 1.6; font-style: italic; }
        .cloture-content-green { color: rgb(112, 188, 123); font-weight: 500; }
        .communication-desc-detail { font-size: 0.8em; color: #666; margin-left: 20px; font-style: normal; }
        .vital-signs { margin-top: 10px; margin-bottom: 0px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; font-size: 0.9em; }
        .vital-sign { text-align: center; background: #416caa; padding: 10px; border-radius: 5px; }
        .vital-sign-label { color: #eeeeee; }
        .vital-sign-value { color: rgb(255, 255, 255); margin-top: 2px; }
        .dd-section { background: #f0f8ff; padding: 15px; margin: 0 0 10px 0; border-radius: 5px; }
        .dd-title { font-weight: bold; margin-bottom: 10px; color: #2c5aa0; }
        .dd-category { margin: 10px 0; font-weight: bold; color: #2c5aa0; }
        .dd-item { margin-left: 20px; margin-top: 5px; font-weight: bold; color: rgb(169, 34, 23); }
        .dd-test { color: #666; font-style: italic; margin-left: 10px; }
        .therapy-section { background: rgba(255, 250, 230, 0.4); padding: 10px 10px 0 20px; margin: 0; border-radius: 5px; color: #000; }
        .therapy-title { font-weight: bold; margin-bottom: 5px; color: #998800; }
        .redflags-section { background: #fff5f5; padding: 10px; margin: 5px 0; border-radius: 5px; }
        .redflags-title { font-weight: bold; margin-bottom: 8px; color: #dc3545; }
        .redflags-item { margin-bottom: 6px; padding-left: 22px; }
        .redflags-text { color: #dc3545; font-weight: 500; }
        .redflags-description { color: #666; font-size: 0.9em; margin-top: 2px; margin-left: 20px; }
        .annexes { margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #ddd; }
        .annexes h3 { margin-top: 0; color: #2c5aa0; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        .annexes-grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin-top: 20px; }
        .annexe-item { padding: 15px; background: white; border-radius: 5px; border: 1px solid #e0e0e0; }
        .annexe-title { font-weight: bold; color: #2c5aa0; margin-bottom: 8px; font-size: 16px; }
        .annexe-description { color: #666; font-style: italic; margin-bottom: 10px; font-size: 14px; }
        .annexe-image { text-align: center; margin: 10px 0; }
        .annexe-image img { max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .annexe-document { background: #f0f8ff; padding: 10px; border-radius: 4px; border-left: 4px solid #2c5aa0; white-space: pre-wrap; font-family: "Courier New", monospace; font-size: 13px; }
        
        /* MINUTEUR */
        .timer-container {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.75);
            border: 3px solid #2c5aa0;
            border-radius: 15px;
            padding: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            z-index: 1000;
            text-align: center;
            min-width: 200px;
        }
        .timer-display {
            font-size: 40px;
            font-weight: bold;
            color: #2c5aa0;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
        }
        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
        }
        .timer-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
            font-size: 14px;
        }
        .start-btn {
            background: #28a745;
            color: white;
        }
        .start-btn:hover {
            background: #218838;
        }
        .stop-btn {
            background: #dc3545;
            color: white;
        }
        .stop-btn:hover {
            background: #c82333;
        }
        .reset-btn {
            background: #6c757d;
            color: white;
        }
        .reset-btn:hover {
            background: #5a6268;
        }
        .timer-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .timer-btn:disabled:hover {
            background: #6c757d;
        }
        .timer-status {
            font-size: 14px;
            font-weight: bold;
            margin-top: 10px;
            padding: 5px 10px;
            border-radius: 5px;
        }
        .status-running {
            background: #e3f2fd;
            color: #1976d2;
        }
        .status-warning {
            background: #fff3cd;
            color: #ff6f00;
        }
        .status-finished {
            background: #f8d7da;
            color: #721c24;
        }
        .timer-warning {
            animation: pulse-warning 2s infinite;
        }
        .timer-critical {
            animation: pulse-critical 1s infinite;
        }
        @keyframes pulse-warning {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes pulse-critical {
            0%, 100% { transform: scale(1); border-color: #dc3545; }
            50% { transform: scale(1.1); border-color: #ff0000; }
        }
        
        /* COLORATION POST-MINUTEUR */
        .criteria-zero-points {
            background-color: rgba(251, 234, 234, 0.6) !important;
        }
        .criteria-one-point {
            background-color: rgba(253, 245, 230, 0.6) !important;
        }
        .criteria-full-points {
            background-color: rgba(230, 244, 234, 0.6) !important;
        }
        .criteria-not-answered {
            background-color: rgba(240, 248, 255, 0.6) !important;
        }
        
        /* COLORATION COMMUNICATION */
        .communication-note-a {
            background-color: rgba(230, 244, 234, 0.6) !important;
        }
        .communication-note-b {
            background-color: rgba(233, 243, 253, 0.6) !important;
        }
        .communication-note-c {
            background-color: rgba(253, 245, 230, 0.6) !important;
        }
        .communication-note-d {
            background-color: rgba(252, 238, 227, 0.6) !important;
        }
        .communication-note-e {
            background-color: rgba(251, 234, 234, 0.6) !important;
        }
        .communication-not-answered {
            background-color: rgba(240, 248, 255, 0.6) !important;
        }
        
        /* MODE SELECTOR */
        .mode-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 2px solid #2c5aa0;
            border-radius: 30px;
            padding: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1001;
            display: flex;
            gap: 5px;
        }
        .mode-button {
            padding: 8px 16px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            background: transparent;
            color: #2c5aa0;
        }
        .mode-button.active {
            background: #2c5aa0;
            color: white;
        }
        .mode-button:hover:not(.active) {
            background: #e8f0fe;
        }
        
        /* Mode-specific hiding and showing - CORRIGÉ */
        .revision-mode .timer-container {
            display: none !important;
        }
        .exam-mode .timer-container {
            display: block !important;
        }
        .exam-mode .revision-controls {
            display: none !important;
        }
        /* Masquer les descriptions et titres d'annexes en mode examen quand le timer est actif */
        .exam-mode.timer-running .annexe-item .annexe-title,
        .exam-mode.timer-running .annexe-item .annexe-description {
            display: none !important;
        }
        
        /* Revision controls */
        .revision-controls {
            position: fixed;
            top: 70px;
            right: 20px;
            background: white;
            border: 2px solid #4CAF50;
            border-radius: 30px;
            padding: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            gap: 5px;
            z-index: 1000;
        }
        .lacune-button {
            background: transparent;
            color: #4CAF50;
            border: none;
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }
        .lacune-button:hover {
            background: #4CAF50;
            color: white;
        }
        .reset-revision-button {
            background: transparent;
            color: #6c757d;
            border: none;
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }
        .reset-revision-button:hover {
            background: #6c757d;
            color: white;
        }
        
        /* Styles pour les commentaires discrets */
        .comment-button { 
            background: none; 
            border: none; 
            color: #2c5aa0; 
            cursor: pointer; 
            font-size: 14px; 
            padding: 2px 6px; 
            margin-left: 8px; 
            border-radius: 3px; 
            opacity: 0.6;
            transition: all 0.2s;
        }
        .comment-button:hover { opacity: 1; background: rgba(44, 90, 160, 0.1); }
        .comment-button.has-content { opacity: 1; color: #d9534f; }
        .criterion-comment-section { 
            display: none; 
            margin: 8px 0 12px 20px; 
            padding: 10px; 
            background: #fafafa; 
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .criterion-comment-section.show { display: block; }
        .section-comment-button {
            background: rgba(44, 90, 160, 0.1);
            border: 1px solid #2c5aa0;
            color: #2c5aa0;
            cursor: pointer;
            font-size: 12px;
            padding: 4px 8px;
            margin-left: 10px;
            border-radius: 15px;
            opacity: 0.8;
            transition: all 0.2s;
            font-weight: 500;
        }
        .section-comment-button:hover { 
            opacity: 1; 
            background: rgba(44, 90, 160, 0.2); 
            transform: scale(1.05);
        }
        .section-comment-button.has-content { 
            background: rgba(220, 53, 69, 0.1);
            border-color: #d9534f;
            color: #d9534f; 
        }
        .section-comment-section { 
            display: none;
            margin: 20px 0; 
            padding: 12px; 
            background: #f8f9fa; 
            border-radius: 6px;
        }
        .section-comment-section.show { display: block; }
        .section-comment-section.global { 
            display: block; 
            background: #f0f8ff; 
        }
        /* La section commentaire global reste toujours visible sauf à l'impression */
        .comment-textarea { 
            width: calc(100% - 0px); 
            min-height: 26px; 
            padding: 5px; 
            margin-right: 0px;
            border: 1px solid #ddd; 
            border-radius: 3px; 
            font-family: Arial, sans-serif;
            font-size: 12px; 
            resize: vertical;
            box-sizing: border-box;
            overflow-y: hidden;
            color: #7b3f00;
            height: 26px;
        }
        .section-comment-section .comment-textarea {
            min-height: 28px;
            font-size: 14px;
            height: 28px;
        }
        .section-comment-section.global .comment-textarea {
            min-height: 30px;
            font-size: 16px;
            height: 30px;
        }
        .comment-textarea:focus {
            outline: none;
            border-color: #2c5aa0;
            box-shadow: 0 0 0 2px rgba(44, 90, 160, 0.1);
        }
        
        /* Masquer les boutons à l'impression */
        @media print {
            .comment-button,
            .section-comment-button {
                display: none !important;
            }
            .criterion-comment-section:not(.has-content),
            .section-comment-section:not(.has-content) {
                display: none !important;
            }
            .criterion-comment-section.has-content,
            .section-comment-section.has-content {
                display: block !important;
                page-break-inside: avoid;
            }
        }
        
        /* Styles pour les lacunes */
        .lacune-rouge {
            background-color: #ffebee !important;
        }
        .lacune-orange {
            background-color: #fff3e0 !important;
        }
        .lacune-verte {
            background-color: #e8f5e8 !important;
        }
        
        /* Bouton d'impression */
        .print-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2c5aa0;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 4px 12px rgba(44, 90, 160, 0.3);
            z-index: 1000;
        }
        .print-button:hover {
            background: #1e3f70;
        }
        @media print {
            /* Masquer les éléments interactifs */
            .print-button, .mode-selector, .revision-controls, .missing-items { display: none !important; }
            .comment-button, .section-comment-button { display: none !important; }
            /* IMPORTANT: MASQUER LE MINUTEUR à L'IMPRESSION! */
            .timer-container {
                display: none !important;
                visibility: hidden !important;
                position: absolute !important;
                left: -9999px !important;
            }
            /* Supprimer les bordures gauches à l'impression */
            .criteria-row { border-left: none !important; }
            .communication-section { border-left: none !important; }
            .lacune-rouge { border-left: none !important; }
            .lacune-orange { border-left: none !important; }
            .lacune-verte { border-left: none !important; }
            
            /* Gestion des commentaires à l'impression */
            .criterion-comment-section:not(.has-content),
            .section-comment-section:not(.has-content) { display: none !important; }
            .section-comment-section.global:not(.has-content) { display: none !important; }
            .criterion-comment-section.has-content,
            .section-comment-section.has-content { display: block !important; }
            
            /* Les textareas conservent leur hauteur actuelle à l'impression */
            .comment-textarea {
                border: 1px solid #ccc !important;
                background: white !important;
                padding: 4px !important;
                margin-right: 15px !important;
                resize: none !important;
                font-size: 8pt !important;
                font-family: Arial, sans-serif !important;
                font-style: italic !important;
                color: #333 !important;
                border-radius: 2px !important;
                /* Conserver la hauteur actuelle */
                overflow: hidden !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            /* Sections commentaires */
            .criterion-comment-section {
                page-break-inside: avoid;
                margin: 6px 0 8px 15px !important;
                padding: 6px 8px !important;
                background: #f9f9f9 !important;
                border-left: 2px solid #666 !important;
                border-radius: 0 3px 3px 0 !important;
                box-shadow: none !important;
            }
            
            /* Cacher les sections de commentaires vides */
            .criterion-comment-section:not(.show) {
                display: none !important;
            }
            .criterion-comment-section.show:not(.has-content) {
                display: none !important;
            }
            
            .section-comment-section {
                page-break-inside: avoid;
                margin: 5px 0 10px 0 !important;
                padding: 6px 8px !important;
                background: #f5f5f5 !important;
                border: 1px solid #ccc !important;
                border-radius: 4px !important;
            }
            
            /* Cacher toutes les sections de commentaires vides à l'impression */
            .section-comment-section {
                display: none !important;
            }
            /* Montrer seulement les sections avec contenu */
            .section-comment-section.has-content {
                display: block !important;
            }
            
            /* Configuration de la page */
            @page { size: A4; margin: 10mm 9mm 10mm 10mm; }
            body { margin: 0; background: white !important; font-size: 9pt; }
            
            /* Optimisation du container et des marges */
            .container { 
                max-width: 100%; 
                margin: 0; 
                box-shadow: none; 
                padding: 0; 
                background: white !important;
            }
            
            /* Gestion du header pour qu'il ne soit jamais seul */
            .header { 
                page-break-after: avoid; 
                margin: 0;
                margin-bottom: 10px;
                padding: 10px;
                font-size: 8pt;
            }
            .header h1 { font-size: 14pt; margin: 0 0 5px 0; }
            
            /* Optimisation des signes vitaux */
            .vital-signs { gap: 10px; margin: 5px 0; }
            .vital-sign { padding: 5px; font-size: 8pt; }
            
            /* Forcer l'anamnèse à commencer sur la page 1 */
            .section:first-of-type { page-break-before: avoid !important; }
            .section:first-of-type .section-header { 
                page-break-after: avoid; 
                min-height: 20px;
            }
            .section:first-of-type .criteria-row:first-child { 
                page-break-before: avoid !important; 
            }
            
            /* Les autres sections peuvent se diviser si nécessaire */
            .section { 
                page-break-inside: auto; 
                margin-bottom: 15px;
            }
            .section-header { 
                page-break-after: avoid;
                font-size: 12pt;
                padding: 8px;
            }
            .section-content { padding: 8px; }
            
            /* Optimisation de la grille */
            .header-row { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px; 
                font-size: 8pt;
            }
            .header-row.communication-header { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px 60px; 
                padding: 5px 0;
            }
            .criteria-row { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px; 
                page-break-inside: avoid;
                padding: 8px 0 8px 5px;
            }
            .criteria-text { font-size: 8.5pt; line-height: 1.1 !important; }
            .sub-criteria { font-size: 7.5pt; padding-left: 15px; line-height: 1.1 !important; }
            .detail-row { font-size: 7.5pt; padding: 1px 0 1px 15px; line-height: 1.0; }
            .detail-text { font-size: 7.5pt; line-height: 1.1 !important; }
            .patient-response { font-size: 7.5pt; }
            .points-display { font-size: 14px; }
            
            /* Communication section */
            .communication-section-container {
                page-break-inside: avoid !important;
            }
            
            /* Cloture section */
            .cloture-section {
                page-break-inside: avoid !important;
            }
            .cloture-item {
                page-break-inside: avoid !important;
                margin-bottom: 10px;
                padding: 10px;
            }
            .cloture-title { font-size: 10pt; }
            .cloture-content { font-size: 8.5pt; line-height: 1.2 !important; }
            .communication-section { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px 60px;
                padding: 8px 0;
            }
            .communication-text { font-size: 8.5pt; }
            .communication-desc { font-size: 7pt; }
            
            /* Optimisation des sections spéciales */
            .dd-section { padding: 8px; margin: 0 0 5px 0; font-size: 8pt; }
            .dd-title { font-size: 9pt; }
            .dd-item { font-size: 8pt; margin-left: 15px; }
            
            .therapy-section { 
                padding: 8px; 
                margin: 0; 
                font-size: 8pt;
                background: rgba(255, 250, 230, 0.3) !important;
                color: #000 !important;
            }
            .therapy-title { font-size: 9pt; }
            
            .redflags-section { padding: 8px; margin: 5px 0; }
            .redflags-title { font-size: 9pt; }
            .redflags-text { font-size: 8.5pt; }
            .redflags-description { font-size: 7.5pt; }
            
            /* Optimisation des totaux */
            .total-sections { 
                gap: 6px;
                margin-bottom: 6px;
            }
            .total-label { 
                padding: 4px;
                font-size: 16px;
                border-radius: 8px 8px 0 0;
            }
            .total-body {
                padding: 3px;
                border-radius: 0 0 8px 8px;
            }
            .total-score,
            .total-note-globale {
                font-size: 32px;
            }
            .total-pourcent-body {
                padding: 6px;
                border-radius: 0 0 8px 8px;
            }
            .total-pourcent-sections {
                display: flex;
                flex-wrap: nowrap;
                gap: 4px;
                align-items: stretch;
            }
            .total-pourcent-section {
                flex: 0 0 auto;
                min-width: 60px;
                padding: 6px 8px;
                white-space: nowrap;
            }
            .total-section-label {
                font-size: 11px;
                margin-bottom: 3px;
                white-space: nowrap;
            }
            .total-pourcent-value {
                font-size: 20px;
            }
            .pourcent-body {
                padding: 2px 0;
            }
            
            /* Échelle de notation */
            .grade-scale { 
                padding: 10px; 
                margin-top: 15px;
                page-break-inside: avoid;
            }
            .grade-scale h3 { font-size: 11pt; margin: 0 0 5px 0; }
            .grade-row { padding: 3px 0; font-size: 8pt; }
            
            /* Optimisations pour les annexes à l'impression */
            .annexes { 
                page-break-before: always !important;
                margin-top: 0 !important;
                padding-top: 15px !important;
            }
            
            .annexes-grid { 
                display: grid !important; 
                grid-template-columns: repeat(2, 1fr) !important; 
                gap: 15px !important; 
                margin-top: 15px !important; 
            }
            
            .annexe-item { 
                page-break-inside: avoid !important;
                padding: 15px !important;
                border: 1px solid #ddd !important;
            }
            
            .annexe-title { 
                font-size: 10pt !important;
                margin-bottom: 5px !important;
            }
            
            .annexe-description { 
                font-size: 8pt !important;
                line-height: 1.3 !important;
                margin-bottom: 8px !important;
            }
            
            /* Réduire l'interligne des detail-row */
            .detail-row { 
                line-height: 1.1 !important; 
                padding: 2px 0 2px 15px !important;
            }
            
            /* Réduire et ajuster les checkboxes des détails */
            .detail-checkboxes { 
                text-align: right !important;
                padding-right: 5px !important;
            }
            .detail-checkbox input[type="checkbox"] { 
                transform: scale(0.8) !important;
                margin: 0 !important;
            }
            
            /* Page-break pour théorie pratique */
            .annexe-theorie-pratique { 
                page-break-before: always !important; 
            }
            
            /* Pas de page-break dans les scenario-section */
            .scenario-section, 
            .scenario-subsection { 
                page-break-inside: avoid !important; 
            }
            
            /* Réduire l'interligne dans toutes les annexes */
            .annexe-scenario-content,
            .annexe-interventions-content,
            .annexe-informations-content,
            .annexe-theorie-content { 
                line-height: 1.15 !important; 
            }
            
            /* Styles spécifiques pour les sections du scénario */
            .scenario-section {
                margin-bottom: 8px !important;
                padding: 4px !important;
            }
            
            .scenario-section h4 {
                font-size: 9.5pt !important;
                margin: 0 0 4px 0 !important;
                line-height: 1.1 !important;
                color: #2c5aa0 !important;
            }
            
            .scenario-subsection {
                margin-bottom: 4px !important;
                line-height: 1.1 !important;
            }
            
            .scenario-subsection strong {
                font-size: 8pt !important;
                color: #333 !important;
            }
            
            /* Listes dans les annexes */
            .annexe-scenario-content ul,
            .annexe-interventions-content ul,
            .annexe-informations-content ul,
            .annexe-theorie-content ul,
            .scenario-section ul,
            .scenario-subsection ul {
                margin: 2px 0 !important;
                padding-left: 16px !important;
            }
            
            .annexe-scenario-content li,
            .annexe-interventions-content li,
            .annexe-informations-content li,
            .annexe-theorie-content li,
            .scenario-section li,
            .scenario-subsection li {
                margin-bottom: 1px !important;
                line-height: 1.1 !important;
                font-size: 7.5pt !important;
            }
            
            /* Texte dans les sections */
            .scenario-section p,
            .scenario-subsection p {
                margin: 2px 0 !important;
                line-height: 1.1 !important;
                font-size: 7.5pt !important;
            }
            
            /* Info de base du patient */
            .scenario-info {
                font-size: 8pt !important;
                padding: 6px !important;
                margin-bottom: 8px !important;
                line-height: 1.2 !important;
            }
            
            /* Forcer les couleurs */
            * { 
                -webkit-print-color-adjust: exact !important; 
                print-color-adjust: exact !important; 
            }
            
            /* Fond blanc partout */
            body, .container, .section, .section-content { background: white !important; }
            
        }
    </style>
</head>
<body class="revision-mode">
    <!-- MODE SELECTOR -->
    <div class="mode-selector">
        <button class="mode-button active" onclick="switchMode('revision')">🔍 Révision</button>
        <button class="mode-button" onclick="switchMode('exam')">📝 Examen</button>
    </div>
    
    <!-- BOUTONS RÉVISION (Mode Révision uniquement) -->
    <div class="revision-controls">
        <button class="lacune-button" onclick="identifyLacunes()">🎯 Identifier les lacunes</button>
        <button class="reset-revision-button" onclick="resetTimer()">↻ Reset</button>
    </div>
    
    <!-- MINUTEUR ECOS -->
    <div class="timer-container" id="timerContainer">
        <div class="timer-display" id="timerDisplay">13:00</div>
        <div class="timer-controls">
            <button id="startBtn" class="timer-btn start-btn" onclick="startTimer()">▶ Démarrer</button>
            <button id="stopBtn" class="timer-btn stop-btn" onclick="stopTimer()" style="display: none;">⏸ Arrêter</button>
            <button id="resetBtn" class="timer-btn reset-btn" onclick="resetTimer()">↻ Reset</button>
        </div>
        <div class="timer-status" id="timerStatus" style="display: none;"></div>
    </div>

    <div class="container">
        <div class="header">
            <h1>Grille d'évaluation ECOS - AMBOSS-17 - Troubles de mémoire - Femme 70 ans</h1>
            <p style="margin: 5px 0;">📍 Cabinet médical</p>
            <p style="margin: 5px 0;">👤 Grace Ramirez, femme de 70 ans, consultant pour troubles de mémoire</p>
            <div class="vital-signs">
                <div class="vital-sign">
                    <div class="vital-sign-label">T°</div>
                    <div class="vital-sign-value">36.5°C</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">TA</div>
                    <div class="vital-sign-value">125/70 mmHg</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">FC</div>
                    <div class="vital-sign-value">70 bpm</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">FR</div>
                    <div class="vital-sign-value">18/min</div>
                </div>
            </div>
        </div>
        <!-- ANAMNÈSE -->
        <div class="section">
            <div class="section-header">
                <span>Anamnèse (25%)</span>
                <span class="score">Score : <span id="anamneseScore">0</span>/58</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Critères</div>
                    <div>Oui</div>
                    <div>±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row" id="criteria-a1">
    <div>
        <div class="criteria-text">1. Motif principal <span class="patient-response">[Ma fille voulait que je vienne. Elle dit que j'ai été très oublieuse dernièrement]</span> <button class="comment-button" onclick="toggleComment('a1')" title="Ajouter un commentaire">📝</button></div>
        <div class="criterion-comment-section" id="comment-section-a1">
            <textarea class="comment-textarea" id="comment-a1" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a1'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a1" value="2" data-criteria="Motif principal" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a1" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a1">0</div>
</div>
<div class="criteria-row" id="criteria-a2">
    <div>
        <div class="criteria-text">2. Caractérisation des troubles de mémoire <button class="comment-button" onclick="toggleComment('a2')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Début <span class="patient-response">[Depuis environ 2 ans]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-0" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Constant/intermittent <span class="patient-response">[Elle dit que je suis toujours aussi oublieuse. Je crois qu'elle est un peu dramatique]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-1" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Événements précipitants <span class="patient-response">[Aucun]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-2" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Progression <span class="patient-response">[Ma fille dit que ça s'est aggravé]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-3" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Épisodes antérieurs <span class="patient-response">[Aucun]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-4" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Facteurs améliorants <span class="patient-response">[Je pense que c'est un peu mieux si je dors suffisamment]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-5" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Facteurs aggravants <span class="patient-response">[Aucun]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-6" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-a2">
            <textarea class="comment-textarea" id="comment-a2" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a2'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a2">0</div>
</div>
<div class="criteria-row" id="criteria-a3">
    <div>
        <div class="criteria-text">3. Symptômes associés <span class="patient-response">[Je ne peux penser à rien en ce moment]</span> <button class="comment-button" onclick="toggleComment('a3')" title="Ajouter un commentaire">📝</button></div>
        <div class="criterion-comment-section" id="comment-section-a3">
            <textarea class="comment-textarea" id="comment-a3" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a3'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a3" value="2" data-criteria="Symptômes associés" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a3" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a3">0</div>
</div>
<div class="criteria-row" id="criteria-a4">
    <div>
        <div class="criteria-text">4. Recherche de symptômes spécifiques <button class="comment-button" onclick="toggleComment('a4')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Traumatisme <span class="patient-response">[Aucun]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-0" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Céphalées <span class="patient-response">[Aucune]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-1" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Fatigue <span class="patient-response">[Oui, je me sens vraiment fatiguée dernièrement]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-2" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Problèmes urinaires <span class="patient-response">[Parfois je n'arrive pas aux toilettes à temps]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-3" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Fréquence <span class="patient-response">[Peut-être une fois par jour. Surtout quand je me réveille le matin et que j'ai vraiment besoin d'y aller]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-4" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Problèmes intestinaux <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-5" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Problèmes de sommeil <span class="patient-response">[Je ne dors pas beaucoup. Je n'arrive pas à m'endormir, et puis je me réveille généralement vers 4h00-5h00]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-6" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Appétit <span class="patient-response">[Je n'ai pas beaucoup d'appétit]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-7" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Variations pondérales <span class="patient-response">[Je ne saurais pas, je ne me pèse pas]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-8" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Infections récentes <span class="patient-response">[Aucune]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-9" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Vertiges <span class="patient-response">[Parfois, si je me lève trop vite]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-10" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Problèmes de marche <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-11" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Chutes <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-12" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Intolérance au froid <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-13" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Cheveux secs <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-14" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-a4">
            <textarea class="comment-textarea" id="comment-a4" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a4'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a4">0</div>
</div>
<div class="criteria-row" id="criteria-a5">
    <div>
        <div class="criteria-text">5. Troubles cognitifs et fonctionnels <button class="comment-button" onclick="toggleComment('a5')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Se perdre <span class="patient-response">[Oui, peut-être une ou deux fois. Mon quartier change tellement. J'ai toujours fini par tomber sur ma fille, donc ce n'était pas un problème]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-0" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Hallucinations <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-1" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Faiblesse <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-2" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Engourdissement <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-3" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Picotements <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-4" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Aide requise pour s'habiller, manger, marcher, aller aux toilettes ou hygiène personnelle <span class="patient-response">[Je fais tout ça sans problème. Enfin, à part mes accidents en allant aux toilettes]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-5" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Aide requise pour faire les courses, le ménage, la comptabilité personnelle, cuisiner, le transport ou les médicaments <span class="patient-response">[Ma fille fait toutes ces choses pour moi]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-6" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-a5">
            <textarea class="comment-textarea" id="comment-a5" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a5'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a5">0</div>
</div>
<div class="criteria-row" id="criteria-a6">
    <div>
        <div class="criteria-text">6. État psychologique <button class="comment-button" onclick="toggleComment('a6')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Humeur <span class="patient-response">[Mon humeur n'a pas été bonne depuis que mon caniche est mort il y a environ un an]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-0" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Perte d'intérêt <span class="patient-response">[Je jouais au backgammon avec mes amies, mais je n'y vais plus]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-1" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Culpabilité/faible estime de soi <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-2" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Énergie faible <span class="patient-response">[Comme je l'ai dit, je me sens toujours fatiguée. Je pense que ça vient avec l'âge]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-3" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Concentration faible <span class="patient-response">[Je n'arrive pas à me concentrer sur quoi que ce soit. J'oublie constamment de finir ce que je commence, comme mes mots croisés le matin]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-4" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Agitation ou ralentissement psychomoteur <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-5" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Idées suicidaires <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-6" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Soutien social <span class="patient-response">[Ma fille prend très bien soin de moi]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-7" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-a6">
            <textarea class="comment-textarea" id="comment-a6" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a6'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a6">0</div>
</div>
<div class="criteria-row" id="criteria-a7">
    <div>
        <div class="criteria-text">7. Antécédents médicaux <span class="patient-response">[J'ai de l'hypertension]</span> <button class="comment-button" onclick="toggleComment('a7')" title="Ajouter un commentaire">📝</button></div>
        <div class="criterion-comment-section" id="comment-section-a7">
            <textarea class="comment-textarea" id="comment-a7" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a7'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a7" value="2" data-criteria="Antécédents médicaux" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a7" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a7">0</div>
</div>
<div class="criteria-row" id="criteria-a8">
    <div>
        <div class="criteria-text">8. Allergies <span class="patient-response">[Aucune]</span> <button class="comment-button" onclick="toggleComment('a8')" title="Ajouter un commentaire">📝</button></div>
        <div class="criterion-comment-section" id="comment-section-a8">
            <textarea class="comment-textarea" id="comment-a8" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a8'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a8" value="2" data-criteria="Allergies" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a8" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a8">0</div>
</div>
<div class="criteria-row" id="criteria-a9">
    <div>
        <div class="criteria-text">9. Médicaments <span class="patient-response">[Je prends de l'hydrochlorothiazide]</span> <button class="comment-button" onclick="toggleComment('a9')" title="Ajouter un commentaire">📝</button></div>
        <div class="criterion-comment-section" id="comment-section-a9">
            <textarea class="comment-textarea" id="comment-a9" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a9'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a9" value="2" data-criteria="Médicaments" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a9" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a9">0</div>
</div>
<div class="criteria-row" id="criteria-a10">
    <div>
        <div class="criteria-text">10. Hospitalisations et antécédents chirurgicaux <button class="comment-button" onclick="toggleComment('a10')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Hospitalisations <span class="patient-response">[J'ai dû aller à l'hôpital pour l'accouchement de mes deux enfants et quand on m'a enlevé la vésicule biliaire il y a environ 20 ans]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a10-detail-0" value="1" onchange="updateDetailScore('a10', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Antécédents chirurgicaux <span class="patient-response">[Juste les fois où j'ai dû aller à l'hôpital]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a10-detail-1" value="1" onchange="updateDetailScore('a10', 'a')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-a10">
            <textarea class="comment-textarea" id="comment-a10" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a10'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a10">0</div>
</div>
<div class="criteria-row" id="criteria-a11">
    <div>
        <div class="criteria-text">11. Antécédents familiaux <span class="patient-response">[Mon père est mort pendant la Seconde Guerre mondiale mais était en bonne santé, à ma connaissance. Ma mère était en bonne santé aussi, mais elle a attrapé une pneumonie quand elle était très âgée et est morte il y a environ 3 ans]</span> <button class="comment-button" onclick="toggleComment('a11')" title="Ajouter un commentaire">📝</button></div>
        <div class="criterion-comment-section" id="comment-section-a11">
            <textarea class="comment-textarea" id="comment-a11" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a11'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a11" value="2" data-criteria="Antécédents familiaux" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a11" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a11">0</div>
</div>
<div class="criteria-row" id="criteria-a12">
    <div>
        <div class="criteria-text">12. Habitudes et mode de vie <button class="comment-button" onclick="toggleComment('a12')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Occupation <span class="patient-response">[Eh bien, je suis retraitée maintenant. Mais j'ai possédé et géré mon propre café au centre-ville pendant de nombreuses années]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a12-detail-0" value="1" onchange="updateDetailScore('a12', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Domicile <span class="patient-response">[Je vis seule, mais ma fille vit dans la maison juste à côté]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a12-detail-1" value="1" onchange="updateDetailScore('a12', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Alcool <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a12-detail-2" value="1" onchange="updateDetailScore('a12', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Drogues illicites <span class="patient-response">[Jamais]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a12-detail-3" value="1" onchange="updateDetailScore('a12', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Tabac <span class="patient-response">[Jamais]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a12-detail-4" value="1" onchange="updateDetailScore('a12', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Exercice <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a12-detail-5" value="1" onchange="updateDetailScore('a12', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Alimentation <span class="patient-response">[Ma fille cuisine pour moi, mais elle n'a pas beaucoup de temps. Nous mangeons surtout des plats surgelés]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a12-detail-6" value="1" onchange="updateDetailScore('a12', 'a')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-a12">
            <textarea class="comment-textarea" id="comment-a12" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a12'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a12">0</div>
</div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('anamnese')" title="Commentaire sur cette section">📝 Commentaire sur la section Anamnèse</button>
                </div>
                <div class="section-comment-section" id="section-comment-anamnese">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur l'anamnèse</h4>
                    <textarea class="comment-textarea" id="comment-section-anamnese" placeholder="Commentaire sur la section anamnèse..." oninput="updateSectionComment('anamnese'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- EXAMEN CLINIQUE -->
        <div class="section">
            <div class="section-header">
                <span>Examen clinique (25%)</span>
                <span class="score">Score : <span id="statusScore">0</span>/31</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Critères</div>
                    <div>Oui</div>
                    <div>±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row" id="criteria-e1">
    <div>
        <div class="criteria-text">1. Mesures d'hygiène <button class="comment-button" onclick="toggleComment('e1')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Lavage des mains</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e1-detail-0" value="1" onchange="updateDetailScore('e1', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Respect de la pudeur avec drap</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e1-detail-1" value="1" onchange="updateDetailScore('e1', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e1">
            <textarea class="comment-textarea" id="comment-e1" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e1'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e1">0</div>
</div>
<div class="criteria-row" id="criteria-e2">
    <div>
        <div class="criteria-text">2. Examen de la tête, yeux, oreilles, nez et gorge <button class="comment-button" onclick="toggleComment('e2')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Inspection de la tête</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-0" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Palpation de la tête</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-1" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e2">
            <textarea class="comment-textarea" id="comment-e2" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e2'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e2">0</div>
</div>
<div class="criteria-row" id="criteria-e3">
    <div>
        <div class="criteria-text">3. Examen du cou <button class="comment-button" onclick="toggleComment('e3')" title="Ajouter un commentaire">📝</button></div>
<div class="sub-criteria">Examen de la glande thyroïde</div>        <div class="criterion-comment-section" id="comment-section-e3">
            <textarea class="comment-textarea" id="comment-e3" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e3'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="e3" value="2" data-criteria="Examen du cou" onchange="updateScore('e', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="e3" value="0" onchange="updateScore('e', this)" />
    </div>
    <div class="points-display" id="points-e3">0</div>
</div>
<div class="criteria-row" id="criteria-e4">
    <div>
        <div class="criteria-text">4. Examen des extrémités <button class="comment-button" onclick="toggleComment('e4')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Inspection des mains</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-0" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Inspection des membres inférieurs</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-1" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e4">
            <textarea class="comment-textarea" id="comment-e4" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e4'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e4">0</div>
</div>
<div class="criteria-row" id="criteria-e5">
    <div>
        <div class="criteria-text">5. Examen cutané <button class="comment-button" onclick="toggleComment('e5')" title="Ajouter un commentaire">📝</button></div>
        <div class="criterion-comment-section" id="comment-section-e5">
            <textarea class="comment-textarea" id="comment-e5" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e5'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="e5" value="2" data-criteria="Examen cutané" onchange="updateScore('e', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="e5" value="0" onchange="updateScore('e', this)" />
    </div>
    <div class="points-display" id="points-e5">0</div>
</div>
<div class="criteria-row" id="criteria-e6">
    <div>
        <div class="criteria-text">6. Examen neurologique <button class="comment-button" onclick="toggleComment('e6')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Examen ciblé des nerfs crâniens</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e6-detail-0" value="1" onchange="updateDetailScore('e6', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Examen ciblé des mouvements passifs et actifs</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e6-detail-1" value="1" onchange="updateDetailScore('e6', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Examen ciblé de la sensibilité</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e6-detail-2" value="1" onchange="updateDetailScore('e6', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Examen ciblé des réflexes ostéo-tendineux</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e6-detail-3" value="1" onchange="updateDetailScore('e6', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Examen ciblé de la marche</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e6-detail-4" value="1" onchange="updateDetailScore('e6', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Test des mouvements alternés rapides</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e6-detail-5" value="1" onchange="updateDetailScore('e6', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Test doigt-nez</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e6-detail-6" value="1" onchange="updateDetailScore('e6', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Signe de Babinski</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e6-detail-7" value="1" onchange="updateDetailScore('e6', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Test de Romberg</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e6-detail-8" value="1" onchange="updateDetailScore('e6', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e6">
            <textarea class="comment-textarea" id="comment-e6" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e6'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e6">0</div>
</div>
<div class="criteria-row" id="criteria-e7">
    <div>
        <div class="criteria-text">7. Mini-Mental State Examination (MMSE) <button class="comment-button" onclick="toggleComment('e7')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Orientation temporelle <span class="patient-response">[(Répondre avec jour, date et mois incorrects, mais saison et année correctes ; ou répondre avec président des États-Unis incorrect)]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-0" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Orientation spatiale <span class="patient-response">[(Répondre avec l'État correct, mais dire seulement 'Je suis à l'hôpital près de chez moi' à toutes les autres questions)]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-1" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Orientation personnelle <span class="patient-response">[Mon nom est Grace Ramirez. J'ai 70 ans. Mon anniversaire est le 14 mai]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-2" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Répéter ces trois mots : maison, balle, arbre <span class="patient-response">[Maison, balle, arbre]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-3" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Épeler monde (M-O-N-D-E) à l'envers <span class="patient-response">[E-D-N-O-M incorrect]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-4" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Répéter les trois mots que je vous ai dit plus tôt <span class="patient-response">[Je me souviens seulement de 'maison']</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-5" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Montrer stylo et papier et demander de nommer les objets <span class="patient-response">[Stylo et papier]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-6" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Répéter la phrase : 'Pas de si, ni de mais' <span class="patient-response">[(Faire comme l'examinateur dit)]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-7" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Lire ce que j'ai écrit sur ce papier et faire ce qu'il dit <span class="patient-response">[(Lire à voix haute correctement)]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-8" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Écrire une phrase sur le papier <span class="patient-response">[(Écrire : 'Je suis Grace Ramirez')]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-9" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Maintenant plier le papier et le mettre par terre <span class="patient-response">[(Faire comme l'examinateur dit et plier le papier et le mettre par terre)]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-10" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Copier l'image de deux pentagones entrecroisés <span class="patient-response">[(Copier l'image incorrectement)]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-11" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e7">
            <textarea class="comment-textarea" id="comment-e7" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e7'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e7">0</div>
</div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('examen')" title="Commentaire sur cette section">📝 Commentaire sur la section Examen</button>
                </div>
                <div class="section-comment-section" id="section-comment-examen">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur l'examen clinique</h4>
                    <textarea class="comment-textarea" id="comment-section-examen" placeholder="Commentaire sur la section examen clinique..." oninput="updateSectionComment('examen'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- MANAGEMENT -->
        <div class="section">
            <div class="section-header">
                <span>Management (25%)</span>
                <span class="score">Score : <span id="managementScore">0</span>/20</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Critères</div>
                    <div>Oui</div>
                    <div>±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row" id="criteria-m1">
    <div>
        <div class="criteria-text">1. Hypothèses diagnostiques <button class="comment-button" onclick="toggleComment('m1')" title="Ajouter un commentaire">📝</button></div>
<div class="scoring-rule">2 points si au moins 2 diagnostics pertinents mentionnés, 1 point si 1 diagnostic</div>        <div class="criterion-comment-section" id="comment-section-m1">
            <textarea class="comment-textarea" id="comment-m1" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('m1'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="2" data-criteria="Hypothèses diagnostiques" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="1" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="0" onchange="updateScore('m', this)" />
    </div>
    <div class="points-display" id="points-m1">0</div>
</div>
<div class="dd-section">
    <div class="dd-title">Diagnostics différentiels à considérer</div>
    <div class="dd-category">Causes neurodégénératives probables</div>
    <div class="dd-item">• Maladie d'Alzheimer <span class="dd-test">→ IRM cérébrale (atrophie hippocampique)</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;□ Troubles mnésiques insidieux depuis 2 ans<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Atteinte mémoire récente (rappel 3 mots : 1/3)<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Désorientation temporelle (jour, date, mois incorrects)<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Désorientation spatiale (se perd dans quartier)<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Troubles attentionnels (épeler à l'envers incorrect)<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Apraxie constructive (copie pentagones incorrecte)<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Perte autonomie instrumentale (fille fait courses, cuisine)<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Facteurs risque : âge 70, sexe F, HTA, sédentarité</div>
    <div class="dd-item">• Hydrocéphalie à pression normale <span class="dd-test">→ IRM cérébrale + ponction lombaire soustractive</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;□ Incontinence urinaire (1×/jour)<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Troubles cognitifs progressifs<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Âge compatible<br>Contre : Pas de troubles de la marche (triade d'Hakim incomplète)</div>
    <div class="dd-item">• Pseudodémence dépressive <span class="dd-test">→ Échelle dépression gériatrique</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;□ Symptômes dépressifs : humeur basse (mort caniche), anhédonie (arrêt backgammon)<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Fatigue, troubles sommeil, appétit diminué<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Troubles concentration<br>Contre : Troubles mnésiques précèdent dépression, début insidieux (pseudodémence = début brutal)</div>
    <div class="dd-category">Autres causes à exclure</div>
    <div class="dd-item">• Démence vasculaire <span class="dd-test">→ IRM cérébrale (lacunes, leucoaraïose)</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;">Arguments POUR : HTA (facteur risque)<br>Contre : Évolution progressive (pas par paliers)</div>
    <div class="dd-item">• Démence à corps de Lewy <span class="dd-test">→ DaTSCAN si doute</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;">Contre : Pas d'hallucinations visuelles, pas de fluctuations</div>
    <div class="dd-item">• Hypothyroïdie <span class="dd-test">→ TSH</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;">Arguments POUR : Fatigue, troubles mnésiques<br>Contre : Pas intolérance froid, pas cheveux secs</div>
    <div class="dd-item">• Carence en vitamine B12 <span class="dd-test">→ Vitamine B12 sérique</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;">Peut causer troubles cognitifs réversibles</div>
</div>
<div class="criteria-row" id="criteria-m2">
    <div>
        <div class="criteria-text">2. Examens d'imagerie <button class="comment-button" onclick="toggleComment('m2')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">IRM cérébrale <span class="patient-response">[Dans le cas de la maladie d'Alzheimer, une atrophie cérébrale généralisée ou focale peut être visible. L'hydrocéphalie à pression normale montrerait une dilatation des ventricules avec hyperintensités périventriculaires. La démence vasculaire montrerait de multiples lésions lacunaires et de la substance blanche. Une cause néoplasique de démence serait mieux visualisée par IRM]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-0" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">CT cérébral <span class="patient-response">[Dans le cas de la maladie d'Alzheimer, une atrophie cérébrale généralisée ou focale peut être visible. L'hydrocéphalie à pression normale montrerait une dilatation des ventricules avec hyperintensités périventriculaires. La démence vasculaire pourrait entraîner des lésions microangiopathiques dans la substance blanche ainsi que de multiples lésions lacunaires]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-1" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-m2">
            <textarea class="comment-textarea" id="comment-m2" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('m2'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m2">0</div>
</div>
<div class="criteria-row" id="criteria-m3">
    <div>
        <div class="criteria-text">3. Examens biologiques <button class="comment-button" onclick="toggleComment('m3')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">FSC <span class="patient-response">[La carence en vitamine B12 se manifesterait par une anémie mégaloblastique sur la FSC ainsi qu'une thrombocytopénie et/ou leucopénie dans certains cas. L'anémie peut causer de la fatigue]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m3-detail-0" value="1" onchange="updateDetailScore('m3', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">TSH <span class="patient-response">[pour exclure l'hypothyroïdie comme cause des symptômes cognitifs de cette patiente]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m3-detail-1" value="1" onchange="updateDetailScore('m3', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Vitamine B12 sérique <span class="patient-response">[pour exclure la carence en B12 comme cause des troubles de mémoire]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m3-detail-2" value="1" onchange="updateDetailScore('m3', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Glycémie, électrolytes <span class="patient-response">[pour exclure les déséquilibres glycémiques et électrolytiques comme causes des symptômes cognitifs de la patiente (ex: hypoglycémie, hypernatrémie)]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m3-detail-3" value="1" onchange="updateDetailScore('m3', 'm')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-m3">
            <textarea class="comment-textarea" id="comment-m3" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('m3'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m3">0</div>
</div>
<div class="criteria-row" id="criteria-m4">
    <div>
        <div class="criteria-text">4. Examens spécialisés <button class="comment-button" onclick="toggleComment('m4')" title="Ajouter un commentaire">📝</button></div>
<div class="sub-criteria">Ponction lombaire <span class="patient-response">[soulagerait les symptômes dans l'HPN (à la fois diagnostique et thérapeutique) ; montrerait ↓ bêta-amyloïde et ↑ tau phosphorylée dans la maladie d'Alzheimer]</span></div>        <div class="criterion-comment-section" id="comment-section-m4">
            <textarea class="comment-textarea" id="comment-m4" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('m4'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m4" value="2" data-criteria="Examens spécialisés" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m4" value="1" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m4" value="0" onchange="updateScore('m', this)" />
    </div>
    <div class="points-display" id="points-m4">0</div>
</div>
<div class="criteria-row" id="criteria-m5">
    <div>
        <div class="criteria-text">5. Communication avec la patiente <button class="comment-button" onclick="toggleComment('m5')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Explications à la patiente des impressions diagnostiques préliminaires</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-0" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Explication du plan de prise en charge</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-1" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Utilisation d'un langage non médical et clarification des termes médicaux</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-2" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Évaluation de l'accord de la patiente avec le plan diagnostique</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-3" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Recherche des préoccupations et questions de la patiente</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-4" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-m5">
            <textarea class="comment-textarea" id="comment-m5" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('m5'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m5">0</div>
</div>
<div class="criteria-row" id="criteria-m6">
    <div>
        <div class="criteria-text">6. Conseil et soutien <button class="comment-button" onclick="toggleComment('m6')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Conseil pour patients avec perte de mémoire et/ou troubles cognitifs</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m6-detail-0" value="1" onchange="updateDetailScore('m6', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Réaction appropriée au défi (être aimable, paraître intéressé par l'histoire de la patiente, ne pas interrompre)</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m6-detail-1" value="1" onchange="updateDetailScore('m6', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Discussion du rôle de l'aidante (fille)</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m6-detail-2" value="1" onchange="updateDetailScore('m6', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Planification du suivi</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m6-detail-3" value="1" onchange="updateDetailScore('m6', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Ressources de soutien disponibles</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m6-detail-4" value="1" onchange="updateDetailScore('m6', 'm')" /></label>    </div></div></div>        <div class="therapy-section">
            <div class="therapy-title">Prise en charge de la démence débutante</div>
            <div><span style="margin-left: 10px;">•</span> Interventions non pharmacologiques :<br />
              - Stimulation cognitive régulière<br />
              - Maintien activités sociales<br />
              - Exercice physique adapté<br />
              - Nutrition équilibrée<br />
              - Aménagement sécuritaire domicile<br />
            <span style="margin-left: 10px;">•</span> Si Alzheimer confirmé :<br />
              - Inhibiteurs cholinestérase (donépézil)<br />
              - Soutien aidants naturels<br />
              - Planification médico-légale précoce<br />
            <span style="margin-left: 10px;">•</span> Mesures préventives :<br />
              - Contrôle facteurs risque vasculaires<br />
              - Traitement dépression si présente<br />
              - Éviter anticholinergiques</div>
        </div>
        <div class="criterion-comment-section" id="comment-section-m6">
            <textarea class="comment-textarea" id="comment-m6" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('m6'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m6">0</div>
</div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('management')" title="Commentaire sur cette section">📝 Commentaire sur la section Management</button>
                </div>
                <div class="section-comment-section" id="section-comment-management">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur le management</h4>
                    <textarea class="comment-textarea" id="comment-section-management" placeholder="Commentaire sur la section management..." oninput="updateSectionComment('management'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- CLÔTURE -->
        <div class="section cloture-section">
            <div class="section-header">
                <span>Clôture de consultation</span>
            </div>
            <div class="section-content">
                <div class="cloture-item">
                    <h4 class="cloture-title">Défi : Bavardage et histoire personnelle</h4>
                    <div class="cloture-content">[Être très bavarde et essayer de raconter une histoire sur sa vie une ou deux fois quand l'examinateur pose des questions sur la famille]</div>
                </div>
                <div class="cloture-item">
                    <h4 class="cloture-title">Réponse type du candidat</h4>
                    <div class="cloture-content cloture-content-green">Mme Ramirez, c'est très intéressant ce que vous me racontez sur votre café. J'aimerais beaucoup en entendre plus, mais d'abord, permettez-moi de finir quelques questions importantes sur votre santé pour m'assurer de bien comprendre ce qui se passe. Nous aurons plus de temps pour discuter après. Maintenant, pouvez-vous me dire...</div>
                </div>
            </div>
        </div>
        <!-- COMMUNICATION -->
        <div class="section communication-section-container">
            <div class="section-header">
                <span>Communication (25%)</span>
                <span class="score">Score : <span id="communicationScore">0</span>/20</span>
            </div>
            <div class="section-content">
                <div class="header-row communication-header">
                    <div>Critères</div>
                    <div>A</div>
                    <div>B</div>
                    <div>C</div>
                    <div>D</div>
                    <div>E</div>
                </div>
                <div class="communication-section" id="criteria-c1">
                    <div>
                        <div class="communication-text">1. Réponse aux sentiments et besoins du patient <button class="comment-button" onclick="toggleComment('c1')" title="Ajouter un commentaire">📝</button></div>
                        <div class="communication-desc">Empathie, écoute active, validation des émotions<br />
Explique le déroulement de la consultation et vérifie les préoccupations du patient, commence l'anamnèse par une question ouverte ; reconnaît, verbalise et légitime les émotions, fournit du soutient</div>
                        <div class="criterion-comment-section" id="comment-section-c1">
                            <textarea class="comment-textarea" id="comment-c1" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('c1'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="A" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="B" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="C" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="D" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="E" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c2">
                    <div>
                        <div class="communication-text">2. Structure de l'entretien <button class="comment-button" onclick="toggleComment('c2')" title="Ajouter un commentaire">📝</button></div>
                        <div class="communication-desc">Organisation logique, transitions fluides, gestion du temps<br />
Se présente par son nom et sa fonction, les étapes de l'entretien sont identifiables et s'enchaînent de manière logique, gestion du temps, adaptation à la situation</div>
                        <div class="criterion-comment-section" id="comment-section-c2">
                            <textarea class="comment-textarea" id="comment-c2" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('c2'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="A" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="B" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="C" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="D" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="E" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c3">
                    <div>
                        <div class="communication-text">3. Expression verbale <button class="comment-button" onclick="toggleComment('c3')" title="Ajouter un commentaire">📝</button></div>
                        <div class="communication-desc">Clarté, vocabulaire adapté, vérification de la compréhension<br />
Langage adapté au niveau du patient, pas de jargon, explications compréhensibles, reformulations quand nécessaire, répétitions des points clés, fait une synthèse de la consultation, bonne articulation, ton et volume adéquats</div>
                        <div class="criterion-comment-section" id="comment-section-c3">
                            <textarea class="comment-textarea" id="comment-c3" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('c3'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="A" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="B" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="C" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="D" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="E" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c4">
                    <div>
                        <div class="communication-text">4. Expression non verbale <button class="comment-button" onclick="toggleComment('c4')" title="Ajouter un commentaire">📝</button></div>
                        <div class="communication-desc">Contact visuel, posture, gestuelle appropriée<br />
Distance interpersonnelle adéquate, posture adéquate, gestes adéquats, contact visuel et expression faciale adéquats, pauses quand nécessaire</div>
                        <div class="criterion-comment-section" id="comment-section-c4">
                            <textarea class="comment-textarea" id="comment-c4" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('c4'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="A" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="B" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="C" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="D" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="E" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c5">
                    <div>
                        <div class="communication-text">5. Évaluation générale de la communication <button class="comment-button" onclick="toggleComment('c5')" title="Ajouter un commentaire">📝</button></div>
                        <div class="communication-desc">Qualité globale de l'interaction médecin-patient</div>
                        <div class="criterion-comment-section" id="comment-section-c5">
                            <textarea class="comment-textarea" id="comment-c5" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('c5'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="A" data-criteria="Évaluation générale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="B" data-criteria="Évaluation générale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="C" data-criteria="Évaluation générale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="D" data-criteria="Évaluation générale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="E" data-criteria="Évaluation générale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('communication')" title="Commentaire sur cette section">📝 Commentaire sur la section Communication</button>
                </div>
                <div class="section-comment-section" id="section-comment-communication">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur la communication</h4>
                    <textarea class="comment-textarea" id="comment-section-communication" placeholder="Commentaire sur la section communication..." oninput="updateSectionComment('communication'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- TOTAUX -->
        <div class="total-sections">
            <div class="total-section">
                <div class="total-label">Score Global</div>
                <div class="total-body">
                    <div class="total-score" id="totalScore">0/129</div>
                </div>
            </div>
            <div class="total-section">
                <div class="total-label">% par Section</div>
                <div class="total-pourcent-body">
                    <div class="total-pourcent-sections">
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Anamnèse</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="anamnese-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Examen clinique</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="examen-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Management</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="management-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Communication</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="communication-percentage">0</span>%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="total-section">
                <div class="total-label">Note Globale</div>
                <div class="total-body">
                    <div class="total-note-globale" id="globalGrade">E</div>
                </div>
            </div>
        </div>
        <!-- ÉCHELLE DE NOTATION -->
        <div class="grade-scale" style="padding: 10px 15px; background: #f8f9fa; border-radius: 8px;">
            <h3 style="margin: 0 0 10px 0; font-size: 16px;">Échelle de notation</h3>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; text-align: center;">
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #2c974b;">A</div>
                    <div style="font-size: 12px; color: #666;">≥90%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #4e9cf0;">B</div>
                    <div style="font-size: 12px; color: #666;">80-89%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #f0ad4e;">C</div>
                    <div style="font-size: 12px; color: #666;">70-79%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #e67e22;">D</div>
                    <div style="font-size: 12px; color: #666;">60-69%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #d9534f;">E</div>
                    <div style="font-size: 12px; color: #666;">&lt;60%</div>
                </div>
            </div>
        </div>
        <!-- ÉLÉMENTS MANQUANTS (MASQUÉS) -->
        <!-- <div class="missing-items" id="missingItems" style="display: none;">
            <h3>Éléments non évalués</h3>
            <div id="missingList"></div>
        </div> -->
<div class="annexes">
<h3>Annexes</h3>
<div class="annexes-grid">
<div class="annexe-item">
    <div class="annexe-title">Figure de pentagones entrecroisés (MMSE)</div>
    <div class="annexe-description">Test de praxie constructive du MMSE : deux pentagones se chevauchant.<br>La copie incorrecte suggère des troubles visuospatiaux.</div>
    <div class="annexe-image">
        <img src="/Users/damienfulliquet/Documents/-Medecine/-EXAMEN_FEDERAL/-ECOS_2025/-SSP/Cas cliniques traduits/Traduits/HTML/grilles_generees/html/images/AMBOSS-17-img1-Figure of intersecting pentagons (MMSE).jpg" alt="Figure de pentagones entrecroisés (MMSE)" />
    </div>
</div>
<div class="annexe-item">
    <div class="annexe-title">Atrophie cérébrale dans la maladie d'Alzheimer</div>
    <div class="annexe-description">IRM cérébrale chez deux patients (A et B) d'âge similaire (pondération T1 axiale, coronale et sagittale).<br>A1-A3 : Atrophie cérébrale diffuse et symétrique affectant le lobe frontal et le lobe temporo-pariétal ainsi que la région hippocampique.<br>Le système ventriculaire est dilaté secondairement à l'atrophie parenchymateuse (hydrocéphalie ex vacuo).<br>B1-B3 : Cerveau normal.<br>L'aspect IRM en A1-A3 est caractéristique de la maladie d'Alzheimer avancée.</div>
    <div class="annexe-image">
        <img src="/Users/damienfulliquet/Documents/-Medecine/-EXAMEN_FEDERAL/-ECOS_2025/-SSP/Cas cliniques traduits/Traduits/HTML/grilles_generees/html/images/AMBOSS-17-img2-Cerebral atrophy in Alzheimer disease.jpg" alt="Atrophie cérébrale dans la maladie d'Alzheimer" />
    </div>
</div>
<div class="annexe-item">
    <div class="annexe-title">Atrophie cérébrale dans la maladie d'Alzheimer 3/3</div>
    <div class="annexe-description">IRM cérébrale (pondération T2 ; plan axial) d'un patient avec troubles mnésiques croissants.<br>L'atrophie du lobe temporal médian est accompagnée d'un élargissement de l'espace sous-arachnoïdien (superposition verte) et d'une dilatation des cornes temporales des ventricules latéraux (superposition rouge).<br>Ces changements morphologiques ont été observés dans le contexte de la maladie d'Alzheimer.</div>
    <div class="annexe-image">
        <img src="/Users/damienfulliquet/Documents/-Medecine/-EXAMEN_FEDERAL/-ECOS_2025/-SSP/Cas cliniques traduits/Traduits/HTML/grilles_generees/html/images/AMBOSS-17-img3-Cerebral atrophy in Alzheimer disease 3:3.jpg" alt="Atrophie cérébrale dans la maladie d'Alzheimer 3/3" />
    </div>
</div>
<div class="annexe-item">
    <div class="annexe-title">Hydrocéphalie à pression normale</div>
    <div class="annexe-description">CT cérébral (plan axial) d'un patient avec symptômes d'hydrocéphalie à pression normale.<br>Il y a une dilatation du troisième ventricule, ainsi que des ventricules latéraux (superposition verte) avec œdème périventriculaire associé (superposition rouge).<br>On observe également des espaces sous-arachnoïdiens disproportionnément élargis (DESH).</div>
    <div class="annexe-image">
        <img src="/Users/damienfulliquet/Documents/-Medecine/-EXAMEN_FEDERAL/-ECOS_2025/-SSP/Cas cliniques traduits/Traduits/HTML/grilles_generees/html/images/AMBOSS-17-img4-Normal pressure hydrocephalus.jpg" alt="Hydrocéphalie à pression normale" />
    </div>
</div>
<div class="annexe-item">
    <div class="annexe-title">Encéphalopathie athérosclérotique sous-corticale 1/2</div>
    <div class="annexe-description">CT cérébral (sans contraste ; plan axial).<br>Des zones anormales de faible atténuation sont visibles dans la substance blanche périventriculaire adjacente aux cornes frontales et temporales des ventricules latéraux (superposition verte).<br>Les sillons cérébraux (exemples indiqués par la superposition rouge) et les ventricules sont également proéminents.<br>Ces résultats peuvent être observés dans la démence vasculaire.</div>
    <div class="annexe-image">
        <img src="/Users/damienfulliquet/Documents/-Medecine/-EXAMEN_FEDERAL/-ECOS_2025/-SSP/Cas cliniques traduits/Traduits/HTML/grilles_generees/html/images/AMBOSS-17-img5-Subcortical atherosclerotic encephalopathy 1:2.jpg" alt="Encéphalopathie athérosclérotique sous-corticale 1/2" />
    </div>
</div>
<div class="annexe-item annexe-scenario">
    <div class="annexe-title">Scénario pour la patiente standardisée</div>
    <div class="annexe-scenario-content">
        <div class="scenario-info">
            <strong>Nom :</strong> Grace Ramirez |             <strong>Âge :</strong> 70 ans<br>
            <strong>Contexte :</strong> Femme retraitée consultant pour troubles de mémoire sur insistance de sa fille
        </div>
        <div class="scenario-section">
            <h4>Motif de consultation</h4>
            <p><strong>Plainte principale :</strong> «Ma fille voulait que je vienne. Elle dit que j'ai été très oublieuse dernièrement.»</p>
            <p><strong>Si on demande s'il y a autre chose :</strong> «Je crois qu'elle est un peu dramatique.»</p>
        </div>
        <div class="scenario-section">
            <h4>Consignes</h4>
            <ul>
                <li>Agir oublieuse mais ne pas sembler trop préoccupée par cela.</li>
                <li>Quand l'examinateur teste votre orientation et votre mémoire, répondre avec les réponses fournies dans la section examen.</li>
                <li>Vous n'êtes pas au courant de la signification des termes médicaux (ex: CT, IRM) et demandez des clarifications si l'examinateur les utilise.</li>
                <li>Défi : Être très bavarde et essayer de raconter une histoire sur votre vie une ou deux fois quand l'examinateur vous pose des questions sur votre famille. Si l'examinateur est aimable, paraît intéressé et ne vous interrompt pas, finir rapidement l'histoire et le laisser poser la question suivante.</li>
            </ul>
        </div>
        <div class="scenario-section">
            <h4>Histoire actuelle</h4>
            <div class="scenario-subsection">
                <strong>Symptôme principal :</strong>
                <ul>
                    <li>Oublis depuis 2 ans selon fille</li>
                    <li>Minimisation des symptômes</li>
                    <li>Progression notée par entourage</li>
                    <li>Pas de conscience claire du déficit</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Symptômes associés :</strong>
                <ul>
                    <li>Incontinence urinaire occasionnelle</li>
                    <li>Fatigue constante</li>
                    <li>Troubles du sommeil</li>
                    <li>Perte d'appétit</li>
                    <li>Episodes de désorientation spatiale</li>
                    <li>Perte d'autonomie instrumentale</li>
                    <li>Symptômes dépressifs depuis mort caniche</li>
                </ul>
            </div>
        </div>
        <div class="scenario-section">
            <h4>Simulation</h4>
            <div class="scenario-subsection">
                <strong>Durant l'entretien :</strong>
                <ul>
                    <li>Paraître détendue et peu concernée</li>
                    <li>Minimiser les symptômes</li>
                    <li>Tendance à digresser</li>
                    <li>Raconter histoires sur sa vie</li>
                    <li>Demander clarifications termes médicaux</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Durant le status :</strong>
                <ul>
                    <li>Coopération normale aux examens physiques</li>
                    <li>Erreurs spécifiques au MMSE selon script</li>
                    <li>Orientation : erreurs jour/date/mois</li>
                    <li>Rappel : 1/3 mots seulement</li>
                    <li>Épellation inversée incorrecte</li>
                    <li>Copie pentagones incorrecte</li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="annexe-item annexe-informations-expert">
    <div class="annexe-title">Informations de l'expert</div>
    <div class="annexe-informations-content">
        <div class="info-section">
            <h4>Dossier médical de l'entretien</h4>
            <p>Femme de 70 ans avec démence débutante probable type Alzheimer. Présentation classique : troubles mnésiques insidieux, désorientation temporo-spatiale, perte autonomie instrumentale. Score MMSE estimé 20-22/30 (démence légère). Facteurs risque : âge, sexe F, HTA. Composante dépressive réactionnelle. Diagnostic différentiel inclut HPN (mais triade incomplète) et pseudodémence (mais chronologie défavorable).</p>
        </div>
        <div class="info-section">
            <h4>Rôles et interventions de l'expert·e</h4>
            <div class="roles-interventions">
                <p style="margin: 5px 0; padding-left: 0;">L'expert-e intervient si l'étudiant-e fait :</p>
                <p style="margin: 5px 0; padding-left: 0;">• MMSE complet : Score 21/30</p>
                <p style="margin: 5px 0; padding-left: 0;">• IRM cérébrale : Atrophie hippocampique bilatérale, atrophie corticale modérée</p>
                <p style="margin: 5px 0; padding-left: 0;">• TSH : 2.8 mUI/L (normale)</p>
                <p style="margin: 5px 0; padding-left: 0;">• Vitamine B12 : 320 pg/mL (normale)</p>
                <p style="margin: 5px 0; padding-left: 0;">• FSC : Hb 13.2 g/dL (normale)</p>
                <p style="margin: 5px 0; padding-left: 0;">• Si PL faite : Protéine tau élevée, β-amyloïde diminuée</p>
            </div>
        </div>
        <div class="info-section">
            <h4>Points clés</h4>
            <ul>
                <li>MMSE < 24/30 = démence (ajuster selon éducation)</li>
                <li>Alzheimer = démence la plus fréquente (60-70%)</li>
                <li>Diagnostic clinique + exclusion causes réversibles</li>
                <li>Toujours rechercher causes traitables (B12, thyroïde)</li>
                <li>Impliquer aidants dès diagnostic</li>
                <li>Planification précoce (directives anticipées)</li>
            </ul>
        </div>
        <div class="info-section">
            <h4>Pièges</h4>
            <ul>
                <li>Accepter minimisation de la patiente</li>
                <li>Ne pas faire MMSE complet</li>
                <li>Oublier causes réversibles</li>
                <li>Ne pas évaluer sécurité domicile</li>
                <li>Interrompre histoires (perd alliance thérapeutique)</li>
            </ul>
        </div>
    </div>
</div>
<div class="annexe-item annexe-theorie-pratique">
    <div class="annexe-title">Théorie pratique concernant la vignette</div>
    <div class="annexe-theorie-content">
        <div class="theorie-section">
            <h4>Diagnostic le plus probable</h4>
            <p>Maladie d'Alzheimer au stade léger</p>
        </div>
        <div class="theorie-section">
            <h4>Maladie d'Alzheimer</h4>
            <p>Démence neurodégénérative la plus fréquente :</p>
            <ul>
                <li>Prévalence : 5% à 65 ans, double tous les 5 ans</li>
                <li>Pathologie : plaques amyloïdes + dégénérescence neurofibrillaire</li>
                <li>Début insidieux, progression lente (8-10 ans)</li>
                <li>Atteinte hippocampique précoce → troubles mnésiques</li>
                <li>Stades : léger (MMSE 20-24), modéré (10-19), sévère (<10)</li>
                <li>Facteurs risque : âge, APOE ε4, sexe F, bas niveau éducation</li>
            </ul>
        </div>
        <div class="theorie-section">
            <h4>Présentation clinique Alzheimer</h4>
            <p>Critères diagnostiques majeurs :</p>
            <ul>
                <li>Troubles mémoire épisodique : oublis répétés, questions itératives</li>
                <li>Début insidieux, progression > 6 mois</li>
                <li>Syndrome amnésique hippocampique : encodage déficitaire</li>
                <li>Troubles associés : langage, praxies, gnosies, fonctions exécutives</li>
                <li>Anosognosie fréquente (minimisation déficits)</li>
                <li>Troubles comportement : apathie, anxiété, dépression</li>
            </ul>
        </div>
        <div class="theorie-section">
            <h4>Mini-Mental State Examination</h4>
            <p>Outil de dépistage cognitif :</p>
            <ul>
                <li>Score total /30 points</li>
                <li>Orientation : 10 points (temps 5, lieu 5)</li>
                <li>Enregistrement : 3 points</li>
                <li>Attention/calcul : 5 points</li>
                <li>Rappel : 3 points</li>
                <li>Langage : 8 points</li>
                <li>Praxie constructive : 1 point</li>
                <li>Seuils : Normal ≥ 27, démence < 24 (ajuster éducation)</li>
            </ul>
        </div>
        <div class="theorie-section">
            <h4>Hydrocéphalie à pression normale</h4>
            <p>Diagnostic différentiel important :</p>
            <ul>
                <li>Triade d'Hakim : troubles marche + incontinence + démence</li>
                <li>Marche : magnétique, petit pas, élargissement polygone</li>
                <li>Incontinence : urgence puis incontinence vraie</li>
                <li>Démence : sous-corticale, ralentissement psychomoteur</li>
                <li>IRM : dilatation ventriculaire, angle calleux < 40°</li>
                <li>Test : PL soustractive 30-50 mL améliore symptômes</li>
            </ul>
        </div>
        <div class="theorie-section">
            <h4>Bilan démence</h4>
            <p>Évaluation systématique obligatoire :</p>
            <ul>
                <li>Anamnèse détaillée + hétéroanamnèse +++</li>
                <li>Examen neurologique complet + MMSE</li>
                <li>Bilan causes réversibles : TSH, B12, folates, calcémie</li>
                <li>Imagerie : IRM > CT (atrophie, lacunes, tumeur)</li>
                <li>Si doute : neuropsychologie, PL (biomarqueurs)</li>
                <li>Évaluation fonctionnelle : ADL, IADL</li>
            </ul>
        </div>
        <div class="theorie-section">
            <h4>Prise en charge Alzheimer</h4>
            <p>Approche globale multidisciplinaire :</p>
            <ul>
                <li>Annonce diagnostique avec tact, présence aidant</li>
                <li>Traitement spécifique : anticholinestérasiques si MMSE 10-26</li>
                <li>Interventions non pharmacologiques : stimulation cognitive</li>
                <li>Prise en charge troubles comportement</li>
                <li>Soutien aidants : formation, répit, groupes</li>
                <li>Anticipation : tutelle, directives anticipées, conduite</li>
            </ul>
        </div>
    </div>
</div>
<div class="annexe-item annexe-rappels-therapeutiques">
    <div class="annexe-title">Rappels thérapeutiques</div>
    <div class="annexe-theorie-content">
        <ul class="rappels-list">
            <li>Inhibiteurs cholinestérase : Donépézil 5mg → 10mg/j (stade léger-modéré)</li>
            <li>Alternative : Rivastigmine patch 4.6 → 9.5mg/24h</li>
            <li>Mémantine : 5mg → 20mg/j (stade modéré-sévère, MMSE < 15)</li>
            <li>Antidépresseurs si dépression : Sertraline 50-100mg/j</li>
            <li>Éviter benzodiazépines (confusion) et anticholinergiques</li>
            <li>Mélatonine 2-6mg si troubles sommeil</li>
            <li>Vitamine D 800-1000 UI/j (prévention chutes)</li>
        </ul>
    </div>
</div>
<div class="annexe-item annexe-examens-complementaires">
    <div class="annexe-title">Examens complémentaires</div>
    <div class="annexe-theorie-content">
        <ul class="examens-list">
            <li>MMSE : Dépistage initial, suivi évolution (sensibilité 80%)</li>
            <li>MoCA : Plus sensible troubles exécutifs précoces</li>
            <li>IRM cérébrale : Atrophie hippocampique, exclusion autres causes</li>
            <li>TSH, vitamine B12 : Causes réversibles démence</li>
            <li>Biomarqueurs LCR : Aβ42↓, tau↑, p-tau↑ (si doute diagnostique)</li>
            <li>TEP amyloïde/tau : Recherche si présentation atypique</li>
        </ul>
    </div>
</div>
</div>
</div>
        <!-- COMMENTAIRE GÉNÉRAL -->
        <div class="section-comment-section global">
            <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 18px;">Commentaire général</h4>
            <textarea class="comment-textarea" id="comment-general" placeholder="Commentaire général sur l'évaluation..." oninput="updateGeneralComment(); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <script>
        // Déclaration des variables globales
        window.audioContext = null;
        
        function updateScore(section, element) {
            const value = element.value;
            const name = element.name;
            let pointValue;

            if (section === "communication") {
                const map = { A: 4, B: 3, C: 2, D: 1, E: 0 };
                pointValue = map[value] || 0;
                // Mettre à jour la classe de couleur pour communication
                const criteriaRow = document.getElementById("criteria-" + name);
                if (criteriaRow) {
                    criteriaRow.classList.remove("score-a", "score-b", "score-c", "score-d", "score-e", "lacune-rouge", "lacune-orange", "lacune-verte");
                    criteriaRow.classList.add("score-" + value.toLowerCase());
                    // Ajouter les classes lacune pour communication
                    if (value === "E" || value === "D") {
                        criteriaRow.classList.add("lacune-rouge");
                    } else if (value === "C") {
                        criteriaRow.classList.add("lacune-orange");
                    } else if (value === "A" || value === "B") {
                        criteriaRow.classList.add("lacune-verte");
                    }
                }
            } else {
                pointValue = Number(value) || 0;
                // Mettre à jour la classe de couleur pour autres critères
                const criteriaRow = document.getElementById("criteria-" + name);
                if (criteriaRow) {
                    criteriaRow.classList.remove("score-0", "score-1", "score-2", "lacune-rouge", "lacune-orange", "lacune-verte");
                    criteriaRow.classList.add("score-" + value);
                    // Ajouter les classes lacune pour critères normaux
                    if (pointValue === 0) {
                        criteriaRow.classList.add("lacune-rouge");
                    } else if (pointValue === 1) {
                        criteriaRow.classList.add("lacune-orange");
                    } else if (pointValue >= 2) {
                        criteriaRow.classList.add("lacune-verte");
                    }
                }
            }

            const pointsElement = document.getElementById("points-" + name);
            if (pointsElement) {
                pointsElement.textContent = pointValue;
            }

            calculateScores();
        }

        function updateDetailScore(criterionId, prefix) {
            let totalScore = 0;
            const detailCheckboxes = document.querySelectorAll('input[id^="' + criterionId + '-detail-"]');
            const maxDetailsScore = detailCheckboxes.length;
            
            detailCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    totalScore += Number(checkbox.value) || 0;
                }
            });
            
            const pointsElement = document.getElementById("points-" + criterionId);
            if (pointsElement) {
                pointsElement.textContent = totalScore;
            }
            
            // Mettre à jour la classe de couleur en fonction du score et du max
            const criteriaRow = document.getElementById("criteria-" + criterionId);
            if (criteriaRow) {
                criteriaRow.classList.remove("score-0", "score-1", "score-2", "score-3", "score-4", "score-5", "score-max", "lacune-rouge", "lacune-orange", "lacune-verte");
                
                // Déterminer la classe appropriée avec les seuils 1/3 et 2/3
                const oneThird = maxDetailsScore / 3;
                const twoThirds = (maxDetailsScore * 2) / 3;
                
                if (totalScore < oneThird) {
                    criteriaRow.classList.add("score-0");
                    criteriaRow.classList.add("lacune-rouge");
                } else if (totalScore > twoThirds) {
                    criteriaRow.classList.add("score-max");
                    criteriaRow.classList.add("lacune-verte");
                } else {
                    // Score entre 1/3 et 2/3
                    criteriaRow.classList.add("score-1");
                    criteriaRow.classList.add("lacune-orange");
                }
            }
            
            calculateScores();
        }

        function calculateScores() {
            const isNewFormat = false;
            const missingItems = [];
            let scores = {};
            let maxScores = {};
            let coef = {};
            let sectionInfo = [];

            // Configuration pour le format traditionnel
            scores = {anamnese: 0, examen: 0, management: 0, communication: 0};
            maxScores = {anamnese: 58, examen: 31, management: 20, communication: 20};
            coef = {anamnese: 0.25, examen: 0.25, management: 0.25, communication: 0.25};
            sectionInfo = [
                {key: "anamnese", prefix: "a", count: 12, label: "Anamnèse"},
                {key: "examen", prefix: "e", count: 7, label: "Examen clinique", scoreId: "statusScore"},
                {key: "management", prefix: "m", count: 6, label: "Management"},
                {key: "communication", prefix: "c", count: 5, label: "Communication", isComm: true}
            ];

            // Calcul des scores pour chaque section
            sectionInfo.forEach(section => {
                let sectionScore = 0;
                
                if (section.isComm) {
                    // Section communication spéciale
                    for (let i = 1; i <= section.count; i++) {
                        const radio = document.querySelector("input[name=\"" + section.prefix + i + "\"]:checked");
                        if (radio) {
                            const val = radio.value;
                            const map = { A: 4, B: 3, C: 2, D: 1, E: 0 };
                            sectionScore += map[val] || 0;
                        } else {
                            const criteria = document.querySelector("input[name=\"" + section.prefix + i + "\"][data-criteria]");
                            if (criteria) missingItems.push(section.label + " : " + criteria.dataset.criteria);
                        }
                    }
                } else {
                    // Sections normales
                    for (let i = 1; i <= section.count; i++) {
                        const criterionId = section.prefix + i;
                        // Vérifier si ce critère a des détails avec checkboxes
                        const detailCheckboxes = document.querySelectorAll('input[id^="' + criterionId + '-detail-"]');
                        
                        if (detailCheckboxes.length > 0) {
                            // Ce critère a des détails, on calcule le score basé sur les détails
                            let detailScore = 0;
                            let hasCheckedDetail = false;
                            detailCheckboxes.forEach(checkbox => {
                                if (checkbox.checked) {
                                    detailScore += Number(checkbox.value) || 0;
                                    hasCheckedDetail = true;
                                }
                            });
                            sectionScore += detailScore;
                            
                            if (!hasCheckedDetail) {
                                const criteria = document.querySelector("input[name=\"" + criterionId + "\"][data-criteria]");
                                if (criteria) {
                                    missingItems.push(section.label + " : " + criteria.dataset.criteria);
                                } else {
                                    // Rechercher le texte du critère directement
                                    const criteriaText = document.querySelector("#criteria-" + criterionId + " .criteria-text");
                                    if (criteriaText) {
                                        missingItems.push(section.label + " : " + criteriaText.textContent.split(". ")[1].split(" [")[0]);
                                    }
                                }
                            }
                        } else {
                            // Critère normal sans détails
                            const radio = document.querySelector("input[name=\"" + criterionId + "\"]:checked");
                            if (radio) {
                                sectionScore += Number(radio.value) || 0;
                            } else {
                                const criteria = document.querySelector("input[name=\"" + criterionId + "\"][data-criteria]");
                                if (criteria) missingItems.push(section.label + " : " + criteria.dataset.criteria);
                            }
                        }
                    }
                }
                
                scores[section.key] = sectionScore;
                const scoreId = section.scoreId || section.key + "Score";
                const scoreElement = document.getElementById(scoreId);
                if (scoreElement) scoreElement.textContent = sectionScore;
            });

            // Calcul des pourcentages par section
            let percentages = {};
            let globalPercentage = 0;
            let isStarted = false;
            
            sectionInfo.forEach(section => {
                const score = scores[section.key];
                const max = maxScores[section.key];
                const percentage = max > 0 ? (score / max) * 100 : 0;
                percentages[section.key] = percentage;
                globalPercentage += percentage * coef[section.key];
                if (score > 0) isStarted = true;
            });

            const totalScoreText = isStarted ? Math.round(globalPercentage) : 0;
            document.getElementById("totalScore").textContent = totalScoreText + "%";

            // Mise à jour des pourcentages affichés
            sectionInfo.forEach(section => {
                const percentageElement = document.getElementById(section.key + "-percentage");
                if (percentageElement) {
                    percentageElement.textContent = Math.round(percentages[section.key]);
                }
            });

            const gradeElement = document.getElementById("globalGrade");
            const totalScoreElement = document.getElementById("totalScore");
            const scoreBody = totalScoreElement ? totalScoreElement.closest(".total-body") : null;
            const gradeBody = gradeElement ? gradeElement.closest(".total-body") : null;
            const sections = sectionInfo.map(s => s.key);

            const allClasses = ["note-a", "note-b", "note-c", "note-d", "note-e", "note-neutral"];

            function getClass(p) {
                if (p === 0) return "note-neutral";
                if (p >= 90) return "note-a";
                if (p >= 80) return "note-b";
                if (p >= 70) return "note-c";
                if (p >= 60) return "note-d";
                return "note-e";
            }

            const gradeClass = getClass(globalPercentage);
            const gradeLabel = isStarted ? gradeClass.split("-")[1].toUpperCase() : "A-E";
            if (gradeElement) gradeElement.textContent = gradeLabel;

            const pourcentBody = document.querySelector(".total-pourcent-body");

            [gradeElement, scoreBody, gradeBody, pourcentBody].forEach(el => {
                if (el) {
                    el.classList.remove(...allClasses);
                    el.classList.add(gradeClass);
                }
            });

            sections.forEach(id => {
                const percentageElement = document.getElementById(id + "-percentage");
                if (percentageElement) {
                    const value = parseInt(percentageElement.textContent);
                    const section = percentageElement.closest(".total-pourcent-section");
                    const sectionClass = getClass(value);
                    if (section) {
                        section.classList.remove(...allClasses);
                        section.classList.add(sectionClass);
                    }
                }
            });

            // Appliquer les couleurs aux sections principales
            sectionInfo.forEach(section => {
                const percentage = percentages[section.key];
                const allSections = document.querySelectorAll(".section");
                allSections.forEach(sectionEl => {
                    const headerText = sectionEl.querySelector(".section-header")?.textContent || "";
                    if (headerText.includes(section.label)) {
                        const sectionClass = getClass(percentage);
                        sectionEl.classList.remove(...allClasses);
                        sectionEl.classList.add(sectionClass);
                    }
                });
            });

            if (missingItems.length > 0) {
                document.getElementById("missingItems").style.display = "block";
                document.getElementById("missingList").innerHTML = missingItems.map(item =>
                    "<div class=\"missing-item\">• " + item + "</div>"
                ).join("");
            } else {
                document.getElementById("missingItems").style.display = "none";
            }
        }
        // MINUTEUR ECOS 13 MINUTES
        window.timerInterval = null;
        window.currentSeconds = 13 * 60;
        window.isRunning = false;
        window.hasStarted = false;
        window.hasFinished = false;
        window.hasStoppedManually = false;

        window.currentMode = 'revision';

        function colorPatientResponses() {
            // Version simplifiée inspirée du générateur v1
            const elements = document.querySelectorAll('.criteria-text, .sub-criteria, .redflags-text, .dd-item, .therapy-section, .detail-text, .cloture-content');
            elements.forEach(element => {
                const text = element.innerHTML;
                // Colorer uniquement les réponses patient en bleu (pas les examens complémentaires)
                let coloredText = text.replace(/\[([^\]]+)\]/g, '<span style="color: rgb(44, 90, 160); font-weight: 500;">[$1]</span>');
                element.innerHTML = coloredText;
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            switchMode('revision');
            calculateScores();
            colorPatientResponses();
            // Appeler une deuxième fois après un court délai pour s'assurer que tout est chargé
            setTimeout(function() {
                colorPatientResponses();
            }, 100);
            // Appel supplémentaire après un délai plus long pour garantir que tout est chargé
            setTimeout(function() {
                colorPatientResponses();
            }, 500);
            // Auto-resize tous les textareas au chargement
            const allTextareas = document.querySelectorAll('.comment-textarea');
            allTextareas.forEach(textarea => {
                if (textarea.value) {
                    autoResizeTextarea(textarea);
                }
            });
        });
        
        // S'assurer que la hauteur est bien définie avant l'impression
        window.addEventListener('beforeprint', function() {
            const allTextareas = document.querySelectorAll('.comment-textarea');
            allTextareas.forEach(textarea => {
                if (textarea.value && textarea.value.trim()) {
                    // S'assurer que le textarea a une hauteur définie
                    if (!textarea.style.height || textarea.style.height === 'auto') {
                        autoResizeTextarea(textarea);
                    }
                }
            });
        });


        function initAudio() {
            if (!window.audioContext) {
                window.audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playBeep() {
            initAudio();
            const oscillator = window.audioContext.createOscillator();
            const gainNode = window.audioContext.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(window.audioContext.destination);
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            gainNode.gain.setValueAtTime(0.3, window.audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, window.audioContext.currentTime + 0.5);
            oscillator.start(window.audioContext.currentTime);
            oscillator.stop(window.audioContext.currentTime + 0.5);
        }

        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'fr-FR';
                utterance.rate = 0.9;
                utterance.volume = 0.8;
                speechSynthesis.speak(utterance);
            }
        }

        function playSound(message) {
            playBeep();
            setTimeout(() => speak(message), 500);
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return minutes + ":" + secs.toString().padStart(2, "0");
        }

        function toggleCheckboxes(disabled) {
            const radios = document.querySelectorAll('input[type="radio"]');
            radios.forEach(radio => {
                radio.disabled = disabled;
            });
            const detailCheckboxes = document.querySelectorAll('.detail-checkbox input[type="checkbox"]');
            detailCheckboxes.forEach(checkbox => {
                checkbox.disabled = disabled;
            });
        }

        function colorCriteriaByScore() {
            if (!window.hasFinished && !window.hasStoppedManually) return;

            const normalCriteriaRows = document.querySelectorAll('.criteria-row');
            normalCriteriaRows.forEach(row => {
                const id = row.id;
                if (!id) return;
                const criteriaName = id.replace('criteria-', '');
                const checkedRadio = document.querySelector('input[name="' + criteriaName + '"]:checked');
                row.classList.remove('criteria-zero-points', 'criteria-one-point', 'criteria-full-points', 'criteria-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
                if (checkedRadio) {
                    const score = Number(checkedRadio.value) || 0;
                    if (score === 0) {
                        row.classList.add('criteria-zero-points');
                        row.classList.add('lacune-rouge');
                    } else if (score === 1) {
                        row.classList.add('criteria-one-point');
                        row.classList.add('lacune-orange');
                    } else if (score >= 2) {
                        row.classList.add('criteria-full-points');
                        row.classList.add('lacune-verte');
                    }
                } else {
                    row.classList.add('criteria-not-answered');
                    row.classList.add('lacune-rouge');
                }
            });

            const communicationRows = document.querySelectorAll('.communication-section');
            communicationRows.forEach(row => {
                const id = row.id;
                if (!id) return;
                const criteriaName = id.replace('criteria-', '');
                const checkedRadio = document.querySelector('input[name="' + criteriaName + '"]:checked');
                row.classList.remove('communication-note-a', 'communication-note-b', 'communication-note-c', 'communication-note-d', 'communication-note-e', 'communication-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
                if (checkedRadio) {
                    const grade = checkedRadio.value.toLowerCase();
                    row.classList.add("communication-note-" + grade);
                    if (grade === 'e' || grade === 'd') {
                        row.classList.add('lacune-rouge');
                    } else if (grade === 'c') {
                        row.classList.add('lacune-orange');
                    } else if (grade === 'a' || grade === 'b') {
                        row.classList.add('lacune-verte');
                    }
                } else {
                    row.classList.add('communication-not-answered');
                    row.classList.add('lacune-rouge');
                }
            });
        }

        function startTimer() {
            if (window.isRunning || window.currentMode !== 'exam') return;
            window.isRunning = true;
            window.hasStarted = true;
            window.hasStoppedManually = false;
            document.body.classList.add('timer-running');
            toggleCheckboxes(false);
            playSound("Début de la station");
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('stopBtn').style.display = 'inline-block';
            document.getElementById('resetBtn').disabled = true;
            document.getElementById('timerStatus').textContent = 'En cours';
            document.getElementById('timerStatus').className = 'timer-status status-running';
            
            window.timerInterval = setInterval(() => {
                window.currentSeconds--;
                document.getElementById('timerDisplay').textContent = formatTime(window.currentSeconds);
                const container = document.getElementById('timerContainer');
                if (window.currentSeconds === 2 * 60) {
                    if (window.currentMode === 'exam') {
                        playSound("Il vous reste 2 minutes");
                    }
                    container.classList.add('timer-warning');
                    document.getElementById('timerStatus').textContent = '2 min restantes';
                    document.getElementById('timerStatus').className = 'timer-status status-warning';
                }
                if (window.currentSeconds <= 30) {
                    container.classList.add('timer-critical');
                }
                if (window.currentSeconds <= 0) {
                    endTimer();
                }
            }, 1000);
        }

        function stopTimer() {
            if (!window.isRunning) return;
            clearInterval(window.timerInterval);
            window.isRunning = false;
            window.hasStoppedManually = true;
            document.body.classList.remove('timer-running');
            // Ne pas désactiver les checkboxes pour permettre de continuer à cocher après arrêt
            // toggleCheckboxes(true);
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            document.getElementById('resetBtn').disabled = false;
            document.getElementById('timerStatus').textContent = 'Arrêté';
            document.getElementById('timerStatus').className = 'timer-status';
            colorCriteriaByScore();
        }

        function endTimer() {
            clearInterval(window.timerInterval);
            window.isRunning = false;
            window.hasFinished = true;
            window.currentSeconds = 0;
            document.body.classList.remove('timer-running');
            if (window.currentMode === 'exam') {
                playSound("Fin de la station. Veuillez sortir");
                // Repasser automatiquement en mode révision après la fin du timer
                switchMode('revision');
            }
            document.getElementById('timerDisplay').textContent = '0:00';
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            document.getElementById('resetBtn').disabled = false;
            document.getElementById('timerStatus').textContent = 'Terminé';
            document.getElementById('timerStatus').className = 'timer-status status-finished';
            document.getElementById('timerStatus').style.display = 'block';
            document.getElementById('timerContainer').className = 'timer-container';
            // Ne pas désactiver les checkboxes après la fin pour permettre de continuer
            // toggleCheckboxes(true);
            colorCriteriaByScore();
        }

        function resetTimer() {
            clearInterval(window.timerInterval);
            window.timerInterval = null;
            window.currentSeconds = 13 * 60;
            window.isRunning = false;
            window.hasStarted = false;
            window.hasFinished = false;
            window.hasStoppedManually = false;
            document.getElementById('timerDisplay').textContent = '13:00';
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            // Supprimer la coloration des critères
            const criteriaAndCommRows = document.querySelectorAll('.criteria-row, .communication-section');
            criteriaAndCommRows.forEach(row => {
                row.classList.remove('score-0', 'score-1', 'score-2', 'score-a', 'score-b', 'score-c', 'score-d', 'score-e');
            });
            // Supprimer la coloration des sections
            const allSections = document.querySelectorAll('.section');
            allSections.forEach(section => {
                section.classList.remove('note-a', 'note-b', 'note-c', 'note-d', 'note-e');
                section.classList.add('note-neutral');
            });
            document.getElementById('timerStatus').style.display = 'none';
            document.getElementById('timerContainer').className = 'timer-container';
            // En mode révision, ne pas désactiver les checkboxes
            if (window.currentMode === 'exam') {
                toggleCheckboxes(true);
            }
            const allRadios = document.querySelectorAll('input[type="radio"]');
            allRadios.forEach(radio => {
                radio.checked = false;
            });
            // Réinitialiser les detail-checkboxes
            const allDetailCheckboxes = document.querySelectorAll('.detail-checkbox input[type="checkbox"]');
            allDetailCheckboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            const allPointsDisplays = document.querySelectorAll('.points-display');
            allPointsDisplays.forEach(display => {
                display.textContent = '0';
            });
            const allCriteriaRows = document.querySelectorAll('.criteria-row');
            allCriteriaRows.forEach(row => {
                row.classList.remove('criteria-zero-points', 'criteria-one-point', 'criteria-full-points', 'criteria-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
            });
            const allCommunicationRows = document.querySelectorAll('.communication-section');
            allCommunicationRows.forEach(row => {
                row.classList.remove('communication-note-a', 'communication-note-b', 'communication-note-c', 'communication-note-d', 'communication-note-e', 'communication-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
            });
            calculateScores();
            // Supprimer tous les commentaires et cacher les textareas
            const allTextareas = document.querySelectorAll('.comment-textarea');
            allTextareas.forEach(textarea => {
                textarea.value = '';
                textarea.style.height = textarea.classList.contains('comment-textarea') && textarea.closest('.section-comment-section.global') ? '30px' : (textarea.closest('.section-comment-section') ? '28px' : '26px');
            });
            // Cacher toutes les sections de commentaires ouvertes
            const allCommentSections = document.querySelectorAll('.criterion-comment-section.show, .section-comment-section.show');
            allCommentSections.forEach(section => {
                section.classList.remove('show');
            });
            // Mettre à jour les boutons de commentaires
            const allCommentButtons = document.querySelectorAll('.comment-button, .section-comment-button');
            allCommentButtons.forEach(button => {
                button.classList.remove('has-content');
            });
        }
        
        function switchMode(mode) {
            window.currentMode = mode;
            const body = document.body;
            body.className = mode + '-mode';
            const buttons = document.querySelectorAll('.mode-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            buttons.forEach(btn => {
                if (btn.textContent.includes(mode === "revision" ? "Révision" : "Examen")) {
                    btn.classList.add("active");
                }
            });
            if (mode === 'revision') {
                toggleCheckboxes(false);
                showLacunesButton();
            } else {
                if (!window.hasStarted) {
                    toggleCheckboxes(true);
                }
                hideLacunesButton();
            }
        }
        
        function showLacunesButton() {
            const btn = document.querySelector('.lacune-button');
            if (btn) btn.style.display = 'block';
        }
        
        function hideLacunesButton() {
            const btn = document.querySelector('.lacune-button');
            if (btn) btn.style.display = 'none';
        }
        
        function identifyLacunes() {
            // Critères standards (anamnèse, examen, management)
            const criteria = document.querySelectorAll(".criteria-row");
            criteria.forEach(criterion => {
                const id = criterion.id.replace("criteria-", "");
                const pointsElement = document.getElementById("points-" + id);
                const points = pointsElement ? parseInt(pointsElement.textContent) : 0;
                
                criterion.classList.remove("lacune-rouge", "lacune-orange", "lacune-verte");
                
                if (points === 0) {
                    criterion.classList.add("lacune-rouge");
                } else if (points === 1) {
                    criterion.classList.add("lacune-orange");
                } else if (points >= 2) {
                    criterion.classList.add("lacune-verte");
                }
            });
            
            // Critères communication (échelle A-E)
            const commCriteria = document.querySelectorAll(".communication-section");
            commCriteria.forEach(criterion => {
                const id = criterion.id.replace("criteria-", "");
                const radio = document.querySelector("input[name=\"" + id + "\"]:checked");
                
                criterion.classList.remove("lacune-rouge", "lacune-orange", "lacune-verte");
                
                if (!radio) {
                    criterion.classList.add("lacune-rouge");
                } else {
                    const grade = radio.value;
                    if (grade === "E" || grade === "D") {
                        criterion.classList.add("lacune-rouge");
                    } else if (grade === "C") {
                        criterion.classList.add("lacune-orange");
                    } else if (grade === "A" || grade === "B") {
                        criterion.classList.add("lacune-verte");
                    }
                }
            });
        }
        function toggleComment(id) {
            const section = document.getElementById("comment-section-" + id);
            const textarea = document.getElementById("comment-" + id);
            if (section) {
                section.classList.toggle("show");
                // Focus automatiquement sur le textarea quand on ouvre la section
                if (section.classList.contains("show") && textarea) {
                    textarea.focus();
                }
            }
        }

        function updateCommentButton(id) {
            const textarea = document.getElementById("comment-" + id);
            const criterionRow = document.getElementById("criteria-" + id);
            const commentSection = document.getElementById("comment-section-" + id);
            if (textarea && criterionRow) {
                const button = criterionRow.querySelector(".comment-button");
                if (button) {
                    if (textarea.value.trim()) {
                        button.classList.add("has-content");
                        if (commentSection) commentSection.classList.add("has-content");
                    } else {
                        button.classList.remove("has-content");
                        if (commentSection) commentSection.classList.remove("has-content");
                    }
                }
            }
        }

        function toggleSectionComment(section) {
            const commentSection = document.getElementById("section-comment-" + section);
            const textarea = document.getElementById("comment-section-" + section);
            if (commentSection) {
                commentSection.classList.toggle("show");
                // Focus automatiquement sur le textarea quand on ouvre la section
                if (commentSection.classList.contains("show") && textarea) {
                    textarea.focus();
                }
            }
        }

        function updateSectionComment(section) {
            const textarea = document.getElementById("comment-section-" + section);
            const commentSection = document.getElementById("section-comment-" + section);
            const buttons = document.querySelectorAll(".section-comment-button");
            buttons.forEach(button => {
                if (button.getAttribute("onclick") && button.getAttribute("onclick").includes(section)) {
                    if (textarea && textarea.value.trim()) {
                        button.classList.add("has-content");
                        if (commentSection) commentSection.classList.add("has-content");
                    } else {
                        button.classList.remove("has-content");
                        if (commentSection) commentSection.classList.remove("has-content");
                    }
                }
            });
        }

        function updateGeneralComment() {
            const textarea = document.getElementById("comment-general");
            if (textarea) {
                const section = textarea.closest(".section-comment-section");
                if (section) {
                    if (textarea.value.trim()) {
                        section.classList.add("has-content");
                    } else {
                        section.classList.remove("has-content");
                    }
                }
            }
        }

        function autoResizeTextarea(textarea) {
            // Reset height to auto to get correct scrollHeight
            textarea.style.height = "auto";
            // Set new height based on content
            const newHeight = textarea.scrollHeight + 2;
            textarea.style.height = newHeight + "px";
        }

    </script>
    <!-- BOUTON IMPRIMER EN PDF -->
    <button class="print-button" onclick="window.print()">🖨️ Imprimer en PDF</button>
    <script>
        // Appel final pour s'assurer que tout est coloré
        // Forcer la coloration finale
        if (window.colorPatientResponses) {
            window.colorPatientResponses();
        }
    </script>
</body>
</html>
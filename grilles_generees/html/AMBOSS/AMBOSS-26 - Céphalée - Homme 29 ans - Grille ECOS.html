<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMBOSS-26 - C√©phal√©e - Homme 29 ans - Grille ECOS</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); }
        .header { background: #2c5aa0; color: white; padding: 15px; margin: -20px -20px 20px -20px; border-radius: 8px 8px 0 0; }
        .section { margin-bottom: 30px; border: 2px solid #ddd; border-radius: 8px; overflow: hidden; background-color: #ffffff; }
        .section-header { background: #f8f9fa; padding: 15px; font-weight: bold; font-size: 18px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; }
        .section-content { padding: 15px; background-color: #ffffff; }
        .header-row { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px; gap: 10px; padding: 10px 0; border-bottom: 2px solid #ddd; font-weight: bold; text-align: center; color: #333333; }
        .header-row.communication-header { grid-template-columns: 2fr 80px 80px 80px 80px 80px; }
        .header-row div:first-child { text-align: left; }
        .criteria-row { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px; gap: 10px; align-items: start; padding: 15px 0 15px 5px; border-bottom: 1px solid #eeeeee; }
        .criteria-row:last-child { border-bottom: none; }
        .criteria-text { font-weight: 500; }
        .sub-criteria { font-size: 0.9em; color: #333; margin-top: 5px; padding-left: 18px; line-height: 1.2; }
        .details-with-checkboxes { margin-top: 8px; }
        .detail-row { display: grid; grid-template-columns: 1fr 100px; align-items: center; padding: 2px 0 2px 18px; gap: 10px; line-height: 1.1; }
        .detail-text { font-size: 0.9em; color: #333; }
        .patient-response-highlight { color: rgb(44, 90, 160) !important; }
        .detail-text .patient-response-highlight { color: rgb(44, 90, 160) !important; }
        .criteria-detail .patient-response-highlight { color: rgb(44, 90, 160) !important; }
        .detail-checkboxes { text-align: center; }
        .detail-checkbox input[type="checkbox"] { cursor: pointer; transform: scale(1.1); }
        .patient-response { font-size: 0.9em; color: rgb(44, 90, 160); font-weight: 500; }
        .checkbox-group { text-align: center; }
        .points-display { text-align: center; font-weight: bold; color: #2c5aa0; font-size: 18px; }
        .scoring-rule { font-size: 0.85em; color: #888; font-style: italic; margin-top: 8px; padding-left: 20px; }
        .criteria-subheader { background: #fffbe6; padding: 10px 15px; margin: 10px 0 5px 0; border-left: 4px solid #faad14; font-weight: bold; color: #8b6914; }
        input[type="radio"] { cursor: pointer; transform: scale(1.2); }
        input[type="radio"]:disabled { opacity: 0.3; cursor: not-allowed; }
        .score { font-weight: bold; color: hsl(216, 57%, 40%); font-size: 18px; }
        .total-sections { display: grid; grid-template-columns: 1fr 2fr 1fr; gap: 20px; margin-bottom: 30px; }
        .total-section { display: flex; flex-direction: column; justify-content: space-between; text-align: center; background: #f0f8ff; border: 1px solid #ddd; border-radius: 8px; transition: all 0.3s; }
        .total-label { background: #f8f9fa; padding: 5px; font-weight: bold; font-size: 20px; border-bottom: 1px solid #ddd; }
        .total-body { flex: 1; display: flex; align-items: center; justify-content: center; padding: 5px; }
        .total-pourcent-body { flex: 1; padding: 10px; }
        .total-score, .total-note-globale { font-size: 56px; font-weight: bold; line-height: 1; }
        .total-pourcent-sections { display: flex; flex-wrap: nowrap; gap: 10px; height: 100%; align-items: stretch; }
        .total-pourcent-section { flex: 1 1 auto; min-width: 0; display: flex; flex-direction: column; text-align: center; background: #416caa; padding: 10px; border-radius: 5px; transition: all 0.3s; border: none; }
        .total-pourcent-section:last-child { border-right: none; }
        .total-section-label { color: #eeeeee; font-size: 14px; font-weight: normal; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .pourcent-body { flex: 1; display: flex; align-items: center; justify-content: center; }
        .total-pourcent-value { font-weight: bold; font-size: 28px; line-height: 1; color: white; transition: all 0.3s; }
        .note-a { background-color: #e6f4ea; color: #2c974b; }
        .note-a.total-pourcent-section { background-color: #2c974b; }
        .note-b { background-color: #e9f3fd; color: #4e9cf0; }
        .note-b.total-pourcent-section { background-color: #4e9cf0; }
        .note-c { background-color: #fdf5e6; color: #f0ad4e; }
        .note-c.total-pourcent-section { background-color: #f0ad4e; }
        .note-d { background-color: #fceee3; color: #e67e22; }
        .note-d.total-pourcent-section { background-color: #e67e22; }
        .note-e { background-color: #fbeaea; color: #d9534f; }
        .note-e.total-pourcent-section { background-color: #d9534f; }
        .note-neutral { background-color: #f0f8ff; color: #2c5aa0; }
        .note-neutral.total-pourcent-section { background-color: #6B8BC3; }
        .note-a.total-pourcent-body { background-color: #e6f4ea; }
        .note-b.total-pourcent-body { background-color: #e9f3fd; }
        .note-c.total-pourcent-body { background-color: #fdf5e6; }
        .note-d.total-pourcent-body { background-color: #fceee3; }
        .note-e.total-pourcent-body { background-color: #fbeaea; }
        .note-neutral.total-pourcent-body { background-color: #f0f8ff; }
        /* Styles pour les sections avec coloration selon le score */
        .section.note-a { border-color: #2c974b; }
        .section.note-a .section-header { background-color: #e6f4ea; color: #2c974b; }
        .section.note-b { border-color: #4e9cf0; }
        .section.note-b .section-header { background-color: #e9f3fd; color: #4e9cf0; }
        .section.note-c { border-color: #f0ad4e; }
        .section.note-c .section-header { background-color: #fdf5e6; color: #f0ad4e; }
        .section.note-d { border-color: #e67e22; }
        .section.note-d .section-header { background-color: #fceee3; color: #e67e22; }
        .section.note-e { border-color: #d9534f; }
        .section.note-e .section-header { background-color: #fbeaea; color: #d9534f; }
        .section.note-neutral { border-color: #ddd; }
        .section.note-neutral .section-header { background-color: #f8f9fa; color: #333333; }
        /* Styles pour les crit√®res individuels */
        .criteria-row.score-2 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-2 .criteria-text { color: #2c974b; }
        .criteria-row.score-max { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-max .criteria-text { color: #2c974b; }
        .criteria-row.score-1 { background-color: rgba(240, 173, 78, 0.1); }
        .criteria-row.score-1 .criteria-text { color: #f0ad4e; }
        .criteria-row.score-0 { background-color: rgba(217, 83, 79, 0.1); }
        .criteria-row.score-0 .criteria-text { color: #d9534f; }
        .criteria-row:not(.score-0):not(.score-1):not(.score-2):not(.score-max) .criteria-text { color: #000; }
        /* Styles suppl√©mentaires pour les scores plus √©lev√©s */
        .criteria-row.score-3 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-3 .criteria-text { color: #2c974b; }
        .criteria-row.score-4 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-4 .criteria-text { color: #2c974b; }
        .criteria-row.score-5 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-5 .criteria-text { color: #2c974b; }
        .communication-section.score-a { background-color: rgba(44, 151, 75, 0.1); }
        .communication-section.score-a .communication-text { color: #2c974b; }
        .communication-section.score-b { background-color: rgba(78, 156, 240, 0.1); }
        .communication-section.score-b .communication-text { color: #4e9cf0; }
        .communication-section.score-c { background-color: rgba(240, 173, 78, 0.1); }
        .communication-section.score-c .communication-text { color: #f0ad4e; }
        .communication-section.score-d { background-color: rgba(230, 126, 34, 0.1); }
        .communication-section.score-d .communication-text { color: #e67e22; }
        .communication-section.score-e { background-color: rgba(217, 83, 79, 0.1); }
        .communication-section.score-e .communication-text { color: #d9534f; }
        .grade-scale { margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; }
        .grade-scale h3 { margin-top: 0; }
        .grade-row { display: flex; justify-content: space-between; padding: 5px 0; }
        .missing-items { display: none !important; }
        .missing-items h3 { margin-top: 0; }
        .missing-item { color: #dc3545; font-weight: bold; }
        .redflags-main-section { margin-top: 30px; padding: 20px; background: #fff5f5; border-radius: 8px; border: 1px solid #f5c6cb; }
        .redflags-main-section h3 { margin-top: 0; border-bottom: 2px solid #f5c6cb; padding-bottom: 10px; }
        .redflags-category-section { margin: 15px 0; padding: 10px; background: white; border-radius: 5px; border-left: 4px solid #dc3545; }
        .annexes { margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #ddd; }
        .annexes h3 { margin-top: 0; color: #2c5aa0; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        .annexes-grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin-top: 20px; }
        .annexe-item { padding: 15px; background: white; border-radius: 5px; border: 1px solid #e0e0e0; }
        .annexe-title { font-weight: bold; color: #2c5aa0; margin-bottom: 8px; font-size: 16px; }
        .annexe-description { color: #666; font-style: italic; margin-bottom: 10px; font-size: 14px; }
        .annexe-image { text-align: center; margin: 10px 0; }
        .annexe-image img { max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .annexe-document { background: #f0f8ff; padding: 10px; border-radius: 4px; border-left: 4px solid #2c5aa0; white-space: pre-wrap; font-family: "Courier New", monospace; font-size: 13px; }
        
        /* Styles pour le sc√©nario de la patiente standardis√©e */
        .annexe-scenario { grid-column: 1 / -1; max-width: none; }
        .annexe-scenario-content { padding: 15px; background: #fafafa; border-radius: 4px; }
        .scenario-info { background: #e8f4f8; padding: 10px 15px; border-radius: 4px; margin-bottom: 15px; font-size: 15px; }
        .scenario-section { margin-bottom: 20px; }
        .scenario-subsection { margin-bottom: 15px; }
        .scenario-subsection strong { color: #2c5aa0; }
        .scenario-section h4 { color: #2c5aa0; margin: 15px 0 10px 0; font-size: 16px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        .scenario-section ul { margin: 10px 0; padding-left: 25px; }
        .scenario-section li { margin: 5px 0; line-height: 1.5; }
        .scenario-subsection { margin: 10px 0 15px 0; }
        .scenario-subsection strong { color: #555; }
        .scenario-subsection ul { margin-top: 5px; }
        
        /* Styles pour les interventions de l'expert */
        .annexe-interventions { grid-column: 1 / -1; max-width: none; }
        .annexe-interventions-content { padding: 15px; }
        .intervention-item { background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 12px; margin-bottom: 12px; }
        .intervention-header { font-size: 15px; margin-bottom: 8px; color: #856404; }
        .intervention-moment { font-weight: normal; font-style: italic; color: #666; }
        .intervention-instruction { margin: 8px 0; color: #333; }
        .intervention-message { background: #fff; padding: 8px 12px; border-left: 3px solid #ffc107; font-style: italic; color: #721c24; margin-top: 8px; }
        
        /* Styles pour les informations de l'expert */
        .annexe-informations-expert { grid-column: 1 / -1; max-width: none; }
        .annexe-informations-content { padding: 15px; background: #f5f5f5; border-radius: 4px; }
        .info-section { margin-bottom: 20px; }
        .info-section:last-child { margin-bottom: 0; }
        .info-section h4 { color: #2c5aa0; margin: 0 0 10px 0; font-size: 16px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        .info-section p { margin: 10px 0; line-height: 1.6; }
        .info-section ul { margin: 10px 0; padding-left: 25px; }
        .info-section li { margin: 5px 0; line-height: 1.5; }
        
        /* Styles pour la th√©orie pratique */
        .annexe-theorie-pratique { grid-column: 1 / -1; max-width: none; }
        .annexe-theorie-content { padding: 15px; background: #f0f5ff; border-radius: 4px; }
        .theorie-text { line-height: 1.6; color: #333; }
        .theorie-section { margin-bottom: 20px; }
        .theorie-section:last-child { margin-bottom: 0; }
        .theorie-section h4 { color: #1a4b84; margin: 0 0 10px 0; font-size: 16px; }
        .theorie-section p { margin: 10px 0; line-height: 1.6; }
        .theorie-section ul { margin: 10px 0; padding-left: 25px; }
        .theorie-section li { margin: 5px 0; line-height: 1.5; }
        /* Styles pour rappels th√©rapeutiques et examens compl√©mentaires */
        .annexe-rappels-therapeutiques, .annexe-examens-complementaires { grid-column: 1 / -1; max-width: none; }
        .rappels-list, .examens-list { margin: 0; padding-left: 25px; }
        .rappels-list li, .examens-list li { margin: 8px 0; line-height: 1.6; color: #333; }
        .annexe-rappels-therapeutiques .annexe-title { color: #998800; }
        .annexe-examens-complementaires .annexe-title { color: #346929; }
        .communication-section { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px 80px; gap: 10px; align-items: start; padding: 15px 0 15px 5px; border-bottom: 1px solid #eee; }
        .communication-text { font-weight: 500; }
        .communication-desc { font-size: 0.85em; color: #666; margin-top: 5px; font-style: italic; }
        /* Section Cl√¥ture */
        .cloture-section { margin-bottom: 20px; }
        .cloture-section .section-header { background-color: #f0f4f8; }
        .cloture-item { margin-bottom: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 5px; }
        .cloture-title { color: #2c5aa0; margin: 0 0 10px 0; font-size: 16px; font-weight: bold; }
        .cloture-content { color: #333; line-height: 1.6; font-style: italic; }
        .cloture-content-green { color: rgb(112, 188, 123); font-weight: 500; }
        .communication-desc-detail { font-size: 0.8em; color: #666; margin-left: 20px; font-style: normal; }
        .vital-signs { margin-top: 10px; margin-bottom: 0px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; font-size: 0.9em; }
        .vital-sign { text-align: center; background: #416caa; padding: 10px; border-radius: 5px; }
        .vital-sign-label { color: #eeeeee; }
        .vital-sign-value { color: rgb(255, 255, 255); margin-top: 2px; }
        .dd-section { background: #f0f8ff; padding: 15px; margin: 0 0 10px 0; border-radius: 5px; }
        .dd-title { font-weight: bold; margin-bottom: 10px; color: #2c5aa0; }
        .dd-category { margin: 10px 0; font-weight: bold; color: #2c5aa0; }
        .dd-item { margin-left: 20px; margin-top: 5px; font-weight: bold; color: rgb(169, 34, 23); }
        .dd-test { color: #666; font-style: italic; margin-left: 10px; }
        .therapy-section { background: rgba(255, 250, 230, 0.4); padding: 10px 10px 0 20px; margin: 0; border-radius: 5px; color: #000; }
        .therapy-title { font-weight: bold; margin-bottom: 5px; color: #998800; }
        .redflags-section { background: #fff5f5; padding: 10px; margin: 5px 0; border-radius: 5px; }
        .redflags-title { font-weight: bold; margin-bottom: 8px; color: #dc3545; }
        .redflags-item { margin-bottom: 6px; padding-left: 22px; }
        .redflags-text { color: #dc3545; font-weight: 500; }
        .redflags-description { color: #666; font-size: 0.9em; margin-top: 2px; margin-left: 20px; }
        .annexes { margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #ddd; }
        .annexes h3 { margin-top: 0; color: #2c5aa0; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        .annexes-grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin-top: 20px; }
        .annexe-item { padding: 15px; background: white; border-radius: 5px; border: 1px solid #e0e0e0; }
        .annexe-title { font-weight: bold; color: #2c5aa0; margin-bottom: 8px; font-size: 16px; }
        .annexe-description { color: #666; font-style: italic; margin-bottom: 10px; font-size: 14px; }
        .annexe-image { text-align: center; margin: 10px 0; }
        .annexe-image img { max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .annexe-document { background: #f0f8ff; padding: 10px; border-radius: 4px; border-left: 4px solid #2c5aa0; white-space: pre-wrap; font-family: "Courier New", monospace; font-size: 13px; }
        
        /* MINUTEUR */
        .timer-container {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.75);
            border: 3px solid #2c5aa0;
            border-radius: 15px;
            padding: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            z-index: 1000;
            text-align: center;
            min-width: 200px;
        }
        .timer-display {
            font-size: 40px;
            font-weight: bold;
            color: #2c5aa0;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
        }
        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
        }
        .timer-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
            font-size: 14px;
        }
        .start-btn {
            background: #28a745;
            color: white;
        }
        .start-btn:hover {
            background: #218838;
        }
        .stop-btn {
            background: #dc3545;
            color: white;
        }
        .stop-btn:hover {
            background: #c82333;
        }
        .reset-btn {
            background: #6c757d;
            color: white;
        }
        .reset-btn:hover {
            background: #5a6268;
        }
        .timer-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .timer-btn:disabled:hover {
            background: #6c757d;
        }
        .timer-status {
            font-size: 14px;
            font-weight: bold;
            margin-top: 10px;
            padding: 5px 10px;
            border-radius: 5px;
        }
        .status-running {
            background: #e3f2fd;
            color: #1976d2;
        }
        .status-warning {
            background: #fff3cd;
            color: #ff6f00;
        }
        .status-finished {
            background: #f8d7da;
            color: #721c24;
        }
        .timer-warning {
            animation: pulse-warning 2s infinite;
        }
        .timer-critical {
            animation: pulse-critical 1s infinite;
        }
        @keyframes pulse-warning {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes pulse-critical {
            0%, 100% { transform: scale(1); border-color: #dc3545; }
            50% { transform: scale(1.1); border-color: #ff0000; }
        }
        
        /* COLORATION POST-MINUTEUR */
        .criteria-zero-points {
            background-color: rgba(251, 234, 234, 0.6) !important;
        }
        .criteria-one-point {
            background-color: rgba(253, 245, 230, 0.6) !important;
        }
        .criteria-full-points {
            background-color: rgba(230, 244, 234, 0.6) !important;
        }
        .criteria-not-answered {
            background-color: rgba(240, 248, 255, 0.6) !important;
        }
        
        /* COLORATION COMMUNICATION */
        .communication-note-a {
            background-color: rgba(230, 244, 234, 0.6) !important;
        }
        .communication-note-b {
            background-color: rgba(233, 243, 253, 0.6) !important;
        }
        .communication-note-c {
            background-color: rgba(253, 245, 230, 0.6) !important;
        }
        .communication-note-d {
            background-color: rgba(252, 238, 227, 0.6) !important;
        }
        .communication-note-e {
            background-color: rgba(251, 234, 234, 0.6) !important;
        }
        .communication-not-answered {
            background-color: rgba(240, 248, 255, 0.6) !important;
        }
        
        /* MODE SELECTOR */
        .mode-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 2px solid #2c5aa0;
            border-radius: 30px;
            padding: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1001;
            display: flex;
            gap: 5px;
        }
        .mode-button {
            padding: 8px 16px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            background: transparent;
            color: #2c5aa0;
        }
        .mode-button.active {
            background: #2c5aa0;
            color: white;
        }
        .mode-button:hover:not(.active) {
            background: #e8f0fe;
        }
        
        /* Mode-specific hiding and showing - CORRIG√â */
        .revision-mode .timer-container {
            display: none !important;
        }
        .exam-mode .timer-container {
            display: block !important;
        }
        .exam-mode .revision-controls {
            display: none !important;
        }
        /* Masquer les descriptions et titres d'annexes en mode examen quand le timer est actif */
        .exam-mode.timer-running .annexe-item .annexe-title,
        .exam-mode.timer-running .annexe-item .annexe-description {
            display: none !important;
        }
        
        /* Revision controls */
        .revision-controls {
            position: fixed;
            top: 70px;
            right: 20px;
            background: white;
            border: 2px solid #4CAF50;
            border-radius: 30px;
            padding: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            gap: 5px;
            z-index: 1000;
        }
        .lacune-button {
            background: transparent;
            color: #4CAF50;
            border: none;
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }
        .lacune-button:hover {
            background: #4CAF50;
            color: white;
        }
        .reset-revision-button {
            background: transparent;
            color: #6c757d;
            border: none;
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }
        .reset-revision-button:hover {
            background: #6c757d;
            color: white;
        }
        
        /* Styles pour les commentaires discrets */
        .comment-button { 
            background: none; 
            border: none; 
            color: #2c5aa0; 
            cursor: pointer; 
            font-size: 14px; 
            padding: 2px 6px; 
            margin-left: 8px; 
            border-radius: 3px; 
            opacity: 0.6;
            transition: all 0.2s;
        }
        .comment-button:hover { opacity: 1; background: rgba(44, 90, 160, 0.1); }
        .comment-button.has-content { opacity: 1; color: #d9534f; }
        .criterion-comment-section { 
            display: none; 
            margin: 8px 0 12px 20px; 
            padding: 10px; 
            background: #fafafa; 
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .criterion-comment-section.show { display: block; }
        .section-comment-button {
            background: rgba(44, 90, 160, 0.1);
            border: 1px solid #2c5aa0;
            color: #2c5aa0;
            cursor: pointer;
            font-size: 12px;
            padding: 4px 8px;
            margin-left: 10px;
            border-radius: 15px;
            opacity: 0.8;
            transition: all 0.2s;
            font-weight: 500;
        }
        .section-comment-button:hover { 
            opacity: 1; 
            background: rgba(44, 90, 160, 0.2); 
            transform: scale(1.05);
        }
        .section-comment-button.has-content { 
            background: rgba(220, 53, 69, 0.1);
            border-color: #d9534f;
            color: #d9534f; 
        }
        .section-comment-section { 
            display: none;
            margin: 20px 0; 
            padding: 12px; 
            background: #f8f9fa; 
            border-radius: 6px;
        }
        .section-comment-section.show { display: block; }
        .section-comment-section.global { 
            display: block; 
            background: #f0f8ff; 
        }
        /* La section commentaire global reste toujours visible sauf √† l'impression */
        .comment-textarea { 
            width: calc(100% - 0px); 
            min-height: 26px; 
            padding: 5px; 
            margin-right: 0px;
            border: 1px solid #ddd; 
            border-radius: 3px; 
            font-family: Arial, sans-serif;
            font-size: 12px; 
            resize: vertical;
            box-sizing: border-box;
            overflow-y: hidden;
            color: #7b3f00;
            height: 26px;
        }
        .section-comment-section .comment-textarea {
            min-height: 28px;
            font-size: 14px;
            height: 28px;
        }
        .section-comment-section.global .comment-textarea {
            min-height: 30px;
            font-size: 16px;
            height: 30px;
        }
        .comment-textarea:focus {
            outline: none;
            border-color: #2c5aa0;
            box-shadow: 0 0 0 2px rgba(44, 90, 160, 0.1);
        }
        
        /* Masquer les boutons √† l'impression */
        @media print {
            .comment-button,
            .section-comment-button {
                display: none !important;
            }
            .criterion-comment-section:not(.has-content),
            .section-comment-section:not(.has-content) {
                display: none !important;
            }
            .criterion-comment-section.has-content,
            .section-comment-section.has-content {
                display: block !important;
                page-break-inside: avoid;
            }
        }
        
        /* Styles pour les lacunes */
        .lacune-rouge {
            background-color: #ffebee !important;
        }
        .lacune-orange {
            background-color: #fff3e0 !important;
        }
        .lacune-verte {
            background-color: #e8f5e8 !important;
        }
        
        /* Bouton d'impression */
        .print-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2c5aa0;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 4px 12px rgba(44, 90, 160, 0.3);
            z-index: 1000;
        }
        .print-button:hover {
            background: #1e3f70;
        }
        @media print {
            /* Masquer les √©l√©ments interactifs */
            .print-button, .mode-selector, .revision-controls, .missing-items { display: none !important; }
            .comment-button, .section-comment-button { display: none !important; }
            /* IMPORTANT: MASQUER LE MINUTEUR √† L'IMPRESSION! */
            .timer-container {
                display: none !important;
                visibility: hidden !important;
                position: absolute !important;
                left: -9999px !important;
            }
            /* Supprimer les bordures gauches √† l'impression */
            .criteria-row { border-left: none !important; }
            .communication-section { border-left: none !important; }
            .lacune-rouge { border-left: none !important; }
            .lacune-orange { border-left: none !important; }
            .lacune-verte { border-left: none !important; }
            
            /* Gestion des commentaires √† l'impression */
            .criterion-comment-section:not(.has-content),
            .section-comment-section:not(.has-content) { display: none !important; }
            .section-comment-section.global:not(.has-content) { display: none !important; }
            .criterion-comment-section.has-content,
            .section-comment-section.has-content { display: block !important; }
            
            /* Les textareas conservent leur hauteur actuelle √† l'impression */
            .comment-textarea {
                border: 1px solid #ccc !important;
                background: white !important;
                padding: 4px !important;
                margin-right: 15px !important;
                resize: none !important;
                font-size: 8pt !important;
                font-family: Arial, sans-serif !important;
                font-style: italic !important;
                color: #333 !important;
                border-radius: 2px !important;
                /* Conserver la hauteur actuelle */
                overflow: hidden !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            /* Sections commentaires */
            .criterion-comment-section {
                page-break-inside: avoid;
                margin: 6px 0 8px 15px !important;
                padding: 6px 8px !important;
                background: #f9f9f9 !important;
                border-left: 2px solid #666 !important;
                border-radius: 0 3px 3px 0 !important;
                box-shadow: none !important;
            }
            
            /* Cacher les sections de commentaires vides */
            .criterion-comment-section:not(.show) {
                display: none !important;
            }
            .criterion-comment-section.show:not(.has-content) {
                display: none !important;
            }
            
            .section-comment-section {
                page-break-inside: avoid;
                margin: 5px 0 10px 0 !important;
                padding: 6px 8px !important;
                background: #f5f5f5 !important;
                border: 1px solid #ccc !important;
                border-radius: 4px !important;
            }
            
            /* Cacher toutes les sections de commentaires vides √† l'impression */
            .section-comment-section {
                display: none !important;
            }
            /* Montrer seulement les sections avec contenu */
            .section-comment-section.has-content {
                display: block !important;
            }
            
            /* Configuration de la page */
            @page { size: A4; margin: 10mm 9mm 10mm 10mm; }
            body { margin: 0; background: white !important; font-size: 9pt; }
            
            /* Optimisation du container et des marges */
            .container { 
                max-width: 100%; 
                margin: 0; 
                box-shadow: none; 
                padding: 0; 
                background: white !important;
            }
            
            /* Gestion du header pour qu'il ne soit jamais seul */
            .header { 
                page-break-after: avoid; 
                margin: 0;
                margin-bottom: 10px;
                padding: 10px;
                font-size: 8pt;
            }
            .header h1 { font-size: 14pt; margin: 0 0 5px 0; }
            
            /* Optimisation des signes vitaux */
            .vital-signs { gap: 10px; margin: 5px 0; }
            .vital-sign { padding: 5px; font-size: 8pt; }
            
            /* Forcer l'anamn√®se √† commencer sur la page 1 */
            .section:first-of-type { page-break-before: avoid !important; }
            .section:first-of-type .section-header { 
                page-break-after: avoid; 
                min-height: 20px;
            }
            .section:first-of-type .criteria-row:first-child { 
                page-break-before: avoid !important; 
            }
            
            /* Les autres sections peuvent se diviser si n√©cessaire */
            .section { 
                page-break-inside: auto; 
                margin-bottom: 15px;
            }
            .section-header { 
                page-break-after: avoid;
                font-size: 12pt;
                padding: 8px;
            }
            .section-content { padding: 8px; }
            
            /* Optimisation de la grille */
            .header-row { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px; 
                font-size: 8pt;
            }
            .header-row.communication-header { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px 60px; 
                padding: 5px 0;
            }
            .criteria-row { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px; 
                page-break-inside: avoid;
                padding: 8px 0 8px 5px;
            }
            .criteria-text { font-size: 8.5pt; line-height: 1.1 !important; }
            .sub-criteria { font-size: 7.5pt; padding-left: 15px; line-height: 1.1 !important; }
            .detail-row { font-size: 7.5pt; padding: 1px 0 1px 15px; line-height: 1.0; }
            .detail-text { font-size: 7.5pt; line-height: 1.1 !important; }
            .patient-response { font-size: 7.5pt; }
            .points-display { font-size: 14px; }
            
            /* Communication section */
            .communication-section-container {
                page-break-inside: avoid !important;
            }
            
            /* Cloture section */
            .cloture-section {
                page-break-inside: avoid !important;
            }
            .cloture-item {
                page-break-inside: avoid !important;
                margin-bottom: 10px;
                padding: 10px;
            }
            .cloture-title { font-size: 10pt; }
            .cloture-content { font-size: 8.5pt; line-height: 1.2 !important; }
            .communication-section { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px 60px;
                padding: 8px 0;
            }
            .communication-text { font-size: 8.5pt; }
            .communication-desc { font-size: 7pt; }
            
            /* Optimisation des sections sp√©ciales */
            .dd-section { padding: 8px; margin: 0 0 5px 0; font-size: 8pt; }
            .dd-title { font-size: 9pt; }
            .dd-item { font-size: 8pt; margin-left: 15px; }
            
            .therapy-section { 
                padding: 8px; 
                margin: 0; 
                font-size: 8pt;
                background: rgba(255, 250, 230, 0.3) !important;
                color: #000 !important;
            }
            .therapy-title { font-size: 9pt; }
            
            .redflags-section { padding: 8px; margin: 5px 0; }
            .redflags-title { font-size: 9pt; }
            .redflags-text { font-size: 8.5pt; }
            .redflags-description { font-size: 7.5pt; }
            
            /* Optimisation des totaux */
            .total-sections { 
                gap: 6px;
                margin-bottom: 6px;
            }
            .total-label { 
                padding: 4px;
                font-size: 16px;
                border-radius: 8px 8px 0 0;
            }
            .total-body {
                padding: 3px;
                border-radius: 0 0 8px 8px;
            }
            .total-score,
            .total-note-globale {
                font-size: 32px;
            }
            .total-pourcent-body {
                padding: 6px;
                border-radius: 0 0 8px 8px;
            }
            .total-pourcent-sections {
                display: flex;
                flex-wrap: nowrap;
                gap: 4px;
                align-items: stretch;
            }
            .total-pourcent-section {
                flex: 0 0 auto;
                min-width: 60px;
                padding: 6px 8px;
                white-space: nowrap;
            }
            .total-section-label {
                font-size: 11px;
                margin-bottom: 3px;
                white-space: nowrap;
            }
            .total-pourcent-value {
                font-size: 20px;
            }
            .pourcent-body {
                padding: 2px 0;
            }
            
            /* √âchelle de notation */
            .grade-scale { 
                padding: 10px; 
                margin-top: 15px;
                page-break-inside: avoid;
            }
            .grade-scale h3 { font-size: 11pt; margin: 0 0 5px 0; }
            .grade-row { padding: 3px 0; font-size: 8pt; }
            
            /* Optimisations pour les annexes √† l'impression */
            .annexes { 
                page-break-before: always !important;
                margin-top: 0 !important;
                padding-top: 15px !important;
            }
            
            .annexes-grid { 
                display: grid !important; 
                grid-template-columns: repeat(2, 1fr) !important; 
                gap: 15px !important; 
                margin-top: 15px !important; 
            }
            
            .annexe-item { 
                page-break-inside: avoid !important;
                padding: 15px !important;
                border: 1px solid #ddd !important;
            }
            
            .annexe-title { 
                font-size: 10pt !important;
                margin-bottom: 5px !important;
            }
            
            .annexe-description { 
                font-size: 8pt !important;
                line-height: 1.3 !important;
                margin-bottom: 8px !important;
            }
            
            /* R√©duire l'interligne des detail-row */
            .detail-row { 
                line-height: 1.1 !important; 
                padding: 2px 0 2px 15px !important;
            }
            
            /* R√©duire et ajuster les checkboxes des d√©tails */
            .detail-checkboxes { 
                text-align: right !important;
                padding-right: 5px !important;
            }
            .detail-checkbox input[type="checkbox"] { 
                transform: scale(0.8) !important;
                margin: 0 !important;
            }
            
            /* Page-break pour th√©orie pratique */
            .annexe-theorie-pratique { 
                page-break-before: always !important; 
            }
            
            /* Pas de page-break dans les scenario-section */
            .scenario-section, 
            .scenario-subsection { 
                page-break-inside: avoid !important; 
            }
            
            /* R√©duire l'interligne dans toutes les annexes */
            .annexe-scenario-content,
            .annexe-interventions-content,
            .annexe-informations-content,
            .annexe-theorie-content { 
                line-height: 1.15 !important; 
            }
            
            /* Styles sp√©cifiques pour les sections du sc√©nario */
            .scenario-section {
                margin-bottom: 8px !important;
                padding: 4px !important;
            }
            
            .scenario-section h4 {
                font-size: 9.5pt !important;
                margin: 0 0 4px 0 !important;
                line-height: 1.1 !important;
                color: #2c5aa0 !important;
            }
            
            .scenario-subsection {
                margin-bottom: 4px !important;
                line-height: 1.1 !important;
            }
            
            .scenario-subsection strong {
                font-size: 8pt !important;
                color: #333 !important;
            }
            
            /* Listes dans les annexes */
            .annexe-scenario-content ul,
            .annexe-interventions-content ul,
            .annexe-informations-content ul,
            .annexe-theorie-content ul,
            .scenario-section ul,
            .scenario-subsection ul {
                margin: 2px 0 !important;
                padding-left: 16px !important;
            }
            
            .annexe-scenario-content li,
            .annexe-interventions-content li,
            .annexe-informations-content li,
            .annexe-theorie-content li,
            .scenario-section li,
            .scenario-subsection li {
                margin-bottom: 1px !important;
                line-height: 1.1 !important;
                font-size: 7.5pt !important;
            }
            
            /* Texte dans les sections */
            .scenario-section p,
            .scenario-subsection p {
                margin: 2px 0 !important;
                line-height: 1.1 !important;
                font-size: 7.5pt !important;
            }
            
            /* Info de base du patient */
            .scenario-info {
                font-size: 8pt !important;
                padding: 6px !important;
                margin-bottom: 8px !important;
                line-height: 1.2 !important;
            }
            
            /* Forcer les couleurs */
            * { 
                -webkit-print-color-adjust: exact !important; 
                print-color-adjust: exact !important; 
            }
            
            /* Fond blanc partout */
            body, .container, .section, .section-content { background: white !important; }
            
        }
    </style>
</head>
<body class="revision-mode">
    <!-- MODE SELECTOR -->
    <div class="mode-selector">
        <button class="mode-button active" onclick="switchMode('revision')">üîç R√©vision</button>
        <button class="mode-button" onclick="switchMode('exam')">üìù Examen</button>
    </div>
    
    <!-- BOUTONS R√âVISION (Mode R√©vision uniquement) -->
    <div class="revision-controls">
        <button class="lacune-button" onclick="identifyLacunes()">üéØ Identifier les lacunes</button>
        <button class="reset-revision-button" onclick="resetTimer()">‚Üª Reset</button>
    </div>
    
    <!-- MINUTEUR ECOS -->
    <div class="timer-container" id="timerContainer">
        <div class="timer-display" id="timerDisplay">13:00</div>
        <div class="timer-controls">
            <button id="startBtn" class="timer-btn start-btn" onclick="startTimer()">‚ñ∂ D√©marrer</button>
            <button id="stopBtn" class="timer-btn stop-btn" onclick="stopTimer()" style="display: none;">‚è∏ Arr√™ter</button>
            <button id="resetBtn" class="timer-btn reset-btn" onclick="resetTimer()">‚Üª Reset</button>
        </div>
        <div class="timer-status" id="timerStatus" style="display: none;"></div>
    </div>

    <div class="container">
        <div class="header">
            <h1>Grille d'√©valuation ECOS - AMBOSS-26 - C√©phal√©e - Homme 29 ans</h1>
            <p style="margin: 5px 0;">üìç Clinique de soins urgents</p>
            <p style="margin: 5px 0;">üë§ Adam Graham, homme de 29 ans, consultant pour c√©phal√©e</p>
            <div class="vital-signs">
                <div class="vital-sign">
                    <div class="vital-sign-label">T¬∞</div>
                    <div class="vital-sign-value">36.6¬∞C</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">TA</div>
                    <div class="vital-sign-value">120/70 mmHg</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">FC</div>
                    <div class="vital-sign-value">70 bpm</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">FR</div>
                    <div class="vital-sign-value">18/min</div>
                </div>
            </div>
        </div>
        <!-- ANAMN√àSE -->
        <div class="section">
            <div class="section-header">
                <span>Anamn√®se (25%)</span>
                <span class="score">Score : <span id="anamneseScore">0</span>/45</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Crit√®res</div>
                    <div>Oui</div>
                    <div>¬±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row" id="criteria-a1">
    <div>
        <div class="criteria-text">1. Motif principal <span class="patient-response">[J'ai mal √† la t√™te]</span> <button class="comment-button" onclick="toggleComment('a1')" title="Ajouter un commentaire">üìù</button></div>
        <div class="criterion-comment-section" id="comment-section-a1">
            <textarea class="comment-textarea" id="comment-a1" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a1'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a1" value="2" data-criteria="Motif principal" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a1" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a1">0</div>
</div>
<div class="criteria-row" id="criteria-a2">
    <div>
        <div class="criteria-text">2. Caract√©risation de la c√©phal√©e <button class="comment-button" onclick="toggleComment('a2')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Localisation <span class="patient-response">[Du c√¥t√© droit de ma t√™te, particuli√®rement mon front et la zone autour de mon ≈ìil]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-0" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Intensit√© (√©chelle 0-10) <span class="patient-response">[C'est un 7-8]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-1" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Qualit√© <span class="patient-response">[C'est une douleur pulsatile]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-2" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">D√©but <span class="patient-response">[√áa a commenc√© ce matin, donc il y a peut-√™tre 2 heures]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-3" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">√âv√©nements pr√©cipitants <span class="patient-response">[Non, je ne me souviens de rien en particulier]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-4" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Progression/constant/intermittent <span class="patient-response">[√áa s'aggrave]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-5" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">√âpisodes ant√©rieurs <span class="patient-response">[J'ai eu des maux de t√™te occasionnels dans le pass√© mais jamais aussi intenses et pas souvent, peut-√™tre une fois tous les deux mois]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-6" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Irradiation <span class="patient-response">[Eh bien, √ßa fait le plus mal devant, mais vraiment tout le c√¥t√© droit de ma t√™te bat. Je n'ai pas de douleur ailleurs cependant, si c'est ce que vous voulez dire]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-7" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Facteurs am√©liorants <span class="patient-response">[Si je m'allonge et ne bouge pas, ma t√™te va un peu mieux]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-8" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Facteurs aggravants <span class="patient-response">[Bouger. Et la lumi√®re vive dans cette pi√®ce aggrave aussi]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-9" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Sympt√¥mes associ√©s <span class="patient-response">[Je me sens un peu naus√©eux mais je n'ai pas vomi]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-10" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-a2">
            <textarea class="comment-textarea" id="comment-a2" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a2'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a2">0</div>
</div>
<div class="criteria-row" id="criteria-a3">
    <div>
        <div class="criteria-text">3. Recherche de sympt√¥mes sp√©cifiques <button class="comment-button" onclick="toggleComment('a3')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Traumatisme <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-0" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Fi√®vre/frissons <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-1" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Probl√®mes de sommeil <span class="patient-response">[J'ai √©t√© vraiment stress√© r√©cemment parce que j'essaie de trouver un nouvel emploi, donc je reste souvent debout tard pour √©crire des candidatures. J'ai du mal √† m'endormir avec tant de choses en t√™te de toute fa√ßon, donc autant faire quelque chose de productif]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-2" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">App√©tit <span class="patient-response">[Mon app√©tit est bon. Hier soir j'ai eu vraiment faim et j'ai mang√© deux bo√Ætes de raviolis]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-3" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Infections r√©centes <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-4" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Vertiges <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-5" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Troubles visuels <span class="patient-response">[Non, la lumi√®re aggrave juste mon mal de t√™te, mais je vois bien]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-6" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Difficult√©s √† parler <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-7" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Faiblesse <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-8" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Picotements/engourdissements <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-9" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Humeur <span class="patient-response">[Je pense que mon humeur est g√©n√©ralement bonne. J'ai juste √©t√© vraiment stress√©]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-10" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Larmoiement <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-11" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Congestion nasale/nez qui coule <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-12" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Agitation <span class="patient-response">[Non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-13" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Transpiration <span class="patient-response">[Oui, j'ai l'impression que mon visage est vraiment en sueur]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-14" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-a3">
            <textarea class="comment-textarea" id="comment-a3" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a3'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a3">0</div>
</div>
<div class="criteria-row" id="criteria-a4">
    <div>
        <div class="criteria-text">4. Ant√©c√©dents m√©dicaux <span class="patient-response">[Non]</span> <button class="comment-button" onclick="toggleComment('a4')" title="Ajouter un commentaire">üìù</button></div>
        <div class="criterion-comment-section" id="comment-section-a4">
            <textarea class="comment-textarea" id="comment-a4" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a4'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a4" value="2" data-criteria="Ant√©c√©dents m√©dicaux" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a4" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a4">0</div>
</div>
<div class="criteria-row" id="criteria-a5">
    <div>
        <div class="criteria-text">5. Allergies <button class="comment-button" onclick="toggleComment('a5')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Allergies <span class="patient-response">[P√©nicilline]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-0" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Type de r√©action <span class="patient-response">[J'ai eu une tr√®s mauvaise √©ruption sur tout mon corps]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-1" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-a5">
            <textarea class="comment-textarea" id="comment-a5" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a5'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a5">0</div>
</div>
<div class="criteria-row" id="criteria-a6">
    <div>
        <div class="criteria-text">6. M√©dicaments <span class="patient-response">[J'ai essay√© de prendre de l'ibuprof√®ne pour le mal de t√™te il y a environ une heure mais √ßa n'a pas aid√©. √Ä part √ßa je ne prends aucun m√©dicament]</span> <button class="comment-button" onclick="toggleComment('a6')" title="Ajouter un commentaire">üìù</button></div>
        <div class="criterion-comment-section" id="comment-section-a6">
            <textarea class="comment-textarea" id="comment-a6" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a6'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a6" value="2" data-criteria="M√©dicaments" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a6" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a6">0</div>
</div>
<div class="criteria-row" id="criteria-a7">
    <div>
        <div class="criteria-text">7. Hospitalisations et ant√©c√©dents chirurgicaux <button class="comment-button" onclick="toggleComment('a7')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Hospitalisations <span class="patient-response">[Aucune]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a7-detail-0" value="1" onchange="updateDetailScore('a7', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Ant√©c√©dents chirurgicaux <span class="patient-response">[Aucun]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a7-detail-1" value="1" onchange="updateDetailScore('a7', 'a')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-a7">
            <textarea class="comment-textarea" id="comment-a7" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a7'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a7">0</div>
</div>
<div class="criteria-row" id="criteria-a8">
    <div>
        <div class="criteria-text">8. Ant√©c√©dents familiaux <span class="patient-response">[Ma m√®re a eu un AVC l'ann√©e derni√®re juste avant ses 65 ans. Le reste de ma famille est en bonne sant√©]</span> <button class="comment-button" onclick="toggleComment('a8')" title="Ajouter un commentaire">üìù</button></div>
        <div class="criterion-comment-section" id="comment-section-a8">
            <textarea class="comment-textarea" id="comment-a8" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a8'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a8" value="2" data-criteria="Ant√©c√©dents familiaux" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a8" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a8">0</div>
</div>
<div class="criteria-row" id="criteria-a9">
    <div>
        <div class="criteria-text">9. Habitudes et mode de vie <button class="comment-button" onclick="toggleComment('a9')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Travail <span class="patient-response">[Je travaillais comme chef de projet pour une entreprise de construction, mais ils ont fait faillite il y a six mois. Je cherche un nouvel emploi depuis et j'ai un entretien d'embauche aujourd'hui]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-0" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Domicile <span class="patient-response">[Je vis avec ma femme et ma fille]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-1" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Alcool <span class="patient-response">[Je ne bois pas habituellement, mais hier soir j'ai bu du vin rouge avec ma femme pour c√©l√©brer le fait que j'ai enfin √©t√© invit√© √† un entretien pour un excellent travail]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-2" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Drogues r√©cr√©atives <span class="patient-response">[Jamais]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-3" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Tabac <span class="patient-response">[Je fume environ 2 paquets par jour depuis mes 15 ans]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-4" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Exercice <span class="patient-response">[Je ne fais pas beaucoup d'exercice ; je passe la plupart de mon temps √† la maison √† mon bureau]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-5" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Alimentation <span class="patient-response">[Je pense que j'ai g√©n√©ralement une alimentation √©quilibr√©e. Derni√®rement l'argent est un peu serr√©, donc nous avons d√ª cuisiner plus nous-m√™mes, ce qui est probablement plus sain que de manger au restaurant tout le temps de toute fa√ßon]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-6" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-a9">
            <textarea class="comment-textarea" id="comment-a9" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a9'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a9">0</div>
</div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('anamnese')" title="Commentaire sur cette section">üìù Commentaire sur la section Anamn√®se</button>
                </div>
                <div class="section-comment-section" id="section-comment-anamnese">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur l'anamn√®se</h4>
                    <textarea class="comment-textarea" id="comment-section-anamnese" placeholder="Commentaire sur la section anamn√®se..." oninput="updateSectionComment('anamnese'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- EXAMEN CLINIQUE -->
        <div class="section">
            <div class="section-header">
                <span>Examen clinique (25%)</span>
                <span class="score">Score : <span id="statusScore">0</span>/20</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Crit√®res</div>
                    <div>Oui</div>
                    <div>¬±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row" id="criteria-e1">
    <div>
        <div class="criteria-text">1. Mesures d'hygi√®ne <button class="comment-button" onclick="toggleComment('e1')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Lavage des mains</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e1-detail-0" value="1" onchange="updateDetailScore('e1', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Respect de la pudeur avec drap</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e1-detail-1" value="1" onchange="updateDetailScore('e1', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e1">
            <textarea class="comment-textarea" id="comment-e1" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('e1'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e1">0</div>
</div>
<div class="criteria-row" id="criteria-e2">
    <div>
        <div class="criteria-text">2. Examen de la t√™te, yeux, oreilles, nez et gorge <button class="comment-button" onclick="toggleComment('e2')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Inspection de la t√™te</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-0" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Palpation de la t√™te</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-1" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Inspection des conjonctives</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-2" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">√âvaluation de l'acuit√© visuelle (√©chelle de Snellen)</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-3" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Fond d'≈ìil direct</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-4" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e2">
            <textarea class="comment-textarea" id="comment-e2" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('e2'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e2">0</div>
</div>
<div class="criteria-row" id="criteria-e3">
    <div>
        <div class="criteria-text">3. Examen du cou <button class="comment-button" onclick="toggleComment('e3')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Inspection du cou</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e3-detail-0" value="1" onchange="updateDetailScore('e3', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Palpation du cou</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e3-detail-1" value="1" onchange="updateDetailScore('e3', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e3">
            <textarea class="comment-textarea" id="comment-e3" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('e3'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e3">0</div>
</div>
<div class="criteria-row" id="criteria-e4">
    <div>
        <div class="criteria-text">4. Examen neurologique <button class="comment-button" onclick="toggleComment('e4')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">√âvaluation de l'orientation dans le temps, l'espace et les personnes</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-0" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Examen cibl√© des nerfs cr√¢niens</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-1" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Recherche de m√©ningisme</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-2" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Examen cibl√© des mouvements passifs et actifs</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-3" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Examen cibl√© de la sensibilit√©</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-4" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Examen cibl√© des r√©flexes ost√©o-tendineux</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-5" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Examen cibl√© de la marche</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-6" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Test des mouvements altern√©s rapides</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-7" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Test doigt-nez</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-8" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Signe de Babinski</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-9" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Test de Romberg</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-10" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e4">
            <textarea class="comment-textarea" id="comment-e4" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('e4'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e4">0</div>
</div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('examen')" title="Commentaire sur cette section">üìù Commentaire sur la section Examen</button>
                </div>
                <div class="section-comment-section" id="section-comment-examen">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur l'examen clinique</h4>
                    <textarea class="comment-textarea" id="comment-section-examen" placeholder="Commentaire sur la section examen clinique..." oninput="updateSectionComment('examen'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- MANAGEMENT -->
        <div class="section">
            <div class="section-header">
                <span>Management (25%)</span>
                <span class="score">Score : <span id="managementScore">0</span>/24</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Crit√®res</div>
                    <div>Oui</div>
                    <div>¬±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row" id="criteria-m1">
    <div>
        <div class="criteria-text">1. Hypoth√®ses diagnostiques <button class="comment-button" onclick="toggleComment('m1')" title="Ajouter un commentaire">üìù</button></div>
<div class="scoring-rule">2 points si au moins 2 diagnostics pertinents mentionn√©s, 1 point si 1 diagnostic</div>        <div class="criterion-comment-section" id="comment-section-m1">
            <textarea class="comment-textarea" id="comment-m1" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('m1'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="2" data-criteria="Hypoth√®ses diagnostiques" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="1" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="0" onchange="updateScore('m', this)" />
    </div>
    <div class="points-display" id="points-m1">0</div>
</div>
<div class="dd-section">
    <div class="dd-title">Diagnostics diff√©rentiels √† consid√©rer</div>
    <div class="dd-category">C√©phal√©es primaires</div>
    <div class="dd-item">‚Ä¢ Crise migraineuse <span class="dd-test">‚Üí Diagnostic clinique, pas d'examens si typique</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Prodrome : app√©tit inhabituel avant c√©phal√©e (2 bo√Ætes raviolis)<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° C√©phal√©e unilat√©rale droite s√©v√®re<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Douleur pulsatile/battante<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Intensit√© 7-8/10 (s√©v√®re)<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Naus√©es associ√©es<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Photophobie marqu√©e<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Aggravation par mouvement<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Am√©lioration repos/immobilit√©<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Facteurs d√©clenchants multiples :<br>	  ‚Ä¢ Vin rouge (vasodilatateur)<br>	  ‚Ä¢ Manque sommeil chronique<br>	  ‚Ä¢ Stress √©motionnel (ch√¥mage)<br>	  ‚Ä¢ Tabagisme<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° √Çge et sexe compatibles</div>
    <div class="dd-item">‚Ä¢ C√©phal√©e de tension <span class="dd-test">‚Üí Diagnostic clinique</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Stress majeur (ch√¥mage 6 mois)<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Manque sommeil<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Anxi√©t√© (recherche emploi)<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Type c√©phal√©e le plus fr√©quent<br>Contre : Unilat√©rale (habituellement bilat√©rale), pulsatile (habituellement pression), sympt√¥mes autonomes pr√©sents, photophobie marqu√©e</div>
    <div class="dd-item">‚Ä¢ Algie vasculaire de la face <span class="dd-test">‚Üí Diagnostic clinique si crit√®res stricts</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Homme jeune (pic 20-40 ans)<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Unilat√©rale stricte p√©riorbitaire<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Transpiration faciale<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Tabagisme (facteur risque)<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Alcool d√©clencheur (vin)<br>Contre : Dur√©e > 2h (AVF 15min-3h), pas larmoiement/rhinorrh√©e, pas agitation, pas nocturne typique</div>
    <div class="dd-category">C√©phal√©es secondaires √† exclure</div>
    <div class="dd-item">‚Ä¢ H√©morragie sous-arachno√Ødienne <span class="dd-test">‚Üí CT c√©r√©bral si suspicion</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;">Contre : d√©but progressif (pas thunderclap), pas m√©ningisme</div>
    <div class="dd-item">‚Ä¢ M√©ningite <span class="dd-test">‚Üí Ponction lombaire si doute</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;">Contre : apyrexie, pas m√©ningisme, pas syndrome infectieux</div>
    <div class="dd-item">‚Ä¢ Masse intracr√¢nienne <span class="dd-test">‚Üí IRM c√©r√©brale si atypique</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;">Contre : d√©but aigu, pas d√©ficit focal, pas HTIC</div>
</div>
<div class="criteria-row" id="criteria-m2">
    <div>
        <div class="criteria-text">2. Drapeaux rouges √† rechercher <button class="comment-button" onclick="toggleComment('m2')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">C√©phal√©e s√©v√®re implacable</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-0" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Fi√®vre</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-1" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">D√©ficits neurologiques focaux</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-2" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Convulsions</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-3" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Troubles de conscience</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-4" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Signes d'hypertension intracr√¢nienne (ex: perte de connaissance, ≈ìd√®me papillaire)</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-5" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Signes de m√©ningisme</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-6" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Sympt√¥mes psychiatriques</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-7" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Douleur oculaire</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-8" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div></div>        <div class="redflags-section">
            <div class="redflags-title">‚ö†Ô∏è Signaux d'alarme n√©cessitant imagerie</div>
            <div class="redflags-item">
                <div class="redflags-text">1. C√©phal√©e en coup de tonnerre</div>
                <div class="redflags-description">D√©but brutal maximal < 1 minute ‚Üí HSA</div>
            </div>
            <div class="redflags-item">
                <div class="redflags-text">2. C√©phal√©e nouvelle > 50 ans</div>
                <div class="redflags-description">Risque accru pathologie secondaire</div>
            </div>
            <div class="redflags-item">
                <div class="redflags-text">3. Changement de pattern</div>
                <div class="redflags-description">Modification c√©phal√©e habituelle</div>
            </div>
            <div class="redflags-item">
                <div class="redflags-text">4. C√©phal√©e positionnelle</div>
                <div class="redflags-description">Hypotension/hypertension intracr√¢nienne</div>
            </div>
            <div class="redflags-item">
                <div class="redflags-text">5. Immunod√©pression</div>
                <div class="redflags-description">Risque infectieux/n√©oplasique accru</div>
            </div>
            <div class="redflags-item">
                <div class="redflags-text">6. D√©ficit neurologique</div>
                <div class="redflags-description">L√©sion structurelle possible</div>
            </div>
        </div>
        <div class="criterion-comment-section" id="comment-section-m2">
            <textarea class="comment-textarea" id="comment-m2" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('m2'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m2">0</div>
</div>
<div class="criteria-row" id="criteria-m3">
    <div>
        <div class="criteria-text">3. Prise en charge <button class="comment-button" onclick="toggleComment('m3')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Migraine, c√©phal√©e de tension et algie vasculaire = diagnostics cliniques bas√©s sur l'histoire et l'examen physique</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m3-detail-0" value="1" onchange="updateDetailScore('m3', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Ne pas faire d'examens diagnostiques sauf si drapeaux rouges pr√©sents</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m3-detail-1" value="1" onchange="updateDetailScore('m3', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Proposer au patient de s'allonger et tamiser la lumi√®re</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m3-detail-2" value="1" onchange="updateDetailScore('m3', 'm')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-m3">
            <textarea class="comment-textarea" id="comment-m3" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('m3'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m3">0</div>
</div>
<div class="criteria-row" id="criteria-m4">
    <div>
        <div class="criteria-text">4. Communication avec le patient <button class="comment-button" onclick="toggleComment('m4')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Explications au patient des impressions diagnostiques pr√©liminaires</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m4-detail-0" value="1" onchange="updateDetailScore('m4', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Explication du plan de prise en charge</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m4-detail-1" value="1" onchange="updateDetailScore('m4', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Utilisation d'un langage non m√©dical et clarification des termes m√©dicaux</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m4-detail-2" value="1" onchange="updateDetailScore('m4', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">√âvaluation de l'accord du patient avec le plan diagnostique</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m4-detail-3" value="1" onchange="updateDetailScore('m4', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Recherche des pr√©occupations et questions du patient</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m4-detail-4" value="1" onchange="updateDetailScore('m4', 'm')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-m4">
            <textarea class="comment-textarea" id="comment-m4" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('m4'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m4">0</div>
</div>
<div class="criteria-row" id="criteria-m5">
    <div>
        <div class="criteria-text">5. Conseil et soutien <button class="comment-button" onclick="toggleComment('m5')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Conseil sur l'arr√™t du tabac</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-0" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Donner l'option de s'allonger et proposer de tamiser la lumi√®re</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-1" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">R√©action appropri√©e au d√©fi concernant l'entretien d'embauche</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-2" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">√âducation sur les facteurs d√©clenchants</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-3" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Conseils hygi√®ne de vie</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-4" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div></div>        <div class="therapy-section">
            <div class="therapy-title">Traitement de la crise migraineuse</div>
            <div><span style="margin-left: 10px;">‚Ä¢</span> Traitement de crise l√©g√®re-mod√©r√©e :<br />
              - AINS : ibuprof√®ne 600-800 mg ou naprox√®ne 500-1000 mg<br />
              - Parac√©tamol 1000 mg (moins efficace)<br />
              - Anti√©m√©tique si naus√©es : m√©toclopramide 10 mg<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Traitement de crise s√©v√®re :<br />
              - Triptans : sumatriptan 50-100 mg PO ou 6 mg SC<br />
              - Alternatives : zolmitriptan, rizatriptan<br />
              - Association possible triptan + AINS<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Mesures non pharmacologiques :<br />
              - Repos dans pi√®ce sombre et calme<br />
              - Application glace sur front/tempes<br />
              - Hydratation ad√©quate<br />
              - Techniques relaxation<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Prophylaxie si ‚â• 4 crises/mois :<br />
              - B√™tabloquants : propranolol 80-240 mg/j<br />
              - Anti√©pileptiques : topiramate 50-100 mg/j<br />
              - Antid√©presseurs : amitriptyline 25-75 mg/j<br />
              - Antagonistes CGRP : √©renumab mensuel</div>
        </div>
        <div class="criterion-comment-section" id="comment-section-m5">
            <textarea class="comment-textarea" id="comment-m5" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('m5'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m5">0</div>
</div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('management')" title="Commentaire sur cette section">üìù Commentaire sur la section Management</button>
                </div>
                <div class="section-comment-section" id="section-comment-management">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur le management</h4>
                    <textarea class="comment-textarea" id="comment-section-management" placeholder="Commentaire sur la section management..." oninput="updateSectionComment('management'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- CL√îTURE -->
        <div class="section cloture-section">
            <div class="section-header">
                <span>Cl√¥ture de consultation</span>
            </div>
            <div class="section-content">
                <div class="cloture-item">
                    <h4 class="cloture-title">D√©fi : Impatience pour m√©dicament</h4>
                    <div class="cloture-content cloture-content-green">Interrompre l'examinateur pendant l'anamn√®se et dire [J'ai un entretien d'embauche cet apr√®s-midi. Pouvez-vous juste me donner un m√©dicament pour que ce mal de t√™te disparaisse et que je puisse aller √† l'entretien ?]</div>
                </div>
                <div class="cloture-item">
                    <h4 class="cloture-title">R√©ponse type du candidat</h4>
                    <div class="cloture-content cloture-content-green">M. Graham, je comprends que l'entretien d'embauche est important pour vous. Je peux vous assurer que nous ferons de notre mieux pour vous faire sortir d'ici le plus rapidement possible. Mais avant de vous donner un m√©dicament, j'aimerais vous poser quelques questions suppl√©mentaires et effectuer un examen physique. Il est important que j'aie une meilleure id√©e de ce qui cause votre mal de t√™te pour que je puisse vous traiter de mani√®re appropri√©e. Est-ce que √ßa vous convient ?</div>
                </div>
            </div>
        </div>
        <!-- COMMUNICATION -->
        <div class="section communication-section-container">
            <div class="section-header">
                <span>Communication (25%)</span>
                <span class="score">Score : <span id="communicationScore">0</span>/20</span>
            </div>
            <div class="section-content">
                <div class="header-row communication-header">
                    <div>Crit√®res</div>
                    <div>A</div>
                    <div>B</div>
                    <div>C</div>
                    <div>D</div>
                    <div>E</div>
                </div>
                <div class="communication-section" id="criteria-c1">
                    <div>
                        <div class="communication-text">1. R√©ponse aux sentiments et besoins du patient <button class="comment-button" onclick="toggleComment('c1')" title="Ajouter un commentaire">üìù</button></div>
                        <div class="communication-desc">Empathie, √©coute active, validation des √©motions<br />
Explique le d√©roulement de la consultation et v√©rifie les pr√©occupations du patient, commence l'anamn√®se par une question ouverte ; reconna√Æt, verbalise et l√©gitime les √©motions, fournit du soutient</div>
                        <div class="criterion-comment-section" id="comment-section-c1">
                            <textarea class="comment-textarea" id="comment-c1" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('c1'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="A" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="B" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="C" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="D" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="E" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c2">
                    <div>
                        <div class="communication-text">2. Structure de l'entretien <button class="comment-button" onclick="toggleComment('c2')" title="Ajouter un commentaire">üìù</button></div>
                        <div class="communication-desc">Organisation logique, transitions fluides, gestion du temps<br />
Se pr√©sente par son nom et sa fonction, les √©tapes de l'entretien sont identifiables et s'encha√Ænent de mani√®re logique, gestion du temps, adaptation √† la situation</div>
                        <div class="criterion-comment-section" id="comment-section-c2">
                            <textarea class="comment-textarea" id="comment-c2" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('c2'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="A" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="B" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="C" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="D" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="E" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c3">
                    <div>
                        <div class="communication-text">3. Expression verbale <button class="comment-button" onclick="toggleComment('c3')" title="Ajouter un commentaire">üìù</button></div>
                        <div class="communication-desc">Clart√©, vocabulaire adapt√©, v√©rification de la compr√©hension<br />
Langage adapt√© au niveau du patient, pas de jargon, explications compr√©hensibles, reformulations quand n√©cessaire, r√©p√©titions des points cl√©s, fait une synth√®se de la consultation, bonne articulation, ton et volume ad√©quats</div>
                        <div class="criterion-comment-section" id="comment-section-c3">
                            <textarea class="comment-textarea" id="comment-c3" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('c3'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="A" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="B" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="C" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="D" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="E" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c4">
                    <div>
                        <div class="communication-text">4. Expression non verbale <button class="comment-button" onclick="toggleComment('c4')" title="Ajouter un commentaire">üìù</button></div>
                        <div class="communication-desc">Contact visuel, posture, gestuelle appropri√©e<br />
Distance interpersonnelle ad√©quate, posture ad√©quate, gestes ad√©quats, contact visuel et expression faciale ad√©quats, pauses quand n√©cessaire</div>
                        <div class="criterion-comment-section" id="comment-section-c4">
                            <textarea class="comment-textarea" id="comment-c4" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('c4'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="A" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="B" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="C" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="D" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="E" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c5">
                    <div>
                        <div class="communication-text">5. √âvaluation g√©n√©rale de la communication <button class="comment-button" onclick="toggleComment('c5')" title="Ajouter un commentaire">üìù</button></div>
                        <div class="communication-desc">Qualit√© globale de l'interaction m√©decin-patient</div>
                        <div class="criterion-comment-section" id="comment-section-c5">
                            <textarea class="comment-textarea" id="comment-c5" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('c5'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="A" data-criteria="√âvaluation g√©n√©rale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="B" data-criteria="√âvaluation g√©n√©rale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="C" data-criteria="√âvaluation g√©n√©rale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="D" data-criteria="√âvaluation g√©n√©rale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="E" data-criteria="√âvaluation g√©n√©rale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('communication')" title="Commentaire sur cette section">üìù Commentaire sur la section Communication</button>
                </div>
                <div class="section-comment-section" id="section-comment-communication">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur la communication</h4>
                    <textarea class="comment-textarea" id="comment-section-communication" placeholder="Commentaire sur la section communication..." oninput="updateSectionComment('communication'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- TOTAUX -->
        <div class="total-sections">
            <div class="total-section">
                <div class="total-label">Score Global</div>
                <div class="total-body">
                    <div class="total-score" id="totalScore">0/109</div>
                </div>
            </div>
            <div class="total-section">
                <div class="total-label">% par Section</div>
                <div class="total-pourcent-body">
                    <div class="total-pourcent-sections">
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Anamn√®se</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="anamnese-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Examen clinique</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="examen-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Management</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="management-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Communication</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="communication-percentage">0</span>%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="total-section">
                <div class="total-label">Note Globale</div>
                <div class="total-body">
                    <div class="total-note-globale" id="globalGrade">E</div>
                </div>
            </div>
        </div>
        <!-- √âCHELLE DE NOTATION -->
        <div class="grade-scale" style="padding: 10px 15px; background: #f8f9fa; border-radius: 8px;">
            <h3 style="margin: 0 0 10px 0; font-size: 16px;">√âchelle de notation</h3>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; text-align: center;">
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #2c974b;">A</div>
                    <div style="font-size: 12px; color: #666;">‚â•90%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #4e9cf0;">B</div>
                    <div style="font-size: 12px; color: #666;">80-89%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #f0ad4e;">C</div>
                    <div style="font-size: 12px; color: #666;">70-79%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #e67e22;">D</div>
                    <div style="font-size: 12px; color: #666;">60-69%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #d9534f;">E</div>
                    <div style="font-size: 12px; color: #666;">&lt;60%</div>
                </div>
            </div>
        </div>
        <!-- √âL√âMENTS MANQUANTS (MASQU√âS) -->
        <!-- <div class="missing-items" id="missingItems" style="display: none;">
            <h3>√âl√©ments non √©valu√©s</h3>
            <div id="missingList"></div>
        </div> -->
<div class="annexes">
<h3>Annexes</h3>
<div class="annexes-grid">
<div class="annexe-item">
    <div class="annexe-title">Localisation et sympt√¥mes additionnels des c√©phal√©es primaires</div>
    <div class="annexe-description">Ces trois types de c√©phal√©es primaires peuvent √™tre diff√©renci√©s selon la localisation de la douleur, l'intensit√© et les sympt√¥mes additionnels. - C√©phal√©e de tension : holocr√¢nienne ou bifrontale, c√©phal√©e sourde ; pas de sympt√¥mes autonomes. - Migraine : c√©phal√©e unilat√©rale avec sympt√¥mes autonomes (vomissements, naus√©es, phonophobie, photophobie). - Algie vasculaire : c√©phal√©e unilat√©rale, p√©riorbitaire avec injection conjonctivale, larmoiement, rhinorrh√©e et gonflement des muqueuses nasales, syndrome de Horner, transpiration du front ou du visage.</div>
    <div class="annexe-image">
        <img src="/Users/damienfulliquet/Documents/-Medecine/-EXAMEN_FEDERAL/-ECOS_2025/-SSP/Cas cliniques traduits/Traduits/HTML/grilles_generees/html/images/AMBOSS-26-img1-Localization and additional symptoms of primary headaches.jpg" alt="Localisation et sympt√¥mes additionnels des c√©phal√©es primaires" />
    </div>
</div>
<div class="annexe-item">
    <div class="annexe-title">Localisation de la douleur dans les c√©phal√©es secondaires</div>
    <div class="annexe-description">Certaines caract√©ristiques de la douleur et sympt√¥mes associ√©s peuvent aider au diagnostic d'une c√©phal√©e secondaire : - Art√©rite temporale : c√©phal√©e unilat√©rale, claudication de la m√¢choire, sensibilit√© du cuir chevelu ou de l'art√®re temporale, sympt√¥mes constitutionnels, changements visuels. - Crise hypertensive : c√©phal√©e diffuse, souvent bifrontale (La c√©phal√©e dans le contexte d'une crise hypertensive peut √™tre un sympt√¥me isol√© mais peut aussi √™tre une manifestation d'enc√©phalopathie hypertensive, qui constitue une urgence hypertensive). - Sinusite : Douleur ou pression faciale dans la r√©gion de la cavit√© sinusale, rhinorrh√©e purulente, sympt√¥mes grippaux. - C√©phal√©e par abus m√©dicamenteux : c√©phal√©e diffuse qui peut changer de type et de localisation au cours d'un √©pisode et s'est d√©velopp√©e ou aggrav√©e avec l'abus d'analg√©siques.</div>
    <div class="annexe-image">
        <img src="/Users/damienfulliquet/Documents/-Medecine/-EXAMEN_FEDERAL/-ECOS_2025/-SSP/Cas cliniques traduits/Traduits/HTML/grilles_generees/html/images/AMBOSS-26-img2-Pain localization in secondary headache.jpg" alt="Localisation de la douleur dans les c√©phal√©es secondaires" />
    </div>
</div>
<div class="annexe-item annexe-scenario">
    <div class="annexe-title">Sc√©nario pour le patient standardis√©</div>
    <div class="annexe-scenario-content">
        <div class="scenario-info">
            <strong>Nom :</strong> Adam Graham |             <strong>√Çge :</strong> 29 ans<br>
            <strong>Contexte :</strong> Chef de projet au ch√¥mage avec c√©phal√©e migraineuse typique avant entretien d'embauche
        </div>
        <div class="scenario-section">
            <h4>Motif de consultation</h4>
            <p><strong>Plainte principale :</strong> ¬´J'ai mal √† la t√™te.¬ª</p>
            <p><strong>Si on demande s'il y a autre chose :</strong> ¬´C'est vraiment intense.¬ª</p>
        </div>
        <div class="scenario-section">
            <h4>Consignes</h4>
            <ul>
                <li>Mentionner que la lumi√®re aggrave votre mal de t√™te. Si l'examinateur ne propose pas de tamiser la lumi√®re apr√®s que vous l'ayez mentionn√©, commencer √† donner des r√©ponses tr√®s courtes et ne pas donner d'information que l'examinateur ne demande pas sp√©cifiquement.</li>
                <li>Vous n'√™tes pas au courant de la signification des termes m√©dicaux (ex: CT) et demandez des clarifications si l'examinateur les utilise.</li>
                <li>D√©fi : Interrompre l'examinateur pendant l'anamn√®se et dire 'J'ai un entretien d'embauche cet apr√®s-midi. Pouvez-vous juste me donner un m√©dicament pour que ce mal de t√™te disparaisse et que je puisse aller √† l'entretien ?'</li>
            </ul>
        </div>
        <div class="scenario-section">
            <h4>Histoire actuelle</h4>
            <div class="scenario-subsection">
                <strong>Sympt√¥me principal :</strong>
                <ul>
                    <li>C√©phal√©e unilat√©rale droite</li>
                    <li>D√©but ce matin (2 heures)</li>
                    <li>Douleur pulsatile intense 7-8/10</li>
                    <li>Localisation front et p√©riorbitaire</li>
                    <li>Aggravation progressive</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Sympt√¥mes associ√©s :</strong>
                <ul>
                    <li>Naus√©es sans vomissements</li>
                    <li>Photophobie marqu√©e</li>
                    <li>Aggravation au mouvement</li>
                    <li>Transpiration faciale</li>
                    <li>Am√©lioration au repos allong√©</li>
                    <li>Prodrome : app√©tit inhabituel hier soir</li>
                </ul>
            </div>
        </div>
        <div class="scenario-section">
            <h4>Simulation</h4>
            <div class="scenario-subsection">
                <strong>Durant l'entretien :</strong>
                <ul>
                    <li>Para√Ætre souffrant mais coop√©ratif</li>
                    <li>Prot√©ger yeux de la lumi√®re</li>
                    <li>Mentionner stress entretien d'embauche</li>
                    <li>Impatience pour traitement (d√©fi)</li>
                    <li>R√©actions n√©gatives si lumi√®re non tamis√©e</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Durant le status :</strong>
                <ul>
                    <li>Examen neurologique normal</li>
                    <li>Pas de m√©ningisme</li>
                    <li>Pas de d√©ficit focal</li>
                    <li>R√©action douloureuse √† la lumi√®re</li>
                    <li>Pr√©f√©rence pour position allong√©e</li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="annexe-item annexe-informations-expert">
    <div class="annexe-title">Informations de l'expert</div>
    <div class="annexe-informations-content">
        <div class="info-section">
            <h4>Dossier m√©dical de l'entretien</h4>
            <p>Homme 29 ans avec crise migraineuse typique : c√©phal√©e unilat√©rale pulsatile s√©v√®re + naus√©es + photophobie + prodrome. Multiples facteurs d√©clenchants : vin rouge, stress, manque sommeil, tabac. Pas de drapeaux rouges. Diagnostic clinique, pas d'imagerie n√©cessaire. √âchec ibuprof√®ne sugg√®re besoin triptan. Importance gestion stress et prophylaxie si r√©current.</p>
        </div>
        <div class="info-section">
            <h4>R√¥les et interventions de l'expert¬∑e</h4>
            <div class="roles-interventions">
                <p style="margin: 5px 0; padding-left: 0;">L'expert-e intervient si l'√©tudiant-e fait :</p>
                <p style="margin: 5px 0; padding-left: 0;">‚Ä¢ Examen neurologique : Normal complet</p>
                <p style="margin: 5px 0; padding-left: 0;">‚Ä¢ Fond d'≈ìil : Normal, pas ≈ìd√®me papillaire</p>
                <p style="margin: 5px 0; padding-left: 0;">‚Ä¢ Signes m√©ning√©s : N√©gatifs</p>
                <p style="margin: 5px 0; padding-left: 0;">‚Ä¢ TA/FC : Normaux (pas urgence hypertensive)</p>
                <p style="margin: 5px 0; padding-left: 0;">‚Ä¢ Si traitement : Sumatriptan 100 mg PO efficace</p>
                <p style="margin: 5px 0; padding-left: 0;">‚Ä¢ Si prophylaxie discut√©e : Propranolol indiqu√©</p>
            </div>
        </div>
        <div class="info-section">
            <h4>Points cl√©s</h4>
            <ul>
                <li>Migraine = diagnostic clinique si crit√®res IHS</li>
                <li>POUND : Pulsatile, One day, Unilateral, Nausea, Disabling</li>
                <li>Photophobie = adapter environnement (tamiser lumi√®re)</li>
                <li>Pas d'imagerie sauf drapeaux rouges</li>
                <li>Triptans si √©chec AINS dans migraine s√©v√®re</li>
                <li>Identifier et √©viter facteurs d√©clenchants</li>
            </ul>
        </div>
        <div class="info-section">
            <h4>Pi√®ges</h4>
            <ul>
                <li>Prescrire imagerie pour migraine typique</li>
                <li>Ne pas proposer tamiser lumi√®re</li>
                <li>Oublier conseil arr√™t tabac</li>
                <li>Minimiser impact stress/sommeil</li>
                <li>Ne pas √©valuer fr√©quence pour prophylaxie</li>
                <li>Confondre avec c√©phal√©e tension (bilat√©rale)</li>
            </ul>
        </div>
    </div>
</div>
<div class="annexe-item annexe-theorie-pratique">
    <div class="annexe-title">Th√©orie pratique concernant la vignette</div>
    <div class="annexe-theorie-content">
        <div class="theorie-section">
            <h4>Diagnostic le plus probable</h4>
            <p>Crise migraineuse sans aura</p>
        </div>
        <div class="theorie-section">
            <h4>Migraine</h4>
            <p>C√©phal√©e primaire neurovaculaire r√©currente :</p>
            <ul>
                <li>Pr√©valence : 15% femmes, 6% hommes</li>
                <li>Physiopathologie : activation syst√®me trig√©mino-vasculaire</li>
                <li>D√©pression corticale propag√©e ‚Üí aura (30% cas)</li>
                <li>Lib√©ration CGRP, substance P ‚Üí inflammation neurog√®ne</li>
                <li>G√©n√©tique : 60-70% h√©ritabilit√©, polyg√©nique</li>
                <li>Pic incidence : 20-40 ans, d√©but souvent adolescence</li>
            </ul>
        </div>
        <div class="theorie-section">
            <h4>Crit√®res diagnostiques IHS migraine sans aura</h4>
            <p>Au moins 5 crises r√©pondant aux crit√®res :</p>
            <ul>
                <li>A. Dur√©e 4-72 heures non trait√©e</li>
                <li>B. Au moins 2 parmi : unilat√©rale, pulsatile, mod√©r√©e-s√©v√®re, aggrav√©e par activit√©</li>
                <li>C. Au moins 1 parmi : naus√©es/vomissements, photo ET phonophobie</li>
                <li>D. Non attribuable √† autre trouble</li>
                <li>Migraine avec aura : ‚â• 2 crises avec aura typique</li>
                <li>Aura : sympt√¥mes neurologiques r√©versibles 5-60 min</li>
            </ul>
        </div>
        <div class="theorie-section">
            <h4>Facteurs d√©clenchants migraineux</h4>
            <p>Triggers identifiables chez 75% patients :</p>
            <ul>
                <li>Alimentaires : alcool (vin rouge), chocolat, fromages vieillis, MSG</li>
                <li>Hormonaux : menstruations, contraceptifs oraux</li>
                <li>Environnementaux : lumi√®res vives, odeurs fortes, changements m√©t√©o</li>
                <li>Comportementaux : stress, manque/exc√®s sommeil, repas saut√©s</li>
                <li>M√©dicamenteux : vasodilatateurs, contraceptifs</li>
                <li>Effet cumulatif : plusieurs triggers simultan√©s</li>
            </ul>
        </div>
        <div class="theorie-section">
            <h4>C√©phal√©e de tension</h4>
            <p>C√©phal√©e primaire la plus fr√©quente :</p>
            <ul>
                <li>Pr√©valence : 40-80% population</li>
                <li>Bilat√©rale, pression/√©tau (non pulsatile)</li>
                <li>Intensit√© l√©g√®re-mod√©r√©e</li>
                <li>Pas aggravation activit√© physique</li>
                <li>Pas naus√©es/vomissements significatifs</li>
                <li>Photo OU phonophobie possible (pas les deux)</li>
            </ul>
        </div>
        <div class="theorie-section">
            <h4>Algie vasculaire de la face (Cluster)</h4>
            <p>C√©phal√©e trig√©mino-autonomique s√©v√®re :</p>
            <ul>
                <li>Homme > femme (3:1), pic 20-40 ans</li>
                <li>Douleur unilat√©rale atroce p√©riorbitaire</li>
                <li>Dur√©e 15 min - 3 heures</li>
                <li>Signes autonomes ipsilat√©raux : larmoiement, rhinorrh√©e, ptosis</li>
                <li>Agitation caract√©ristique (vs immobilit√© migraine)</li>
                <li>P√©riodicit√© : clusters 4-12 semaines, r√©missions</li>
            </ul>
        </div>
        <div class="theorie-section">
            <h4>Approche th√©rapeutique stratifi√©e</h4>
            <p>Traitement adapt√© √† la s√©v√©rit√© et impact :</p>
            <ul>
                <li>Stratification : l√©g√®re ‚Üí AINS, s√©v√®re ‚Üí triptans d'embl√©e</li>
                <li>Pr√©coce : meilleure efficacit√© si pris d√©but crise</li>
                <li>Association : triptan + AINS sup√©rieur monoth√©rapie</li>
                <li>Voie administration : SC > nasal > oral si vomissements</li>
                <li>Limites : max 2 jours/semaine (c√©phal√©es rebond)</li>
                <li>√âchec triptan : v√©rifier timing, voie, dose, diagnostic</li>
            </ul>
        </div>
    </div>
</div>
<div class="annexe-item annexe-rappels-therapeutiques">
    <div class="annexe-title">Rappels th√©rapeutiques</div>
    <div class="annexe-theorie-content">
        <ul class="rappels-list">
            <li>Crise l√©g√®re : ibuprof√®ne 600-800 mg ou naprox√®ne 500 mg</li>
            <li>Crise mod√©r√©e-s√©v√®re : sumatriptan 50-100 mg PO</li>
            <li>Voie SC si vomissements : sumatriptan 6 mg</li>
            <li>Anti√©m√©tique : m√©toclopramide 10 mg si naus√©es</li>
            <li>Prophylaxie 1√®re ligne : propranolol 80-240 mg/j</li>
            <li>Alternative : topiramate 50-100 mg/j (t√©ratog√®ne)</li>
            <li>Amitriptyline 25-75 mg si composante tensionnelle</li>
            <li>Anti-CGRP si √©chec : √©renumab 70-140 mg/mois SC</li>
        </ul>
    </div>
</div>
<div class="annexe-item annexe-examens-complementaires">
    <div class="annexe-title">Examens compl√©mentaires</div>
    <div class="annexe-theorie-content">
        <ul class="examens-list">
            <li>Aucun si migraine typique sans drapeaux rouges</li>
            <li>CT c√©r√©bral sans contraste si :</li>
            <li>- C√©phal√©e thunderclap (HSA)</li>
            <li>- D√©ficit neurologique focal</li>
            <li>- Changement pattern c√©phal√©e</li>
            <li>IRM c√©r√©brale si :</li>
            <li>- C√©phal√©e nouvelle > 50 ans</li>
            <li>- Anomalie examen neurologique</li>
            <li>- C√©phal√©e progressive/atypique</li>
            <li>Ponction lombaire apr√®s imagerie normale si m√©ningite/HSA suspect√©e</li>
        </ul>
    </div>
</div>
</div>
</div>
        <!-- COMMENTAIRE G√âN√âRAL -->
        <div class="section-comment-section global">
            <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 18px;">Commentaire g√©n√©ral</h4>
            <textarea class="comment-textarea" id="comment-general" placeholder="Commentaire g√©n√©ral sur l'√©valuation..." oninput="updateGeneralComment(); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <script>
        // D√©claration des variables globales
        window.audioContext = null;
        
        function updateScore(section, element) {
            const value = element.value;
            const name = element.name;
            let pointValue;

            if (section === "communication") {
                const map = { A: 4, B: 3, C: 2, D: 1, E: 0 };
                pointValue = map[value] || 0;
                // Mettre √† jour la classe de couleur pour communication
                const criteriaRow = document.getElementById("criteria-" + name);
                if (criteriaRow) {
                    criteriaRow.classList.remove("score-a", "score-b", "score-c", "score-d", "score-e", "lacune-rouge", "lacune-orange", "lacune-verte");
                    criteriaRow.classList.add("score-" + value.toLowerCase());
                    // Ajouter les classes lacune pour communication
                    if (value === "E" || value === "D") {
                        criteriaRow.classList.add("lacune-rouge");
                    } else if (value === "C") {
                        criteriaRow.classList.add("lacune-orange");
                    } else if (value === "A" || value === "B") {
                        criteriaRow.classList.add("lacune-verte");
                    }
                }
            } else {
                pointValue = Number(value) || 0;
                // Mettre √† jour la classe de couleur pour autres crit√®res
                const criteriaRow = document.getElementById("criteria-" + name);
                if (criteriaRow) {
                    criteriaRow.classList.remove("score-0", "score-1", "score-2", "lacune-rouge", "lacune-orange", "lacune-verte");
                    criteriaRow.classList.add("score-" + value);
                    // Ajouter les classes lacune pour crit√®res normaux
                    if (pointValue === 0) {
                        criteriaRow.classList.add("lacune-rouge");
                    } else if (pointValue === 1) {
                        criteriaRow.classList.add("lacune-orange");
                    } else if (pointValue >= 2) {
                        criteriaRow.classList.add("lacune-verte");
                    }
                }
            }

            const pointsElement = document.getElementById("points-" + name);
            if (pointsElement) {
                pointsElement.textContent = pointValue;
            }

            calculateScores();
        }

        function updateDetailScore(criterionId, prefix) {
            let totalScore = 0;
            const detailCheckboxes = document.querySelectorAll('input[id^="' + criterionId + '-detail-"]');
            const maxDetailsScore = detailCheckboxes.length;
            
            detailCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    totalScore += Number(checkbox.value) || 0;
                }
            });
            
            const pointsElement = document.getElementById("points-" + criterionId);
            if (pointsElement) {
                pointsElement.textContent = totalScore;
            }
            
            // Mettre √† jour la classe de couleur en fonction du score et du max
            const criteriaRow = document.getElementById("criteria-" + criterionId);
            if (criteriaRow) {
                criteriaRow.classList.remove("score-0", "score-1", "score-2", "score-3", "score-4", "score-5", "score-max", "lacune-rouge", "lacune-orange", "lacune-verte");
                
                // D√©terminer la classe appropri√©e avec les seuils 1/3 et 2/3
                const oneThird = maxDetailsScore / 3;
                const twoThirds = (maxDetailsScore * 2) / 3;
                
                if (totalScore < oneThird) {
                    criteriaRow.classList.add("score-0");
                    criteriaRow.classList.add("lacune-rouge");
                } else if (totalScore > twoThirds) {
                    criteriaRow.classList.add("score-max");
                    criteriaRow.classList.add("lacune-verte");
                } else {
                    // Score entre 1/3 et 2/3
                    criteriaRow.classList.add("score-1");
                    criteriaRow.classList.add("lacune-orange");
                }
            }
            
            calculateScores();
        }

        function calculateScores() {
            const isNewFormat = false;
            const missingItems = [];
            let scores = {};
            let maxScores = {};
            let coef = {};
            let sectionInfo = [];

            // Configuration pour le format traditionnel
            scores = {anamnese: 0, examen: 0, management: 0, communication: 0};
            maxScores = {anamnese: 45, examen: 20, management: 24, communication: 20};
            coef = {anamnese: 0.25, examen: 0.25, management: 0.25, communication: 0.25};
            sectionInfo = [
                {key: "anamnese", prefix: "a", count: 9, label: "Anamn√®se"},
                {key: "examen", prefix: "e", count: 4, label: "Examen clinique", scoreId: "statusScore"},
                {key: "management", prefix: "m", count: 5, label: "Management"},
                {key: "communication", prefix: "c", count: 5, label: "Communication", isComm: true}
            ];

            // Calcul des scores pour chaque section
            sectionInfo.forEach(section => {
                let sectionScore = 0;
                
                if (section.isComm) {
                    // Section communication sp√©ciale
                    for (let i = 1; i <= section.count; i++) {
                        const radio = document.querySelector("input[name=\"" + section.prefix + i + "\"]:checked");
                        if (radio) {
                            const val = radio.value;
                            const map = { A: 4, B: 3, C: 2, D: 1, E: 0 };
                            sectionScore += map[val] || 0;
                        } else {
                            const criteria = document.querySelector("input[name=\"" + section.prefix + i + "\"][data-criteria]");
                            if (criteria) missingItems.push(section.label + " : " + criteria.dataset.criteria);
                        }
                    }
                } else {
                    // Sections normales
                    for (let i = 1; i <= section.count; i++) {
                        const criterionId = section.prefix + i;
                        // V√©rifier si ce crit√®re a des d√©tails avec checkboxes
                        const detailCheckboxes = document.querySelectorAll('input[id^="' + criterionId + '-detail-"]');
                        
                        if (detailCheckboxes.length > 0) {
                            // Ce crit√®re a des d√©tails, on calcule le score bas√© sur les d√©tails
                            let detailScore = 0;
                            let hasCheckedDetail = false;
                            detailCheckboxes.forEach(checkbox => {
                                if (checkbox.checked) {
                                    detailScore += Number(checkbox.value) || 0;
                                    hasCheckedDetail = true;
                                }
                            });
                            sectionScore += detailScore;
                            
                            if (!hasCheckedDetail) {
                                const criteria = document.querySelector("input[name=\"" + criterionId + "\"][data-criteria]");
                                if (criteria) {
                                    missingItems.push(section.label + " : " + criteria.dataset.criteria);
                                } else {
                                    // Rechercher le texte du crit√®re directement
                                    const criteriaText = document.querySelector("#criteria-" + criterionId + " .criteria-text");
                                    if (criteriaText) {
                                        missingItems.push(section.label + " : " + criteriaText.textContent.split(". ")[1].split(" [")[0]);
                                    }
                                }
                            }
                        } else {
                            // Crit√®re normal sans d√©tails
                            const radio = document.querySelector("input[name=\"" + criterionId + "\"]:checked");
                            if (radio) {
                                sectionScore += Number(radio.value) || 0;
                            } else {
                                const criteria = document.querySelector("input[name=\"" + criterionId + "\"][data-criteria]");
                                if (criteria) missingItems.push(section.label + " : " + criteria.dataset.criteria);
                            }
                        }
                    }
                }
                
                scores[section.key] = sectionScore;
                const scoreId = section.scoreId || section.key + "Score";
                const scoreElement = document.getElementById(scoreId);
                if (scoreElement) scoreElement.textContent = sectionScore;
            });

            // Calcul des pourcentages par section
            let percentages = {};
            let globalPercentage = 0;
            let isStarted = false;
            
            sectionInfo.forEach(section => {
                const score = scores[section.key];
                const max = maxScores[section.key];
                const percentage = max > 0 ? (score / max) * 100 : 0;
                percentages[section.key] = percentage;
                globalPercentage += percentage * coef[section.key];
                if (score > 0) isStarted = true;
            });

            const totalScoreText = isStarted ? Math.round(globalPercentage) : 0;
            document.getElementById("totalScore").textContent = totalScoreText + "%";

            // Mise √† jour des pourcentages affich√©s
            sectionInfo.forEach(section => {
                const percentageElement = document.getElementById(section.key + "-percentage");
                if (percentageElement) {
                    percentageElement.textContent = Math.round(percentages[section.key]);
                }
            });

            const gradeElement = document.getElementById("globalGrade");
            const totalScoreElement = document.getElementById("totalScore");
            const scoreBody = totalScoreElement ? totalScoreElement.closest(".total-body") : null;
            const gradeBody = gradeElement ? gradeElement.closest(".total-body") : null;
            const sections = sectionInfo.map(s => s.key);

            const allClasses = ["note-a", "note-b", "note-c", "note-d", "note-e", "note-neutral"];

            function getClass(p) {
                if (p === 0) return "note-neutral";
                if (p >= 90) return "note-a";
                if (p >= 80) return "note-b";
                if (p >= 70) return "note-c";
                if (p >= 60) return "note-d";
                return "note-e";
            }

            const gradeClass = getClass(globalPercentage);
            const gradeLabel = isStarted ? gradeClass.split("-")[1].toUpperCase() : "A-E";
            if (gradeElement) gradeElement.textContent = gradeLabel;

            const pourcentBody = document.querySelector(".total-pourcent-body");

            [gradeElement, scoreBody, gradeBody, pourcentBody].forEach(el => {
                if (el) {
                    el.classList.remove(...allClasses);
                    el.classList.add(gradeClass);
                }
            });

            sections.forEach(id => {
                const percentageElement = document.getElementById(id + "-percentage");
                if (percentageElement) {
                    const value = parseInt(percentageElement.textContent);
                    const section = percentageElement.closest(".total-pourcent-section");
                    const sectionClass = getClass(value);
                    if (section) {
                        section.classList.remove(...allClasses);
                        section.classList.add(sectionClass);
                    }
                }
            });

            // Appliquer les couleurs aux sections principales
            sectionInfo.forEach(section => {
                const percentage = percentages[section.key];
                const allSections = document.querySelectorAll(".section");
                allSections.forEach(sectionEl => {
                    const headerText = sectionEl.querySelector(".section-header")?.textContent || "";
                    if (headerText.includes(section.label)) {
                        const sectionClass = getClass(percentage);
                        sectionEl.classList.remove(...allClasses);
                        sectionEl.classList.add(sectionClass);
                    }
                });
            });

            if (missingItems.length > 0) {
                document.getElementById("missingItems").style.display = "block";
                document.getElementById("missingList").innerHTML = missingItems.map(item =>
                    "<div class=\"missing-item\">‚Ä¢ " + item + "</div>"
                ).join("");
            } else {
                document.getElementById("missingItems").style.display = "none";
            }
        }
        // MINUTEUR ECOS 13 MINUTES
        window.timerInterval = null;
        window.currentSeconds = 13 * 60;
        window.isRunning = false;
        window.hasStarted = false;
        window.hasFinished = false;
        window.hasStoppedManually = false;

        window.currentMode = 'revision';

        function colorPatientResponses() {
            // Version simplifi√©e inspir√©e du g√©n√©rateur v1
            const elements = document.querySelectorAll('.criteria-text, .sub-criteria, .redflags-text, .dd-item, .therapy-section, .detail-text, .cloture-content');
            elements.forEach(element => {
                const text = element.innerHTML;
                // Colorer uniquement les r√©ponses patient en bleu (pas les examens compl√©mentaires)
                let coloredText = text.replace(/\[([^\]]+)\]/g, '<span style="color: rgb(44, 90, 160); font-weight: 500;">[$1]</span>');
                element.innerHTML = coloredText;
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            switchMode('revision');
            calculateScores();
            colorPatientResponses();
            // Appeler une deuxi√®me fois apr√®s un court d√©lai pour s'assurer que tout est charg√©
            setTimeout(function() {
                colorPatientResponses();
            }, 100);
            // Appel suppl√©mentaire apr√®s un d√©lai plus long pour garantir que tout est charg√©
            setTimeout(function() {
                colorPatientResponses();
            }, 500);
            // Auto-resize tous les textareas au chargement
            const allTextareas = document.querySelectorAll('.comment-textarea');
            allTextareas.forEach(textarea => {
                if (textarea.value) {
                    autoResizeTextarea(textarea);
                }
            });
        });
        
        // S'assurer que la hauteur est bien d√©finie avant l'impression
        window.addEventListener('beforeprint', function() {
            const allTextareas = document.querySelectorAll('.comment-textarea');
            allTextareas.forEach(textarea => {
                if (textarea.value && textarea.value.trim()) {
                    // S'assurer que le textarea a une hauteur d√©finie
                    if (!textarea.style.height || textarea.style.height === 'auto') {
                        autoResizeTextarea(textarea);
                    }
                }
            });
        });


        function initAudio() {
            if (!window.audioContext) {
                window.audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playBeep() {
            initAudio();
            const oscillator = window.audioContext.createOscillator();
            const gainNode = window.audioContext.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(window.audioContext.destination);
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            gainNode.gain.setValueAtTime(0.3, window.audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, window.audioContext.currentTime + 0.5);
            oscillator.start(window.audioContext.currentTime);
            oscillator.stop(window.audioContext.currentTime + 0.5);
        }

        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'fr-FR';
                utterance.rate = 0.9;
                utterance.volume = 0.8;
                speechSynthesis.speak(utterance);
            }
        }

        function playSound(message) {
            playBeep();
            setTimeout(() => speak(message), 500);
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return minutes + ":" + secs.toString().padStart(2, "0");
        }

        function toggleCheckboxes(disabled) {
            const radios = document.querySelectorAll('input[type="radio"]');
            radios.forEach(radio => {
                radio.disabled = disabled;
            });
            const detailCheckboxes = document.querySelectorAll('.detail-checkbox input[type="checkbox"]');
            detailCheckboxes.forEach(checkbox => {
                checkbox.disabled = disabled;
            });
        }

        function colorCriteriaByScore() {
            if (!window.hasFinished && !window.hasStoppedManually) return;

            const normalCriteriaRows = document.querySelectorAll('.criteria-row');
            normalCriteriaRows.forEach(row => {
                const id = row.id;
                if (!id) return;
                const criteriaName = id.replace('criteria-', '');
                const checkedRadio = document.querySelector('input[name="' + criteriaName + '"]:checked');
                row.classList.remove('criteria-zero-points', 'criteria-one-point', 'criteria-full-points', 'criteria-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
                if (checkedRadio) {
                    const score = Number(checkedRadio.value) || 0;
                    if (score === 0) {
                        row.classList.add('criteria-zero-points');
                        row.classList.add('lacune-rouge');
                    } else if (score === 1) {
                        row.classList.add('criteria-one-point');
                        row.classList.add('lacune-orange');
                    } else if (score >= 2) {
                        row.classList.add('criteria-full-points');
                        row.classList.add('lacune-verte');
                    }
                } else {
                    row.classList.add('criteria-not-answered');
                    row.classList.add('lacune-rouge');
                }
            });

            const communicationRows = document.querySelectorAll('.communication-section');
            communicationRows.forEach(row => {
                const id = row.id;
                if (!id) return;
                const criteriaName = id.replace('criteria-', '');
                const checkedRadio = document.querySelector('input[name="' + criteriaName + '"]:checked');
                row.classList.remove('communication-note-a', 'communication-note-b', 'communication-note-c', 'communication-note-d', 'communication-note-e', 'communication-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
                if (checkedRadio) {
                    const grade = checkedRadio.value.toLowerCase();
                    row.classList.add("communication-note-" + grade);
                    if (grade === 'e' || grade === 'd') {
                        row.classList.add('lacune-rouge');
                    } else if (grade === 'c') {
                        row.classList.add('lacune-orange');
                    } else if (grade === 'a' || grade === 'b') {
                        row.classList.add('lacune-verte');
                    }
                } else {
                    row.classList.add('communication-not-answered');
                    row.classList.add('lacune-rouge');
                }
            });
        }

        function startTimer() {
            if (window.isRunning || window.currentMode !== 'exam') return;
            window.isRunning = true;
            window.hasStarted = true;
            window.hasStoppedManually = false;
            document.body.classList.add('timer-running');
            toggleCheckboxes(false);
            playSound("D√©but de la station");
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('stopBtn').style.display = 'inline-block';
            document.getElementById('resetBtn').disabled = true;
            document.getElementById('timerStatus').textContent = 'En cours';
            document.getElementById('timerStatus').className = 'timer-status status-running';
            
            window.timerInterval = setInterval(() => {
                window.currentSeconds--;
                document.getElementById('timerDisplay').textContent = formatTime(window.currentSeconds);
                const container = document.getElementById('timerContainer');
                if (window.currentSeconds === 2 * 60) {
                    if (window.currentMode === 'exam') {
                        playSound("Il vous reste 2 minutes");
                    }
                    container.classList.add('timer-warning');
                    document.getElementById('timerStatus').textContent = '2 min restantes';
                    document.getElementById('timerStatus').className = 'timer-status status-warning';
                }
                if (window.currentSeconds <= 30) {
                    container.classList.add('timer-critical');
                }
                if (window.currentSeconds <= 0) {
                    endTimer();
                }
            }, 1000);
        }

        function stopTimer() {
            if (!window.isRunning) return;
            clearInterval(window.timerInterval);
            window.isRunning = false;
            window.hasStoppedManually = true;
            document.body.classList.remove('timer-running');
            // Ne pas d√©sactiver les checkboxes pour permettre de continuer √† cocher apr√®s arr√™t
            // toggleCheckboxes(true);
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            document.getElementById('resetBtn').disabled = false;
            document.getElementById('timerStatus').textContent = 'Arr√™t√©';
            document.getElementById('timerStatus').className = 'timer-status';
            colorCriteriaByScore();
        }

        function endTimer() {
            clearInterval(window.timerInterval);
            window.isRunning = false;
            window.hasFinished = true;
            window.currentSeconds = 0;
            document.body.classList.remove('timer-running');
            if (window.currentMode === 'exam') {
                playSound("Fin de la station. Veuillez sortir");
                // Repasser automatiquement en mode r√©vision apr√®s la fin du timer
                switchMode('revision');
            }
            document.getElementById('timerDisplay').textContent = '0:00';
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            document.getElementById('resetBtn').disabled = false;
            document.getElementById('timerStatus').textContent = 'Termin√©';
            document.getElementById('timerStatus').className = 'timer-status status-finished';
            document.getElementById('timerStatus').style.display = 'block';
            document.getElementById('timerContainer').className = 'timer-container';
            // Ne pas d√©sactiver les checkboxes apr√®s la fin pour permettre de continuer
            // toggleCheckboxes(true);
            colorCriteriaByScore();
        }

        function resetTimer() {
            clearInterval(window.timerInterval);
            window.timerInterval = null;
            window.currentSeconds = 13 * 60;
            window.isRunning = false;
            window.hasStarted = false;
            window.hasFinished = false;
            window.hasStoppedManually = false;
            document.getElementById('timerDisplay').textContent = '13:00';
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            // Supprimer la coloration des crit√®res
            const criteriaAndCommRows = document.querySelectorAll('.criteria-row, .communication-section');
            criteriaAndCommRows.forEach(row => {
                row.classList.remove('score-0', 'score-1', 'score-2', 'score-a', 'score-b', 'score-c', 'score-d', 'score-e');
            });
            // Supprimer la coloration des sections
            const allSections = document.querySelectorAll('.section');
            allSections.forEach(section => {
                section.classList.remove('note-a', 'note-b', 'note-c', 'note-d', 'note-e');
                section.classList.add('note-neutral');
            });
            document.getElementById('timerStatus').style.display = 'none';
            document.getElementById('timerContainer').className = 'timer-container';
            // En mode r√©vision, ne pas d√©sactiver les checkboxes
            if (window.currentMode === 'exam') {
                toggleCheckboxes(true);
            }
            const allRadios = document.querySelectorAll('input[type="radio"]');
            allRadios.forEach(radio => {
                radio.checked = false;
            });
            // R√©initialiser les detail-checkboxes
            const allDetailCheckboxes = document.querySelectorAll('.detail-checkbox input[type="checkbox"]');
            allDetailCheckboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            const allPointsDisplays = document.querySelectorAll('.points-display');
            allPointsDisplays.forEach(display => {
                display.textContent = '0';
            });
            const allCriteriaRows = document.querySelectorAll('.criteria-row');
            allCriteriaRows.forEach(row => {
                row.classList.remove('criteria-zero-points', 'criteria-one-point', 'criteria-full-points', 'criteria-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
            });
            const allCommunicationRows = document.querySelectorAll('.communication-section');
            allCommunicationRows.forEach(row => {
                row.classList.remove('communication-note-a', 'communication-note-b', 'communication-note-c', 'communication-note-d', 'communication-note-e', 'communication-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
            });
            calculateScores();
            // Supprimer tous les commentaires et cacher les textareas
            const allTextareas = document.querySelectorAll('.comment-textarea');
            allTextareas.forEach(textarea => {
                textarea.value = '';
                textarea.style.height = textarea.classList.contains('comment-textarea') && textarea.closest('.section-comment-section.global') ? '30px' : (textarea.closest('.section-comment-section') ? '28px' : '26px');
            });
            // Cacher toutes les sections de commentaires ouvertes
            const allCommentSections = document.querySelectorAll('.criterion-comment-section.show, .section-comment-section.show');
            allCommentSections.forEach(section => {
                section.classList.remove('show');
            });
            // Mettre √† jour les boutons de commentaires
            const allCommentButtons = document.querySelectorAll('.comment-button, .section-comment-button');
            allCommentButtons.forEach(button => {
                button.classList.remove('has-content');
            });
        }
        
        function switchMode(mode) {
            window.currentMode = mode;
            const body = document.body;
            body.className = mode + '-mode';
            const buttons = document.querySelectorAll('.mode-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            buttons.forEach(btn => {
                if (btn.textContent.includes(mode === "revision" ? "R√©vision" : "Examen")) {
                    btn.classList.add("active");
                }
            });
            if (mode === 'revision') {
                toggleCheckboxes(false);
                showLacunesButton();
            } else {
                if (!window.hasStarted) {
                    toggleCheckboxes(true);
                }
                hideLacunesButton();
            }
        }
        
        function showLacunesButton() {
            const btn = document.querySelector('.lacune-button');
            if (btn) btn.style.display = 'block';
        }
        
        function hideLacunesButton() {
            const btn = document.querySelector('.lacune-button');
            if (btn) btn.style.display = 'none';
        }
        
        function identifyLacunes() {
            // Crit√®res standards (anamn√®se, examen, management)
            const criteria = document.querySelectorAll(".criteria-row");
            criteria.forEach(criterion => {
                const id = criterion.id.replace("criteria-", "");
                const pointsElement = document.getElementById("points-" + id);
                const points = pointsElement ? parseInt(pointsElement.textContent) : 0;
                
                criterion.classList.remove("lacune-rouge", "lacune-orange", "lacune-verte");
                
                if (points === 0) {
                    criterion.classList.add("lacune-rouge");
                } else if (points === 1) {
                    criterion.classList.add("lacune-orange");
                } else if (points >= 2) {
                    criterion.classList.add("lacune-verte");
                }
            });
            
            // Crit√®res communication (√©chelle A-E)
            const commCriteria = document.querySelectorAll(".communication-section");
            commCriteria.forEach(criterion => {
                const id = criterion.id.replace("criteria-", "");
                const radio = document.querySelector("input[name=\"" + id + "\"]:checked");
                
                criterion.classList.remove("lacune-rouge", "lacune-orange", "lacune-verte");
                
                if (!radio) {
                    criterion.classList.add("lacune-rouge");
                } else {
                    const grade = radio.value;
                    if (grade === "E" || grade === "D") {
                        criterion.classList.add("lacune-rouge");
                    } else if (grade === "C") {
                        criterion.classList.add("lacune-orange");
                    } else if (grade === "A" || grade === "B") {
                        criterion.classList.add("lacune-verte");
                    }
                }
            });
        }
        function toggleComment(id) {
            const section = document.getElementById("comment-section-" + id);
            const textarea = document.getElementById("comment-" + id);
            if (section) {
                section.classList.toggle("show");
                // Focus automatiquement sur le textarea quand on ouvre la section
                if (section.classList.contains("show") && textarea) {
                    textarea.focus();
                }
            }
        }

        function updateCommentButton(id) {
            const textarea = document.getElementById("comment-" + id);
            const criterionRow = document.getElementById("criteria-" + id);
            const commentSection = document.getElementById("comment-section-" + id);
            if (textarea && criterionRow) {
                const button = criterionRow.querySelector(".comment-button");
                if (button) {
                    if (textarea.value.trim()) {
                        button.classList.add("has-content");
                        if (commentSection) commentSection.classList.add("has-content");
                    } else {
                        button.classList.remove("has-content");
                        if (commentSection) commentSection.classList.remove("has-content");
                    }
                }
            }
        }

        function toggleSectionComment(section) {
            const commentSection = document.getElementById("section-comment-" + section);
            const textarea = document.getElementById("comment-section-" + section);
            if (commentSection) {
                commentSection.classList.toggle("show");
                // Focus automatiquement sur le textarea quand on ouvre la section
                if (commentSection.classList.contains("show") && textarea) {
                    textarea.focus();
                }
            }
        }

        function updateSectionComment(section) {
            const textarea = document.getElementById("comment-section-" + section);
            const commentSection = document.getElementById("section-comment-" + section);
            const buttons = document.querySelectorAll(".section-comment-button");
            buttons.forEach(button => {
                if (button.getAttribute("onclick") && button.getAttribute("onclick").includes(section)) {
                    if (textarea && textarea.value.trim()) {
                        button.classList.add("has-content");
                        if (commentSection) commentSection.classList.add("has-content");
                    } else {
                        button.classList.remove("has-content");
                        if (commentSection) commentSection.classList.remove("has-content");
                    }
                }
            });
        }

        function updateGeneralComment() {
            const textarea = document.getElementById("comment-general");
            if (textarea) {
                const section = textarea.closest(".section-comment-section");
                if (section) {
                    if (textarea.value.trim()) {
                        section.classList.add("has-content");
                    } else {
                        section.classList.remove("has-content");
                    }
                }
            }
        }

        function autoResizeTextarea(textarea) {
            // Reset height to auto to get correct scrollHeight
            textarea.style.height = "auto";
            // Set new height based on content
            const newHeight = textarea.scrollHeight + 2;
            textarea.style.height = newHeight + "px";
        }

    </script>
    <!-- BOUTON IMPRIMER EN PDF -->
    <button class="print-button" onclick="window.print()">üñ®Ô∏è Imprimer en PDF</button>
    <script>
        // Appel final pour s'assurer que tout est color√©
        // Forcer la coloration finale
        if (window.colorPatientResponses) {
            window.colorPatientResponses();
        }
    </script>
</body>
</html>
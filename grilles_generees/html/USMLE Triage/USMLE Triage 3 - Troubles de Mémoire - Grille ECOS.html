<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USMLE Triage 3 - Troubles de Mémoire - Grille ECOS</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); }
        .header { background: #2c5aa0; color: white; padding: 15px; margin: -20px -20px 20px -20px; border-radius: 8px 8px 0 0; }
        .section { margin-bottom: 30px; border: 2px solid #ddd; border-radius: 8px; overflow: hidden; background-color: #ffffff; }
        .section-header { background: #f8f9fa; padding: 15px; font-weight: bold; font-size: 18px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; }
        .section-content { padding: 15px; background-color: #ffffff; }
        .header-row { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px; gap: 10px; padding: 10px 0; border-bottom: 2px solid #ddd; font-weight: bold; text-align: center; color: #333333; }
        .header-row.communication-header { grid-template-columns: 2fr 80px 80px 80px 80px 80px; }
        .header-row div:first-child { text-align: left; }
        .criteria-row { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px; gap: 10px; align-items: start; padding: 15px 0 15px 5px; border-bottom: 1px solid #eeeeee; }
        .criteria-row:last-child { border-bottom: none; }
        .criteria-text { font-weight: 500; }
        .sub-criteria { font-size: 0.9em; color: #333; margin-top: 5px; padding-left: 18px; line-height: 1.2; }
        .details-with-checkboxes { margin-top: 8px; }
        .detail-row { display: grid; grid-template-columns: 1fr 100px; align-items: center; padding: 2px 0 2px 18px; gap: 10px; line-height: 1.1; }
        .detail-text { font-size: 0.9em; color: #333; }
        .patient-response-highlight { color: rgb(44, 90, 160) !important; }
        .detail-text .patient-response-highlight { color: rgb(44, 90, 160) !important; }
        .criteria-detail .patient-response-highlight { color: rgb(44, 90, 160) !important; }
        .detail-checkboxes { text-align: center; }
        .detail-checkbox input[type="checkbox"] { cursor: pointer; transform: scale(1.1); }
        .patient-response { font-size: 0.9em; color: rgb(44, 90, 160); font-weight: 500; }
        .exemples-phrases { margin-top: 8px; padding-left: 20px; }
        .exemple-phrase { font-size: 0.9em; color: rgba(112, 188, 123, 0.95); font-style: italic; line-height: 1.4; margin: 3px 0; }
        .checkbox-group { text-align: center; }
        .points-display { text-align: center; font-weight: bold; color: #2c5aa0; font-size: 18px; }
        .scoring-rule { font-size: 0.85em; color: #888; font-style: italic; margin-top: 8px; padding-left: 20px; }
        .criteria-subheader { background: #fffbe6; padding: 10px 15px; margin: 10px 0 5px 0; border-left: 4px solid #faad14; font-weight: bold; color: #8b6914; }
        input[type="radio"] { cursor: pointer; transform: scale(1.2); }
        input[type="radio"]:disabled { opacity: 0.3; cursor: not-allowed; }
        .score { font-weight: bold; color: hsl(216, 57%, 40%); font-size: 18px; }
        .total-sections { display: grid; grid-template-columns: 1fr 2fr 1fr; gap: 20px; margin-bottom: 30px; }
        .total-section { display: flex; flex-direction: column; justify-content: space-between; text-align: center; background: #f0f8ff; border: 1px solid #ddd; border-radius: 8px; transition: all 0.3s; }
        .total-label { background: #f8f9fa; padding: 5px; font-weight: bold; font-size: 20px; border-bottom: 1px solid #ddd; }
        .total-body { flex: 1; display: flex; align-items: center; justify-content: center; padding: 5px; }
        .total-pourcent-body { flex: 1; padding: 10px; }
        .total-score, .total-note-globale { font-size: 56px; font-weight: bold; line-height: 1; }
        .total-pourcent-sections { display: flex; flex-wrap: nowrap; gap: 10px; height: 100%; align-items: stretch; }
        .total-pourcent-section { flex: 1 1 auto; min-width: 0; display: flex; flex-direction: column; text-align: center; background: #416caa; padding: 10px; border-radius: 5px; transition: all 0.3s; border: none; }
        .total-pourcent-section:last-child { border-right: none; }
        .total-section-label { color: #eeeeee; font-size: 14px; font-weight: normal; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .pourcent-body { flex: 1; display: flex; align-items: center; justify-content: center; }
        .total-pourcent-value { font-weight: bold; font-size: 28px; line-height: 1; color: white; transition: all 0.3s; }
        .note-a { background-color: #e6f4ea; color: #2c974b; }
        .note-a.total-pourcent-section { background-color: #2c974b; }
        .note-b { background-color: #e9f3fd; color: #4e9cf0; }
        .note-b.total-pourcent-section { background-color: #4e9cf0; }
        .note-c { background-color: #fdf5e6; color: #f0ad4e; }
        .note-c.total-pourcent-section { background-color: #f0ad4e; }
        .note-d { background-color: #fceee3; color: #e67e22; }
        .note-d.total-pourcent-section { background-color: #e67e22; }
        .note-e { background-color: #fbeaea; color: #d9534f; }
        .note-e.total-pourcent-section { background-color: #d9534f; }
        .note-neutral { background-color: #f0f8ff; color: #2c5aa0; }
        .note-neutral.total-pourcent-section { background-color: #6B8BC3; }
        .note-a.total-pourcent-body { background-color: #e6f4ea; }
        .note-b.total-pourcent-body { background-color: #e9f3fd; }
        .note-c.total-pourcent-body { background-color: #fdf5e6; }
        .note-d.total-pourcent-body { background-color: #fceee3; }
        .note-e.total-pourcent-body { background-color: #fbeaea; }
        .note-neutral.total-pourcent-body { background-color: #f0f8ff; }
        /* Styles pour les sections avec coloration selon le score */
        .section.note-a { border-color: #2c974b; }
        .section.note-a .section-header { background-color: #e6f4ea; color: #2c974b; }
        .section.note-b { border-color: #4e9cf0; }
        .section.note-b .section-header { background-color: #e9f3fd; color: #4e9cf0; }
        .section.note-c { border-color: #f0ad4e; }
        .section.note-c .section-header { background-color: #fdf5e6; color: #f0ad4e; }
        .section.note-d { border-color: #e67e22; }
        .section.note-d .section-header { background-color: #fceee3; color: #e67e22; }
        .section.note-e { border-color: #d9534f; }
        .section.note-e .section-header { background-color: #fbeaea; color: #d9534f; }
        .section.note-neutral { border-color: #ddd; }
        .section.note-neutral .section-header { background-color: #f8f9fa; color: #333333; }
        /* Styles pour les critères individuels */
        .criteria-row.score-2 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-2 .criteria-text { color: #2c974b; }
        .criteria-row.score-max { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-max .criteria-text { color: #2c974b; }
        .criteria-row.score-1 { background-color: rgba(240, 173, 78, 0.1); }
        .criteria-row.score-1 .criteria-text { color: #f0ad4e; }
        .criteria-row.score-0 { background-color: rgba(217, 83, 79, 0.1); }
        .criteria-row.score-0 .criteria-text { color: #d9534f; }
        .criteria-row:not(.score-0):not(.score-1):not(.score-2):not(.score-max) .criteria-text { color: #000; }
        /* Styles supplémentaires pour les scores plus élevés */
        .criteria-row.score-3 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-3 .criteria-text { color: #2c974b; }
        .criteria-row.score-4 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-4 .criteria-text { color: #2c974b; }
        .criteria-row.score-5 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-5 .criteria-text { color: #2c974b; }
        .communication-section.score-a { background-color: rgba(44, 151, 75, 0.1); }
        .communication-section.score-a .communication-text { color: #2c974b; }
        .communication-section.score-b { background-color: rgba(78, 156, 240, 0.1); }
        .communication-section.score-b .communication-text { color: #4e9cf0; }
        .communication-section.score-c { background-color: rgba(240, 173, 78, 0.1); }
        .communication-section.score-c .communication-text { color: #f0ad4e; }
        .communication-section.score-d { background-color: rgba(230, 126, 34, 0.1); }
        .communication-section.score-d .communication-text { color: #e67e22; }
        .communication-section.score-e { background-color: rgba(217, 83, 79, 0.1); }
        .communication-section.score-e .communication-text { color: #d9534f; }
        .grade-scale { margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; }
        .grade-scale h3 { margin-top: 0; }
        .grade-row { display: flex; justify-content: space-between; padding: 5px 0; }
        .missing-items { display: none !important; }
        .missing-items h3 { margin-top: 0; }
        .missing-item { color: #dc3545; font-weight: bold; }
        .redflags-main-section { margin-top: 30px; padding: 20px; background: #fff5f5; border-radius: 8px; border: 1px solid #f5c6cb; }
        .redflags-main-section h3 { margin-top: 0; border-bottom: 2px solid #f5c6cb; padding-bottom: 10px; }
        .redflags-category-section { margin: 15px 0; padding: 10px; background: white; border-radius: 5px; border-left: 4px solid #dc3545; }
        .annexes { margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #ddd; }
        .annexes h3 { margin-top: 0; color: #2c5aa0; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        .annexes-grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin-top: 20px; }
        .annexe-item { padding: 15px; background: white; border-radius: 5px; border: 1px solid #e0e0e0; }
        .annexe-title { font-weight: bold; color: #2c5aa0; margin-bottom: 8px; font-size: 16px; }
        .annexe-description { color: #666; font-style: italic; margin-bottom: 10px; font-size: 14px; }
        .annexe-image { text-align: center; margin: 10px 0; }
        .annexe-image img { max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .annexe-document { background: #f0f8ff; padding: 10px; border-radius: 4px; border-left: 4px solid #2c5aa0; white-space: pre-wrap; font-family: "Courier New", monospace; font-size: 13px; }
        
        /* Styles pour le scénario de la patiente standardisée */
        .annexe-scenario { grid-column: 1 / -1; max-width: none; }
        .annexe-scenario-content { padding: 15px; background: #fafafa; border-radius: 4px; }
        .scenario-info { background: #e8f4f8; padding: 10px 15px; border-radius: 4px; margin-bottom: 15px; font-size: 15px; }
        .scenario-section { margin-bottom: 20px; }
        .scenario-subsection { margin-bottom: 15px; }
        .scenario-subsection strong { color: #2c5aa0; }
        .scenario-section h4 { color: #2c5aa0; margin: 15px 0 10px 0; font-size: 16px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        .scenario-section ul { margin: 10px 0; padding-left: 25px; }
        .scenario-section li { margin: 5px 0; line-height: 1.5; }
        .scenario-subsection { margin: 10px 0 15px 0; }
        .scenario-subsection strong { color: #555; }
        .scenario-subsection ul { margin-top: 5px; }
        
        /* Styles pour les interventions de l'expert */
        .annexe-interventions { grid-column: 1 / -1; max-width: none; }
        .annexe-interventions-content { padding: 15px; }
        .intervention-item { background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 12px; margin-bottom: 12px; }
        .intervention-header { font-size: 15px; margin-bottom: 8px; color: #856404; }
        .intervention-moment { font-weight: normal; font-style: italic; color: #666; }
        .intervention-instruction { margin: 8px 0; color: #333; }
        .intervention-message { background: #fff; padding: 8px 12px; border-left: 3px solid #ffc107; font-style: italic; color: #721c24; margin-top: 8px; }
        
        /* Styles pour les informations de l'expert */
        .annexe-informations-expert { grid-column: 1 / -1; max-width: none; }
        .annexe-informations-content { padding: 15px; background: #f5f5f5; border-radius: 4px; }
        .info-section { margin-bottom: 20px; }
        .info-section:last-child { margin-bottom: 0; }
        .info-section h4 { color: #2c5aa0; margin: 0 0 10px 0; font-size: 16px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        .info-section h5 { color: #4a7ba7; margin: 15px 0 8px 0; font-size: 14px; font-weight: 600; }
        .info-section p { margin: 10px 0; line-height: 1.6; }
        .info-section ul { margin: 10px 0; padding-left: 25px; }
        .info-section li { margin: 5px 0; line-height: 1.5; }
        
        /* Styles pour les diagnostics différentiels dans annexes */
        .annexe-dd-section { grid-column: 1 / -1; max-width: none; }
        .annexe-dd-content { padding: 15px; background: #fff5f0; border-radius: 4px; }
        .dd-category { margin-bottom: 20px; }
        .dd-category:last-child { margin-bottom: 0; }
        .dd-category h4 { color: #a92117; margin: 0 0 15px 0; font-size: 16px; border-bottom: 1px solid #e0d0c8; padding-bottom: 5px; }
        .dd-items { display: flex; flex-direction: column; gap: 15px; }
        .dd-item { background: white; border: 1px solid #e5e5e5; border-radius: 4px; padding: 12px; }
        .dd-item-header { margin-bottom: 8px; }
        .dd-diagnosis { color: #a92117; font-weight: 600; font-size: 15px; }
        .dd-cause { margin-bottom: 8px; line-height: 1.5; font-size: 14px; }
        .dd-test { font-size: 14px; margin-top: 5px; }
        
        /* Styles pour la théorie pratique */
        .annexe-theorie-pratique { grid-column: 1 / -1; max-width: none; }
        .annexe-theorie-content { padding: 15px; background: #f0f5ff; border-radius: 4px; }
        .theorie-text { line-height: 1.6; color: #333; }
        .theorie-section { margin-bottom: 20px; }
        .theorie-section:last-child { margin-bottom: 0; }
        .theorie-section h4 { color: #1a4b84; margin: 0 0 10px 0; font-size: 16px; }
        .theorie-section p { margin: 10px 0; line-height: 1.6; }
        .theorie-section ul { margin: 10px 0; padding-left: 25px; }
        .theorie-section li { margin: 5px 0; line-height: 1.5; }
        /* Styles pour rappels thérapeutiques et examens complémentaires */
        .annexe-rappels-therapeutiques, .annexe-examens-complementaires { grid-column: 1 / -1; max-width: none; }
        .rappels-list, .examens-list { margin: 0; padding-left: 25px; }
        .rappels-list li, .examens-list li { margin: 8px 0; line-height: 1.6; color: #333; }
        .annexe-rappels-therapeutiques .annexe-title { color: #998800; }
        .annexe-examens-complementaires .annexe-title { color: #346929; }
        
        /* Styles pour le tableau clinique */
        .tableau-clinique { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 14px; }
        .tableau-clinique thead { background-color: #2c5aa0; color: white; }
        .tableau-clinique th { padding: 10px; text-align: left; border: 1px solid #ddd; }
        .tableau-clinique tbody tr:nth-child(even) { background-color: #f9f9f9; }
        .tableau-clinique tbody tr:hover { background-color: #e8f4f8; }
        .tableau-clinique td { padding: 8px; border: 1px solid #ddd; }
        
        .communication-section { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px 80px; gap: 10px; align-items: start; padding: 15px 0 15px 5px; border-bottom: 1px solid #eee; }
        .communication-text { font-weight: 500; }
        .communication-desc { font-size: 0.85em; color: #666; margin-top: 5px; font-style: italic; }
        /* Section Clôture */
        .cloture-section { margin-bottom: 20px; }
        .cloture-section .section-header { background-color: #f0f4f8; }
        .cloture-item { margin-bottom: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 5px; }
        .cloture-title { color: #2c5aa0; margin: 0 0 10px 0; font-size: 16px; font-weight: bold; }
        .cloture-content { color: #333; line-height: 1.6; font-style: italic; }
        .cloture-content-green { color: rgb(112, 188, 123); font-weight: 500; }
        .communication-desc-detail { font-size: 0.8em; color: #666; margin-left: 20px; font-style: normal; }
        .vital-signs { margin-top: 10px; margin-bottom: 0px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; font-size: 0.9em; }
        .vital-sign { text-align: center; background: #416caa; padding: 10px; border-radius: 5px; }
        .vital-sign-label { color: #eeeeee; }
        .vital-sign-value { color: rgb(255, 255, 255); margin-top: 2px; }
        .dd-section { background: #f0f8ff; padding: 15px; margin: 0 0 10px 0; border-radius: 5px; }
        .dd-title { font-weight: bold; margin-bottom: 10px; color: #2c5aa0; }
        .dd-category { margin: 10px 0; font-weight: bold; color: #2c5aa0; }
        .dd-item { margin-left: 20px; margin-top: 5px; font-weight: bold; color: rgb(169, 34, 23); }
        .dd-test { color: #666; font-style: italic; margin-left: 10px; }
        .therapy-section { background: rgba(255, 250, 230, 0.4); padding: 10px 10px 0 20px; margin: 0; border-radius: 5px; color: #000; }
        .therapy-title { font-weight: bold; margin-bottom: 5px; color: #998800; }
        .redflags-section { background: #fff5f5; padding: 10px; margin: 5px 0; border-radius: 5px; }
        .redflags-title { font-weight: bold; margin-bottom: 8px; color: #dc3545; }
        .redflags-item { margin-bottom: 6px; padding-left: 22px; }
        .redflags-text { color: #dc3545; font-weight: 500; }
        .redflags-description { color: #666; font-size: 0.9em; margin-top: 2px; margin-left: 20px; }
        .annexes { margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #ddd; }
        .annexes h3 { margin-top: 0; color: #2c5aa0; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        .annexes-grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin-top: 20px; }
        .annexe-item { padding: 15px; background: white; border-radius: 5px; border: 1px solid #e0e0e0; }
        .annexe-title { font-weight: bold; color: #2c5aa0; margin-bottom: 8px; font-size: 16px; }
        .annexe-description { color: #666; font-style: italic; margin-bottom: 10px; font-size: 14px; }
        .annexe-image { text-align: center; margin: 10px 0; }
        .annexe-image img { max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .annexe-document { background: #f0f8ff; padding: 10px; border-radius: 4px; border-left: 4px solid #2c5aa0; white-space: pre-wrap; font-family: "Courier New", monospace; font-size: 13px; }
        
        /* MINUTEUR */
        .timer-container {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.75);
            border: 3px solid #2c5aa0;
            border-radius: 15px;
            padding: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            z-index: 1000;
            text-align: center;
            min-width: 200px;
        }
        .timer-display {
            font-size: 40px;
            font-weight: bold;
            color: #2c5aa0;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
        }
        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
        }
        .timer-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
            font-size: 14px;
        }
        .start-btn {
            background: #28a745;
            color: white;
        }
        .start-btn:hover {
            background: #218838;
        }
        .stop-btn {
            background: #dc3545;
            color: white;
        }
        .stop-btn:hover {
            background: #c82333;
        }
        .reset-btn {
            background: #6c757d;
            color: white;
        }
        .reset-btn:hover {
            background: #5a6268;
        }
        .timer-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .timer-btn:disabled:hover {
            background: #6c757d;
        }
        .timer-status {
            font-size: 14px;
            font-weight: bold;
            margin-top: 10px;
            padding: 5px 10px;
            border-radius: 5px;
        }
        .status-running {
            background: #e3f2fd;
            color: #1976d2;
        }
        .status-warning {
            background: #fff3cd;
            color: #ff6f00;
        }
        .status-finished {
            background: #f8d7da;
            color: #721c24;
        }
        .timer-warning {
            animation: pulse-warning 2s infinite;
        }
        .timer-critical {
            animation: pulse-critical 1s infinite;
        }
        @keyframes pulse-warning {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes pulse-critical {
            0%, 100% { transform: scale(1); border-color: #dc3545; }
            50% { transform: scale(1.1); border-color: #ff0000; }
        }
        
        /* COLORATION POST-MINUTEUR */
        .criteria-zero-points {
            background-color: rgba(251, 234, 234, 0.6) !important;
        }
        .criteria-one-point {
            background-color: rgba(253, 245, 230, 0.6) !important;
        }
        .criteria-full-points {
            background-color: rgba(230, 244, 234, 0.6) !important;
        }
        .criteria-not-answered {
            background-color: rgba(240, 248, 255, 0.6) !important;
        }
        
        /* COLORATION COMMUNICATION */
        .communication-note-a {
            background-color: rgba(230, 244, 234, 0.6) !important;
        }
        .communication-note-b {
            background-color: rgba(233, 243, 253, 0.6) !important;
        }
        .communication-note-c {
            background-color: rgba(253, 245, 230, 0.6) !important;
        }
        .communication-note-d {
            background-color: rgba(252, 238, 227, 0.6) !important;
        }
        .communication-note-e {
            background-color: rgba(251, 234, 234, 0.6) !important;
        }
        .communication-not-answered {
            background-color: rgba(240, 248, 255, 0.6) !important;
        }
        
        /* MODE SELECTOR */
        .mode-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 2px solid #2c5aa0;
            border-radius: 30px;
            padding: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1001;
            display: flex;
            gap: 5px;
        }
        .mode-button {
            padding: 8px 16px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            background: transparent;
            color: #2c5aa0;
        }
        .mode-button.active {
            background: #2c5aa0;
            color: white;
        }
        .mode-button:hover:not(.active) {
            background: #e8f0fe;
        }
        
        /* Mode-specific hiding and showing - CORRIGÉ */
        .revision-mode .timer-container {
            display: none !important;
        }
        .exam-mode .timer-container {
            display: block !important;
        }
        .exam-mode .revision-controls {
            display: none !important;
        }
        /* Masquer les descriptions et titres d'annexes en mode examen quand le timer est actif */
        .exam-mode.timer-running .annexe-item .annexe-title,
        .exam-mode.timer-running .annexe-item .annexe-description {
            display: none !important;
        }
        
        /* Revision controls */
        .revision-controls {
            position: fixed;
            top: 70px;
            right: 20px;
            background: white;
            border: 2px solid #4CAF50;
            border-radius: 30px;
            padding: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            gap: 5px;
            z-index: 1000;
        }
        .lacune-button {
            background: transparent;
            color: #4CAF50;
            border: none;
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }
        .lacune-button:hover {
            background: #4CAF50;
            color: white;
        }
        .reset-revision-button {
            background: transparent;
            color: #6c757d;
            border: none;
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }
        .reset-revision-button:hover {
            background: #6c757d;
            color: white;
        }
        
        /* Styles pour les commentaires discrets */
        .comment-button { 
            background: none; 
            border: none; 
            color: #2c5aa0; 
            cursor: pointer; 
            font-size: 14px; 
            padding: 2px 6px; 
            margin-left: 8px; 
            border-radius: 3px; 
            opacity: 0.6;
            transition: all 0.2s;
        }
        .comment-button:hover { opacity: 1; background: rgba(44, 90, 160, 0.1); }
        .comment-button.has-content { opacity: 1; color: #d9534f; }
        .criterion-comment-section { 
            display: none; 
            margin: 8px 0 12px 20px; 
            padding: 10px; 
            background: #fafafa; 
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .criterion-comment-section.show { display: block; }
        .section-comment-button {
            background: rgba(44, 90, 160, 0.1);
            border: 1px solid #2c5aa0;
            color: #2c5aa0;
            cursor: pointer;
            font-size: 12px;
            padding: 4px 8px;
            margin-left: 10px;
            border-radius: 15px;
            opacity: 0.8;
            transition: all 0.2s;
            font-weight: 500;
        }
        .section-comment-button:hover { 
            opacity: 1; 
            background: rgba(44, 90, 160, 0.2); 
            transform: scale(1.05);
        }
        .section-comment-button.has-content { 
            background: rgba(220, 53, 69, 0.1);
            border-color: #d9534f;
            color: #d9534f; 
        }
        .section-comment-section { 
            display: none;
            margin: 20px 0; 
            padding: 12px; 
            background: #f8f9fa; 
            border-radius: 6px;
        }
        .section-comment-section.show { display: block; }
        .section-comment-section.global { 
            display: block; 
            background: #f0f8ff; 
        }
        /* La section commentaire global reste toujours visible sauf à l'impression */
        .comment-textarea { 
            width: calc(100% - 0px); 
            min-height: 26px; 
            padding: 5px; 
            margin-right: 0px;
            border: 1px solid #ddd; 
            border-radius: 3px; 
            font-family: Arial, sans-serif;
            font-size: 12px; 
            resize: vertical;
            box-sizing: border-box;
            overflow-y: hidden;
            color: #7b3f00;
            height: 26px;
        }
        .section-comment-section .comment-textarea {
            min-height: 28px;
            font-size: 14px;
            height: 28px;
        }
        .section-comment-section.global .comment-textarea {
            min-height: 30px;
            font-size: 16px;
            height: 30px;
        }
        .comment-textarea:focus {
            outline: none;
            border-color: #2c5aa0;
            box-shadow: 0 0 0 2px rgba(44, 90, 160, 0.1);
        }
        
        /* Masquer les boutons à l'impression */
        @media print {
            .comment-button,
            .section-comment-button {
                display: none !important;
            }
            .criterion-comment-section:not(.has-content),
            .section-comment-section:not(.has-content) {
                display: none !important;
            }
            .criterion-comment-section.has-content,
            .section-comment-section.has-content {
                display: block !important;
                page-break-inside: avoid;
            }
        }
        
        /* Styles pour les lacunes */
        .lacune-rouge {
            background-color: #ffebee !important;
        }
        .lacune-orange {
            background-color: #fff3e0 !important;
        }
        .lacune-verte {
            background-color: #e8f5e8 !important;
        }
        
        /* Bouton d'impression */
        .print-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2c5aa0;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 4px 12px rgba(44, 90, 160, 0.3);
            z-index: 1000;
        }
        .print-button:hover {
            background: #1e3f70;
        }
        @media print {
            /* Masquer les éléments interactifs */
            .print-button, .mode-selector, .revision-controls, .missing-items { display: none !important; }
            .comment-button, .section-comment-button { display: none !important; }
            /* IMPORTANT: MASQUER LE MINUTEUR à L'IMPRESSION! */
            .timer-container {
                display: none !important;
                visibility: hidden !important;
                position: absolute !important;
                left: -9999px !important;
            }
            /* Supprimer les bordures gauches à l'impression */
            .criteria-row { border-left: none !important; }
            .communication-section { border-left: none !important; }
            .lacune-rouge { border-left: none !important; }
            .lacune-orange { border-left: none !important; }
            .lacune-verte { border-left: none !important; }
            
            /* Gestion des commentaires à l'impression */
            .criterion-comment-section:not(.has-content),
            .section-comment-section:not(.has-content) { display: none !important; }
            .section-comment-section.global:not(.has-content) { display: none !important; }
            .criterion-comment-section.has-content,
            .section-comment-section.has-content { display: block !important; }
            
            /* Les textareas conservent leur hauteur actuelle à l'impression */
            .comment-textarea {
                border: 1px solid #ccc !important;
                background: white !important;
                padding: 4px !important;
                margin-right: 15px !important;
                resize: none !important;
                font-size: 8pt !important;
                font-family: Arial, sans-serif !important;
                font-style: italic !important;
                color: #333 !important;
                border-radius: 2px !important;
                /* Conserver la hauteur actuelle */
                overflow: hidden !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            /* Sections commentaires */
            .criterion-comment-section {
                page-break-inside: avoid;
                margin: 6px 0 8px 15px !important;
                padding: 6px 8px !important;
                background: #f9f9f9 !important;
                border-left: 2px solid #666 !important;
                border-radius: 0 3px 3px 0 !important;
                box-shadow: none !important;
            }
            
            /* Cacher les sections de commentaires vides */
            .criterion-comment-section:not(.show) {
                display: none !important;
            }
            .criterion-comment-section.show:not(.has-content) {
                display: none !important;
            }
            
            .section-comment-section {
                page-break-inside: avoid;
                margin: 5px 0 10px 0 !important;
                padding: 6px 8px !important;
                background: #f5f5f5 !important;
                border: 1px solid #ccc !important;
                border-radius: 4px !important;
            }
            
            /* Cacher toutes les sections de commentaires vides à l'impression */
            .section-comment-section {
                display: none !important;
            }
            /* Montrer seulement les sections avec contenu */
            .section-comment-section.has-content {
                display: block !important;
            }
            
            /* Configuration de la page */
            @page { size: A4; margin: 10mm 9mm 10mm 10mm; }
            body { margin: 0; background: white !important; font-size: 9pt; }
            
            /* Optimisation du container et des marges */
            .container { 
                max-width: 100%; 
                margin: 0; 
                box-shadow: none; 
                padding: 0; 
                background: white !important;
            }
            
            /* Gestion du header pour qu'il ne soit jamais seul */
            .header { 
                page-break-after: avoid; 
                margin: 0;
                margin-bottom: 10px;
                padding: 10px;
                font-size: 8pt;
            }
            .header h1 { font-size: 14pt; margin: 0 0 5px 0; }
            
            /* Optimisation des signes vitaux */
            .vital-signs { gap: 10px; margin: 5px 0; }
            .vital-sign { padding: 5px; font-size: 8pt; }
            
            /* Forcer l'anamnèse à commencer sur la page 1 */
            .section:first-of-type { page-break-before: avoid !important; }
            .section:first-of-type .section-header { 
                page-break-after: avoid; 
                min-height: 20px;
            }
            .section:first-of-type .criteria-row:first-child { 
                page-break-before: avoid !important; 
            }
            
            /* Les autres sections peuvent se diviser si nécessaire */
            .section { 
                page-break-inside: auto; 
                margin-bottom: 15px;
            }
            .section-header { 
                page-break-after: avoid;
                font-size: 12pt;
                padding: 8px;
            }
            .section-content { padding: 8px; }
            
            /* Optimisation de la grille */
            .header-row { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px; 
                font-size: 8pt;
            }
            .header-row.communication-header { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px 60px; 
                padding: 5px 0;
            }
            .criteria-row { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px; 
                page-break-inside: avoid;
                padding: 8px 0 8px 5px;
            }
            .criteria-text { font-size: 8.5pt; line-height: 1.1 !important; }
            .sub-criteria { font-size: 7.5pt; padding-left: 15px; line-height: 1.1 !important; }
            .detail-row { font-size: 7.5pt; padding: 1px 0 1px 15px; line-height: 1.0; }
            .detail-text { font-size: 7.5pt; line-height: 1.1 !important; }
            .patient-response { font-size: 7.5pt; }
            .points-display { font-size: 14px; }
            
            /* Communication section */
            .communication-section-container {
                page-break-inside: avoid !important;
            }
            
            /* Cloture section */
            .cloture-section {
                page-break-inside: avoid !important;
            }
            .cloture-item {
                page-break-inside: avoid !important;
                margin-bottom: 10px;
                padding: 10px;
            }
            .cloture-title { font-size: 10pt; }
            .cloture-content { font-size: 8.5pt; line-height: 1.2 !important; }
            .communication-section { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px 60px;
                padding: 8px 0;
            }
            .communication-text { font-size: 8.5pt; }
            .communication-desc { font-size: 7pt; }
            
            /* Optimisation des sections spéciales */
            .dd-section { padding: 8px; margin: 0 0 5px 0; font-size: 8pt; }
            .dd-title { font-size: 9pt; }
            .dd-item { font-size: 8pt; margin-left: 15px; }
            
            .therapy-section { 
                padding: 8px; 
                margin: 0; 
                font-size: 8pt;
                background: rgba(255, 250, 230, 0.3) !important;
                color: #000 !important;
            }
            .therapy-title { font-size: 9pt; }
            
            .redflags-section { padding: 8px; margin: 5px 0; }
            .redflags-title { font-size: 9pt; }
            .redflags-text { font-size: 8.5pt; }
            .redflags-description { font-size: 7.5pt; }
            
            /* Optimisation des totaux */
            .total-sections { 
                gap: 6px;
                margin-bottom: 6px;
            }
            .total-label { 
                padding: 4px;
                font-size: 16px;
                border-radius: 8px 8px 0 0;
            }
            .total-body {
                padding: 3px;
                border-radius: 0 0 8px 8px;
            }
            .total-score,
            .total-note-globale {
                font-size: 32px;
            }
            .total-pourcent-body {
                padding: 6px;
                border-radius: 0 0 8px 8px;
            }
            .total-pourcent-sections {
                display: flex;
                flex-wrap: nowrap;
                gap: 4px;
                align-items: stretch;
            }
            .total-pourcent-section {
                flex: 0 0 auto;
                min-width: 60px;
                padding: 6px 8px;
                white-space: nowrap;
            }
            .total-section-label {
                font-size: 11px;
                margin-bottom: 3px;
                white-space: nowrap;
            }
            .total-pourcent-value {
                font-size: 20px;
            }
            .pourcent-body {
                padding: 2px 0;
            }
            
            /* Échelle de notation */
            .grade-scale { 
                padding: 10px; 
                margin-top: 15px;
                page-break-inside: avoid;
            }
            .grade-scale h3 { font-size: 11pt; margin: 0 0 5px 0; }
            .grade-row { padding: 3px 0; font-size: 8pt; }
            
            /* Optimisations pour les annexes à l'impression */
            .annexes { 
                page-break-before: always !important;
                margin-top: 0 !important;
                padding-top: 15px !important;
            }
            
            .annexes-grid { 
                display: grid !important; 
                grid-template-columns: repeat(2, 1fr) !important; 
                gap: 15px !important; 
                margin-top: 15px !important; 
            }
            
            .annexe-item { 
                page-break-inside: avoid !important;
                padding: 15px !important;
                border: 1px solid #ddd !important;
            }
            
            .annexe-title { 
                font-size: 10pt !important;
                margin-bottom: 5px !important;
            }
            
            .annexe-description { 
                font-size: 8pt !important;
                line-height: 1.3 !important;
                margin-bottom: 8px !important;
            }
            
            /* Réduire l'interligne des detail-row */
            .detail-row { 
                line-height: 1.1 !important; 
                padding: 2px 0 2px 15px !important;
            }
            
            /* Réduire et ajuster les checkboxes des détails */
            .detail-checkboxes { 
                text-align: right !important;
                padding-right: 5px !important;
            }
            .detail-checkbox input[type="checkbox"] { 
                transform: scale(0.8) !important;
                margin: 0 !important;
            }
            
            /* Page-break pour DD section et théorie pratique */
            .annexe-dd-section,
            .annexe-theorie-pratique { 
                page-break-before: always !important; 
            }
            
            /* Pas de page-break dans les scenario-section */
            .scenario-section, 
            .scenario-subsection { 
                page-break-inside: avoid !important; 
            }
            
            /* Réduire l'interligne dans toutes les annexes */
            .annexe-scenario-content,
            .annexe-interventions-content,
            .annexe-informations-content,
            .annexe-theorie-content { 
                line-height: 1.15 !important; 
            }
            
            /* Styles spécifiques pour les sections du scénario */
            .scenario-section {
                margin-bottom: 8px !important;
                padding: 4px !important;
            }
            
            .scenario-section h4 {
                font-size: 9.5pt !important;
                margin: 0 0 4px 0 !important;
                line-height: 1.1 !important;
                color: #2c5aa0 !important;
            }
            
            .scenario-subsection {
                margin-bottom: 4px !important;
                line-height: 1.1 !important;
            }
            
            .scenario-subsection strong {
                font-size: 8pt !important;
                color: #333 !important;
            }
            
            /* Listes dans les annexes */
            .annexe-scenario-content ul,
            .annexe-interventions-content ul,
            .annexe-informations-content ul,
            .annexe-theorie-content ul,
            .scenario-section ul,
            .scenario-subsection ul {
                margin: 2px 0 !important;
                padding-left: 16px !important;
            }
            
            .annexe-scenario-content li,
            .annexe-interventions-content li,
            .annexe-informations-content li,
            .annexe-theorie-content li,
            .scenario-section li,
            .scenario-subsection li {
                margin-bottom: 1px !important;
                line-height: 1.1 !important;
                font-size: 7.5pt !important;
            }
            
            /* Texte dans les sections */
            .scenario-section p,
            .scenario-subsection p {
                margin: 2px 0 !important;
                line-height: 1.1 !important;
                font-size: 7.5pt !important;
            }
            
            /* Info de base du patient */
            .scenario-info {
                font-size: 8pt !important;
                padding: 6px !important;
                margin-bottom: 8px !important;
                line-height: 1.2 !important;
            }
            
            /* Forcer les couleurs */
            * { 
                -webkit-print-color-adjust: exact !important; 
                print-color-adjust: exact !important; 
            }
            
            /* Fond blanc partout */
            body, .container, .section, .section-content { background: white !important; }
            
        }
    </style>
</head>
<body class="revision-mode">
    <!-- MODE SELECTOR -->
    <div class="mode-selector">
        <button class="mode-button active" onclick="switchMode('revision')">🔍 Révision</button>
        <button class="mode-button" onclick="switchMode('exam')">📝 Examen</button>
    </div>
    
    <!-- BOUTONS RÉVISION (Mode Révision uniquement) -->
    <div class="revision-controls">
        <button class="lacune-button" onclick="identifyLacunes()">🎯 Identifier les lacunes</button>
        <button class="reset-revision-button" onclick="resetTimer()">↻ Reset</button>
    </div>
    
    <!-- MINUTEUR ECOS -->
    <div class="timer-container" id="timerContainer">
        <div class="timer-display" id="timerDisplay">13:00</div>
        <div class="timer-controls">
            <button id="startBtn" class="timer-btn start-btn" onclick="startTimer()">▶ Démarrer</button>
            <button id="stopBtn" class="timer-btn stop-btn" onclick="stopTimer()" style="display: none;">⏸ Arrêter</button>
            <button id="resetBtn" class="timer-btn reset-btn" onclick="resetTimer()">↻ Reset</button>
        </div>
        <div class="timer-status" id="timerStatus" style="display: none;"></div>
    </div>

    <div class="container">
        <div class="header">
            <h1>Grille d'évaluation ECOS - USMLE Triage 3 - Troubles de Mémoire</h1>
            <p style="margin: 5px 0;">📍 Cabinet médical</p>
            <p style="margin: 5px 0;">👤 Jack Plaster, un homme de 78 ans, se présente avec des plaintes de perte de mémoire. Son épouse l'accompagne.</p>
            <div class="vital-signs">
                <div class="vital-sign">
                    <div class="vital-sign-label">TA</div>
                    <div class="vital-sign-value">128/88 mmHg</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">FC</div>
                    <div class="vital-sign-value">72 bpm</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">FR</div>
                    <div class="vital-sign-value">12/min</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">T°</div>
                    <div class="vital-sign-value">37.0°C</div>
                </div>
            </div>
        </div>
        <!-- ANAMNÈSE -->
        <div class="section">
            <div class="section-header">
                <span>Anamnèse (25%)</span>
                <span class="score">Score : <span id="anamneseScore">0</span>/57</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Critères</div>
                    <div>Oui</div>
                    <div>±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row" id="criteria-a1">
    <div>
        <div class="criteria-text">1. Introduction et approche empathique (nom, fonction et questions ouvertes) <button class="comment-button" onclick="toggleComment('a1')" title="Ajouter un commentaire">📝</button></div>
<div class="exemples-phrases"><div class="exemple-phrase">"Bonjour M. et Mme Plaster, je suis le Dr Jenson."</div><div class="exemple-phrase">"Je comprends que vous avez eu des problèmes de mémoire, M. Plaster. Veuillez m'en dire plus à ce sujet."</div></div>        <div class="criterion-comment-section" id="comment-section-a1">
            <textarea class="comment-textarea" id="comment-a1" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a1'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a1" value="2" data-criteria="Introduction et approche empathique (nom, fonction et questions ouvertes)" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a1" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a1">0</div>
</div>
<div class="criteria-row" id="criteria-a2">
    <div>
        <div class="criteria-text">2. Exploration des troubles mnésiques <button class="comment-button" onclick="toggleComment('a2')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Problèmes de mémoire <span class="patient-response">[depuis longtemps, aggravation récente]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-0" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Oubli des lieux familiers <span class="patient-response">[se perd, ne connaît plus les endroits]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-1" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Questions répétitives <span class="patient-response">[pose des questions dont il connaissait la réponse]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-2" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Oubli des noms <span class="patient-response">[chat qu'il a nommé, petite-fille Emily]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-3" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Désorientation spatiale <span class="patient-response">[perdu à un pâté de maisons de chez lui]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-4" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Bill, que pensez-vous de ce que votre femme vient de dire ?"</div><div class="exemple-phrase">"Vous perdez-vous souvent et avez-vous l'impression de ne pas savoir où vous êtes ?"</div><div class="exemple-phrase">"Qu'en est-il de poser à votre femme des questions dont vous pensez avoir connu la réponse ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a2">
            <textarea class="comment-textarea" id="comment-a2" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a2'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a2">0</div>
</div>
<div class="criteria-row" id="criteria-a3">
    <div>
        <div class="criteria-text">3. Troubles de la marche et équilibre <button class="comment-button" onclick="toggleComment('a3')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Instabilité à la marche <span class="patient-response">[depuis quelques semaines]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-0" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Besoin de se tenir aux objets <span class="patient-response">[dans la maison]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-1" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Sensation d'instabilité <span class="patient-response">[pourrait tomber]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-2" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Pas de vertiges <span class="patient-response">[non, juste instable]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-3" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Antécédent de chute <span class="patient-response">[il y a 1 an sur la glace]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-4" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"M. Plaster, pouvez-vous me parler du besoin de vous tenir aux choses quand vous marchez ?"</div><div class="exemple-phrase">"Avez-vous des vertiges ?"</div><div class="exemple-phrase">"Êtes-vous déjà tombé ?"</div><div class="exemple-phrase">"Qu'en est-il récemment ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a3">
            <textarea class="comment-textarea" id="comment-a3" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a3'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a3">0</div>
</div>
<div class="criteria-row" id="criteria-a4">
    <div>
        <div class="criteria-text">4. Évolution temporelle et impact <button class="comment-button" onclick="toggleComment('a4')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Durée des troubles mnésiques <span class="patient-response">[quelques années, accumulation progressive]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-0" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Aggravation récente <span class="patient-response">[derniers mois pour l'orientation]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-1" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Impact sur la conduite <span class="patient-response">[épouse conduit maintenant]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-2" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Reconnaissance des voisins <span class="patient-response">[parfois non familiers]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-3" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Préservation de l'identité familiale <span class="patient-response">[n'oublie pas le nom de sa femme]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-4" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Depuis combien de temps a-t-il des problèmes de mémoire ?"</div><div class="exemple-phrase">"A-t-il déjà oublié votre nom ou le nom de ses enfants ?"</div><div class="exemple-phrase">"Est-ce le genre de chose qu'il vous est facile d'oublier ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a4">
            <textarea class="comment-textarea" id="comment-a4" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a4'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a4">0</div>
</div>
<div class="criteria-row" id="criteria-a5">
    <div>
        <div class="criteria-text">5. Médicaments et changements récents <button class="comment-button" onclick="toggleComment('a5')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Nouveaux médicaments <span class="patient-response">[non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-0" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Médicaments actuels <span class="patient-response">[aténolol, lisinopril, lovastatine, tamsulosine, glyburide]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-1" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Gestion par l'épouse <span class="patient-response">[toujours organisé ses médicaments]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-2" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Observance <span class="patient-response">[routine quotidienne respectée]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-3" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Avez-vous commencé de nouveaux médicaments depuis que ces symptômes ont commencé ?"</div><div class="exemple-phrase">"Quels médicaments prenez-vous ?"</div><div class="exemple-phrase">"Est-ce un changement que vous organisiez ses médicaments, ou cela a-t-il toujours été le cas ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a5">
            <textarea class="comment-textarea" id="comment-a5" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a5'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a5">0</div>
</div>
<div class="criteria-row" id="criteria-a6">
    <div>
        <div class="criteria-text">6. Symptômes neurologiques associés <button class="comment-button" onclick="toggleComment('a6')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Force musculaire <span class="patient-response">[normale, peut bouger très bien]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-0" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Sensibilité <span class="patient-response">[normale, teste avec filament chez médecin]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-1" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Perte de connaissance <span class="patient-response">[non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-2" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Vision <span class="patient-response">[pas de nouveaux problèmes]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-3" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Parole et langage <span class="patient-response">[non évalué spécifiquement]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-4" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Avez-vous eu des problèmes pour bouger vos bras ou vos jambes récemment ?"</div><div class="exemple-phrase">"Qu'en est-il de la sensation ? Avez-vous des engourdissements ou des sensations inhabituelles dans votre corps ?"</div><div class="exemple-phrase">"Perdez-vous parfois connaissance sans le vouloir ?"</div><div class="exemple-phrase">"Avez-vous de nouveaux problèmes de vision ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a6">
            <textarea class="comment-textarea" id="comment-a6" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a6'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a6">0</div>
</div>
<div class="criteria-row" id="criteria-a7">
    <div>
        <div class="criteria-text">7. Symptômes cardiovasculaires <button class="comment-button" onclick="toggleComment('a7')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Douleur thoracique <span class="patient-response">[non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a7-detail-0" value="1" onchange="updateDetailScore('a7', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Dyspnée <span class="patient-response">[non, jamais eu]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a7-detail-1" value="1" onchange="updateDetailScore('a7', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Claudication <span class="patient-response">[non, pas de douleur aux jambes]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a7-detail-2" value="1" onchange="updateDetailScore('a7', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Qu'en est-il de la douleur thoracique ?"</div><div class="exemple-phrase">"Avez-vous des difficultés respiratoires ?"</div><div class="exemple-phrase">"Avez-vous parfois des douleurs dans vos pieds ou vos jambes ? Surtout en marchant ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a7">
            <textarea class="comment-textarea" id="comment-a7" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a7'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a7">0</div>
</div>
<div class="criteria-row" id="criteria-a8">
    <div>
        <div class="criteria-text">8. Symptômes digestifs et nutritionnels <button class="comment-button" onclick="toggleComment('a8')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Appétit <span class="patient-response">[mange comme un cheval]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a8-detail-0" value="1" onchange="updateDetailScore('a8', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Douleur abdominale <span class="patient-response">[non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a8-detail-1" value="1" onchange="updateDetailScore('a8', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Transit intestinal <span class="patient-response">[régulier, mange des fruits]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a8-detail-2" value="1" onchange="updateDetailScore('a8', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Perte de poids <span class="patient-response">[non mentionnée]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a8-detail-3" value="1" onchange="updateDetailScore('a8', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Avez-vous parfois des douleurs abdominales ou des difficultés à manger ?"</div><div class="exemple-phrase">"Des problèmes pour aller aux toilettes ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a8">
            <textarea class="comment-textarea" id="comment-a8" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a8'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a8">0</div>
</div>
<div class="criteria-row" id="criteria-a9">
    <div>
        <div class="criteria-text">9. Symptômes urinaires <button class="comment-button" onclick="toggleComment('a9')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Incontinence urinaire <span class="patient-response">[oui, quelques fuites]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-0" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Type d'incontinence <span class="patient-response">[pas de sensation du besoin]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-1" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Circonstances <span class="patient-response">[assis devant TV, humidité sans urgence]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-2" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Dysurie <span class="patient-response">[non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-3" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Difficulté mictionnelle <span class="patient-response">[contrôlée par tamsulosine]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-4" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Qu'en est-il d'uriner ? Des problèmes pour arriver aux toilettes à temps ?"</div><div class="exemple-phrase">"Est-ce parce que vous n'êtes pas arrivé aux toilettes à temps ou parce que vous ne sentiez pas que vous en aviez besoin ?"</div><div class="exemple-phrase">"Qu'en est-il de commencer un jet d'urine ? Est-ce difficile ?"</div><div class="exemple-phrase">"Avez-vous l'impression que vous devez vous dépêcher ou vous perdrez le contrôle ?"</div><div class="exemple-phrase">"Qu'en est-il des brûlures quand vous urinez ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a9">
            <textarea class="comment-textarea" id="comment-a9" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a9'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a9">0</div>
</div>
<div class="criteria-row" id="criteria-a10">
    <div>
        <div class="criteria-text">10. Symptômes généraux <button class="comment-button" onclick="toggleComment('a10')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Fièvre <span class="patient-response">[non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a10-detail-0" value="1" onchange="updateDetailScore('a10', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Autres symptômes récents <span class="patient-response">[non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a10-detail-1" value="1" onchange="updateDetailScore('a10', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"De la fièvre récemment ?"</div><div class="exemple-phrase">"Y a-t-il d'autres symptômes récemment dont vous aimeriez discuter ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a10">
            <textarea class="comment-textarea" id="comment-a10" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a10'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a10">0</div>
</div>
<div class="criteria-row" id="criteria-a11">
    <div>
        <div class="criteria-text">11. Antécédents médicaux <button class="comment-button" onclick="toggleComment('a11')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Hypertension artérielle <span class="patient-response">[oui]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a11-detail-0" value="1" onchange="updateDetailScore('a11', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Hypercholestérolémie <span class="patient-response">[oui]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a11-detail-1" value="1" onchange="updateDetailScore('a11', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Diabète <span class="patient-response">[type 2]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a11-detail-2" value="1" onchange="updateDetailScore('a11', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">HBP (hypertrophie bénigne de la prostate) <span class="patient-response">[oui]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a11-detail-3" value="1" onchange="updateDetailScore('a11', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Cors aux pieds <span class="patient-response">[opérés]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a11-detail-4" value="1" onchange="updateDetailScore('a11', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Je connais vos médicaments, pouvez-vous me parler de vos problèmes médicaux ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a11">
            <textarea class="comment-textarea" id="comment-a11" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a11'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a11">0</div>
</div>
<div class="criteria-row" id="criteria-a12">
    <div>
        <div class="criteria-text">12. Antécédents chirurgicaux <button class="comment-button" onclick="toggleComment('a12')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Chirurgie des cors aux pieds <span class="patient-response">[oui]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a12-detail-0" value="1" onchange="updateDetailScore('a12', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Blessure par balle à la guerre <span class="patient-response">[fracture de jambe, chirurgie]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a12-detail-1" value="1" onchange="updateDetailScore('a12', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Autres chirurgies <span class="patient-response">[non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a12-detail-2" value="1" onchange="updateDetailScore('a12', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Avez-vous eu d'autres opérations ?"</div><div class="exemple-phrase">"Vous en souvenez-vous M. Plaster ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a12">
            <textarea class="comment-textarea" id="comment-a12" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a12'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a12">0</div>
</div>
<div class="criteria-row" id="criteria-a13">
    <div>
        <div class="criteria-text">13. Habitudes de vie <button class="comment-button" onclick="toggleComment('a13')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Tabac <span class="patient-response">[jamais fumé]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a13-detail-0" value="1" onchange="updateDetailScore('a13', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Alcool <span class="patient-response">[rare maintenant, abstinent depuis 30 ans]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a13-detail-1" value="1" onchange="updateDetailScore('a13', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Profession antérieure <span class="patient-response">[facteur postal pendant 28 ans]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a13-detail-2" value="1" onchange="updateDetailScore('a13', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Fumez-vous ou avez-vous déjà fumé ?"</div><div class="exemple-phrase">"Qu'en est-il de l'alcool ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a13">
            <textarea class="comment-textarea" id="comment-a13" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a13'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a13">0</div>
</div>
<div class="criteria-row" id="criteria-a14">
    <div>
        <div class="criteria-text">14. Histoire familiale <button class="comment-button" onclick="toggleComment('a14')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Enfants <span class="patient-response">[fils à la faculté de droit, fille avec 3 filles]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a14-detail-0" value="1" onchange="updateDetailScore('a14', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Maladies familiales de mémoire <span class="patient-response">[non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a14-detail-1" value="1" onchange="updateDetailScore('a14', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Santé des enfants <span class="patient-response">[en bonne santé]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a14-detail-2" value="1" onchange="updateDetailScore('a14', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Y a-t-il d'autres maladies dans votre famille ?"</div><div class="exemple-phrase">"Y a-t-il eu des maladies causant des problèmes de mémoire chez vos parents ou d'autres membres de la famille ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a14">
            <textarea class="comment-textarea" id="comment-a14" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a14'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a14">0</div>
</div>
<div class="criteria-row" id="criteria-a15">
    <div>
        <div class="criteria-text">15. Inquiétudes et questions de l'épouse <button class="comment-button" onclick="toggleComment('a15')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Préoccupation principale <span class="patient-response">[maladie d'Alzheimer ?]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a15-detail-0" value="1" onchange="updateDetailScore('a15', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Observations de l'épouse <span class="patient-response">[questions sur la banque, nom du chat]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a15-detail-1" value="1" onchange="updateDetailScore('a15', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Rôle d'aidante <span class="patient-response">[gère médicaments, conduit]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a15-detail-2" value="1" onchange="updateDetailScore('a15', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Pensez-vous que c'est quelque chose comme la maladie d'Alzheimer ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a15">
            <textarea class="comment-textarea" id="comment-a15" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('a15'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a15">0</div>
</div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('anamnese')" title="Commentaire sur cette section">📝 Commentaire sur la section Anamnèse</button>
                </div>
                <div class="section-comment-section" id="section-comment-anamnese">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur l'anamnèse</h4>
                    <textarea class="comment-textarea" id="comment-section-anamnese" placeholder="Commentaire sur la section anamnèse..." oninput="updateSectionComment('anamnese'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- EXAMEN CLINIQUE -->
        <div class="section">
            <div class="section-header">
                <span>Examen clinique (25%)</span>
                <span class="score">Score : <span id="statusScore">0</span>/32</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Critères</div>
                    <div>Oui</div>
                    <div>±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row" id="criteria-e1">
    <div>
        <div class="criteria-text">1. Préparation à l'examen <button class="comment-button" onclick="toggleComment('e1')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Se laver les mains</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e1-detail-0" value="1" onchange="updateDetailScore('e1', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Expliquer l'examen au patient</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e1-detail-1" value="1" onchange="updateDetailScore('e1', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Commenter les signes vitaux</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e1-detail-2" value="1" onchange="updateDetailScore('e1', 'e')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"D'accord. J'aimerais faire un examen physique maintenant, si cela ne vous dérange pas."</div><div class="exemple-phrase">"Laissez-moi juste me laver les mains."</div><div class="exemple-phrase">"Il semble que vos signes vitaux soient normaux, alors permettez-moi d'abord de regarder dans vos oreilles..."</div></div>        <div class="criterion-comment-section" id="comment-section-e1">
            <textarea class="comment-textarea" id="comment-e1" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e1'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e1">0</div>
</div>
<div class="criteria-row" id="criteria-e2">
    <div>
        <div class="criteria-text">2. Examen ORL <button class="comment-button" onclick="toggleComment('e2')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Otoscopie bilatérale <span class="patient-response">[membranes tympaniques nacrées grises]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-0" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Test de mobilité tympanique <span class="patient-response">[normale]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-1" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Sensibilité mastoïdienne <span class="patient-response">[absente]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-2" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Réflexes pupillaires <span class="patient-response">[PERRLA]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-3" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Mouvements oculaires <span class="patient-response">[intacts]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-4" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Avez-vous des douleurs dans vos oreilles ?"</div></div>        <div class="criterion-comment-section" id="comment-section-e2">
            <textarea class="comment-textarea" id="comment-e2" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e2'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e2">0</div>
</div>
<div class="criteria-row" id="criteria-e3">
    <div>
        <div class="criteria-text">3. Examen neurologique - Nerfs crâniens <button class="comment-button" onclick="toggleComment('e3')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Nerfs crâniens II-XII <span class="patient-response">[intacts]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e3-detail-0" value="1" onchange="updateDetailScore('e3', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Vision et champs visuels <span class="patient-response">[à évaluer]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e3-detail-1" value="1" onchange="updateDetailScore('e3', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Mouvements oculaires <span class="patient-response">[normaux]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e3-detail-2" value="1" onchange="updateDetailScore('e3', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Fonction faciale <span class="patient-response">[symétrique]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e3-detail-3" value="1" onchange="updateDetailScore('e3', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e3">
            <textarea class="comment-textarea" id="comment-e3" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e3'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e3">0</div>
</div>
<div class="criteria-row" id="criteria-e4">
    <div>
        <div class="criteria-text">4. Examen neurologique - Sensibilité <button class="comment-button" onclick="toggleComment('e4')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Sensation tactile des extrémités <span class="patient-response">[normale]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-0" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Test au monofilament <span class="patient-response">[négatif]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-1" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Test piqué/mousse <span class="patient-response">[normal]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-2" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Proprioception digitale <span class="patient-response">[intacte]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-3" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e4">
            <textarea class="comment-textarea" id="comment-e4" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e4'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e4">0</div>
</div>
<div class="criteria-row" id="criteria-e5">
    <div>
        <div class="criteria-text">5. Examen neurologique - Motricité <button class="comment-button" onclick="toggleComment('e5')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Force musculaire <span class="patient-response">[5/5 symétrique]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e5-detail-0" value="1" onchange="updateDetailScore('e5', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Réflexes ostéotendineux <span class="patient-response">[2+ symétriques]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e5-detail-1" value="1" onchange="updateDetailScore('e5', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Signe de Babinski <span class="patient-response">[flexion plantaire]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e5-detail-2" value="1" onchange="updateDetailScore('e5', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Clonus de la cheville <span class="patient-response">[un battement]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e5-detail-3" value="1" onchange="updateDetailScore('e5', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Pas de tremblement</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e5-detail-4" value="1" onchange="updateDetailScore('e5', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e5">
            <textarea class="comment-textarea" id="comment-e5" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e5'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e5">0</div>
</div>
<div class="criteria-row" id="criteria-e6">
    <div>
        <div class="criteria-text">6. Examen neurologique - Coordination <button class="comment-button" onclick="toggleComment('e6')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Diadococinésie <span class="patient-response">[normale]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e6-detail-0" value="1" onchange="updateDetailScore('e6', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Doigt-nez <span class="patient-response">[normal]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e6-detail-1" value="1" onchange="updateDetailScore('e6', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Talon-tibia <span class="patient-response">[normal]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e6-detail-2" value="1" onchange="updateDetailScore('e6', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e6">
            <textarea class="comment-textarea" id="comment-e6" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e6'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e6">0</div>
</div>
<div class="criteria-row" id="criteria-e7">
    <div>
        <div class="criteria-text">7. Examen de la marche et équilibre <button class="comment-button" onclick="toggleComment('e7')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Démarche spontanée <span class="patient-response">[instable, base large]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-0" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Marche sur les talons <span class="patient-response">[incapable]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-1" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Marche sur la pointe des pieds <span class="patient-response">[incapable]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-2" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Test de Romberg <span class="patient-response">[négatif]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-3" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Sécurité du patient <span class="patient-response">[prêt à rattraper si chute]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e7-detail-4" value="1" onchange="updateDetailScore('e7', 'e')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Quand vous fermez les yeux, avez-vous l'impression que vous pourriez tomber ?"</div></div>        <div class="criterion-comment-section" id="comment-section-e7">
            <textarea class="comment-textarea" id="comment-e7" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e7'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e7">0</div>
</div>
<div class="criteria-row" id="criteria-e8">
    <div>
        <div class="criteria-text">8. Examen cardiovasculaire <button class="comment-button" onclick="toggleComment('e8')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Auscultation cardiaque 4 foyers <span class="patient-response">[rythme régulier, pas de souffle]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e8-detail-0" value="1" onchange="updateDetailScore('e8', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Souffles carotidiens <span class="patient-response">[absents]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e8-detail-1" value="1" onchange="updateDetailScore('e8', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Pouls périphériques <span class="patient-response">[2+ symétriques]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e8-detail-2" value="1" onchange="updateDetailScore('e8', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e8">
            <textarea class="comment-textarea" id="comment-e8" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('e8'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e8">0</div>
</div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('examen')" title="Commentaire sur cette section">📝 Commentaire sur la section Examen</button>
                </div>
                <div class="section-comment-section" id="section-comment-examen">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur l'examen clinique</h4>
                    <textarea class="comment-textarea" id="comment-section-examen" placeholder="Commentaire sur la section examen clinique..." oninput="updateSectionComment('examen'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- MANAGEMENT -->
        <div class="section">
            <div class="section-header">
                <span>Management (25%)</span>
                <span class="score">Score : <span id="managementScore">0</span>/20</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Critères</div>
                    <div>Oui</div>
                    <div>±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row" id="criteria-m1">
    <div>
        <div class="criteria-text">1. Diagnostics différentiels <button class="comment-button" onclick="toggleComment('m1')" title="Ajouter un commentaire">📝</button></div>
        <div class="criterion-comment-section" id="comment-section-m1">
            <textarea class="comment-textarea" id="comment-m1" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('m1'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="2" data-criteria="Diagnostics différentiels" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="1" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="0" onchange="updateScore('m', this)" />
    </div>
    <div class="points-display" id="points-m1">0</div>
</div>
<div class="dd-section">
    <div class="dd-title">Diagnostics différentiels des troubles cognitifs avec troubles de la marche</div>
    <div class="dd-category">Causes potentiellement réversibles</div>
    <div class="dd-item">• Hydrocéphalie à pression normale <span class="dd-test">→ IRM cérébrale (dilatation ventriculaire), ponction lombaire soustractive</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;□ Triade classique : troubles cognitifs + troubles de la marche + incontinence urinaire<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Démarche instable à base large<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Incontinence sans urgence mictionnelle<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Progression sur plusieurs mois<br><strong>Arguments CONTRE:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;□ Pas de description typique de marche magnétique</div>
    <div class="dd-item">• Syndrome confusionnel (infection occulte) <span class="dd-test">→ NFS, CRP, ECBU, radiographie thoracique</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;□ Âge avancé<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Diabétique (risque infectieux accru)<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Changement récent du statut mental<br><strong>Arguments CONTRE:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;□ Pas de fièvre<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Évolution progressive sur des mois<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Pas de fluctuation de la conscience</div>
    <div class="dd-category">Démences neurodégénératives</div>
    <div class="dd-item">• Maladie d'Alzheimer <span class="dd-test">→ IRM cérébrale (atrophie hippocampique), bilan neuropsychologique</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;□ Troubles mnésiques progressifs<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Désorientation spatiale<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Oubli des noms propres<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Âge approprié<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Évolution insidieuse<br><strong>Arguments CONTRE:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;□ Troubles de la marche précoces inhabituels<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Incontinence précoce</div>
    <div class="dd-item">• Maladie de Parkinson avec démence <span class="dd-test">→ Examen neurologique spécialisé, DaTscan si doute</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;□ Troubles de la marche<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Instabilité posturale<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Troubles cognitifs<br><strong>Arguments CONTRE:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;□ Pas de tremblement de repos<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Pas de bradykinésie décrite<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Pas de rigidité</div>
    <div class="dd-category">Causes vasculaires</div>
    <div class="dd-item">• Démence vasculaire (infarctus multiples) <span class="dd-test">→ IRM cérébrale (hypersignaux substance blanche, lacunes)</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;□ Facteurs de risque vasculaires (HTA, diabète, hyperlipidémie)<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Évolution par paliers possible<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Troubles de la marche<br><strong>Arguments CONTRE:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;□ Pas d'histoire d'AVC<br>&nbsp;&nbsp;&nbsp;&nbsp;□ Évolution plutôt progressive</div>
</div>
<div class="criteria-row" id="criteria-m2">
    <div>
        <div class="criteria-text">2. Examens complémentaires immédiats <button class="comment-button" onclick="toggleComment('m2')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">NFS avec formule leucocytaire</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-0" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Ionogramme et fonction rénale</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-1" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Glycémie, HbA1c</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-2" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">TSH, vitamine B12, folates</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-3" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Analyse et culture d'urine</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-4" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Examen génital et toucher rectal</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-5" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-m2">
            <textarea class="comment-textarea" id="comment-m2" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('m2'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m2">0</div>
</div>
<div class="criteria-row" id="criteria-m3">
    <div>
        <div class="criteria-text">3. Imagerie et examens spécialisés <button class="comment-button" onclick="toggleComment('m3')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">IRM cérébrale avec séquences T1, T2, FLAIR</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m3-detail-0" value="1" onchange="updateDetailScore('m3', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Évaluation de l'atrophie et des espaces périventriculaires</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m3-detail-1" value="1" onchange="updateDetailScore('m3', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Recherche de signes d'hydrocéphalie</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m3-detail-2" value="1" onchange="updateDetailScore('m3', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Bilan neuropsychologique si pas d'amélioration</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m3-detail-3" value="1" onchange="updateDetailScore('m3', 'm')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-m3">
            <textarea class="comment-textarea" id="comment-m3" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('m3'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m3">0</div>
</div>
<div class="criteria-row" id="criteria-m4">
    <div>
        <div class="criteria-text">4. Prise en charge thérapeutique <button class="comment-button" onclick="toggleComment('m4')" title="Ajouter un commentaire">📝</button></div>
        <div class="therapy-section">
            <div class="therapy-title">Si hydrocéphalie à pression normale confirmée</div>
            <div><span style="margin-left: 10px;">•</span> Référence en neurochirurgie<br />
            <span style="margin-left: 10px;">•</span> Ponction lombaire soustractive thérapeutique<br />
            <span style="margin-left: 10px;">•</span> Évaluation pour dérivation ventriculo-péritonéale<br />
            <span style="margin-left: 10px;">•</span> Rééducation de la marche</div>
        </div>
        <div class="therapy-section">
            <div class="therapy-title">Si démence d'Alzheimer probable</div>
            <div><span style="margin-left: 10px;">•</span> Inhibiteurs de la cholinestérase (donépézil, rivastigmine)<br />
            <span style="margin-left: 10px;">•</span> Mémantine si stade modéré à sévère<br />
            <span style="margin-left: 10px;">•</span> Soutien psychosocial famille<br />
            <span style="margin-left: 10px;">•</span> Planification médico-légale précoce<br />
            <span style="margin-left: 10px;">•</span> Évaluation de la sécurité à domicile</div>
        </div>
        <div class="therapy-section">
            <div class="therapy-title">Mesures générales</div>
            <div><span style="margin-left: 10px;">•</span> Optimisation du contrôle glycémique<br />
            <span style="margin-left: 10px;">•</span> Contrôle tensionnel strict<br />
            <span style="margin-left: 10px;">•</span> Prévention des chutes (kinésithérapie, aides techniques)<br />
            <span style="margin-left: 10px;">•</span> Éducation de l'aidante<br />
            <span style="margin-left: 10px;">•</span> Services de soutien à domicile</div>
        </div>
        <div class="criterion-comment-section" id="comment-section-m4">
            <textarea class="comment-textarea" id="comment-m4" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('m4'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m4" value="2" data-criteria="Prise en charge thérapeutique" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m4" value="1" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m4" value="0" onchange="updateScore('m', this)" />
    </div>
    <div class="points-display" id="points-m4">0</div>
</div>
<div class="criteria-row" id="criteria-m5">
    <div>
        <div class="criteria-text">5. Communication avec le patient et sa famille <button class="comment-button" onclick="toggleComment('m5')" title="Ajouter un commentaire">📝</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Explication des diagnostics possibles en termes simples</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-0" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Rassurer sur les causes réversibles possibles</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-1" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Importance des examens pour éliminer les causes traitables</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-2" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Soutien à l'épouse aidante</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-3" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Eh bien, je ne peux pas dire ce que cela pourrait être à ce stade."</div><div class="exemple-phrase">"Avant de poser ce diagnostic, j'aimerais poser plus de questions et faire quelques tests."</div><div class="exemple-phrase">"Il est possible que si nous sommes capables de trouver la raison de ces symptômes, cela pourrait être réversible."</div></div>        <div class="criterion-comment-section" id="comment-section-m5">
            <textarea class="comment-textarea" id="comment-m5" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('m5'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m5">0</div>
</div>
<div class="criteria-row" id="criteria-m6">
    <div>
        <div class="criteria-text">6. Red flags et surveillance <button class="comment-button" onclick="toggleComment('m6')" title="Ajouter un commentaire">📝</button></div>
        <div class="redflags-section">
            <div class="redflags-title">⚠️ Signes d'alerte nécessitant une réévaluation urgente</div>
            <div class="redflags-item">
                <div class="redflags-text">1. Aggravation rapide de l'état mental</div>
                <div class="redflags-description">Confusion aiguë, désorientation complète</div>
            </div>
            <div class="redflags-item">
                <div class="redflags-text">2. Chutes répétées</div>
                <div class="redflags-description">Risque de traumatisme crânien</div>
            </div>
            <div class="redflags-item">
                <div class="redflags-text">3. Signes neurologiques focaux</div>
                <div class="redflags-description">Déficit moteur, aphasie brutale</div>
            </div>
            <div class="redflags-item">
                <div class="redflags-text">4. Fièvre ou signes infectieux</div>
                <div class="redflags-description">Risque de décompensation</div>
            </div>
            <div class="redflags-item">
                <div class="redflags-text">5. Rétention urinaire aiguë</div>
                <div class="redflags-description">Complication de l'HBP</div>
            </div>
        </div>
        <div class="criterion-comment-section" id="comment-section-m6">
            <textarea class="comment-textarea" id="comment-m6" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('m6'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m6" value="2" data-criteria="Red flags et surveillance" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m6" value="1" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m6" value="0" onchange="updateScore('m', this)" />
    </div>
    <div class="points-display" id="points-m6">0</div>
</div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('management')" title="Commentaire sur cette section">📝 Commentaire sur la section Management</button>
                </div>
                <div class="section-comment-section" id="section-comment-management">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur le management</h4>
                    <textarea class="comment-textarea" id="comment-section-management" placeholder="Commentaire sur la section management..." oninput="updateSectionComment('management'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- CLÔTURE -->
        <div class="section cloture-section">
            <div class="section-header">
                <span>Clôture de consultation</span>
            </div>
            <div class="section-content">
                <div class="cloture-item">
                    <h4 class="cloture-title">Explication diagnostique et plan</h4>
                    <div class="cloture-content cloture-content-green">M. et Mme Plaster, je ne peux pas dire exactement ce qui pourrait se passer pour causer ces symptômes. Cependant, il y a des tests que j'aimerais faire pour essayer de le découvrir. Une possibilité est une maladie appelée "hydrocéphalie à pression normale", qui est un nom sophistiqué pour quand le liquide qui baigne normalement le cerveau s'y accumule et cause des dommages. Cette maladie est heureusement réversible et peut être la cause de ce qui se passe ici, mais la meilleure façon de le dire est une IRM, ou scanner cérébral, pour regarder le cerveau lui-même. Le test lui-même est assez facile en ce sens que vous devrez vous allonger sur une petite table, qui se déplace ensuite dans et hors d'une machine en forme de tunnel. Il prend des photos de votre cerveau pendant que vous vous déplacez. Une autre possibilité, comme nous en avons parlé auparavant, est le début de la maladie d'Alzheimer. C'est une maladie préoccupante qui peut causer certains des symptômes de type mémoire que vous avez. C'est une maladie courante, mais il n'y a vraiment pas d'excellent moyen de dire si c'est la cause. Pour celle-ci, je veux éliminer d'autres possibilités avant de la pointer parce que la maladie d'Alzheimer n'est pas totalement curable, bien que nous ayons des médicaments pour aider. Dans l'ensemble, je devrai prélever du sang aujourd'hui, de l'urine aujourd'hui, faire un examen génital et de la prostate rapide, et vous faire suivre pour ce scanner cérébral au service de radiologie. Permettez-moi de sortir et d'organiser ces tests pendant que je vous demande de vous mettre en blouse.

Y a-t-il un autre aspect de vos soins de santé dont nous n'avons pas déjà discuté ? D'accord alors, merci.</div>
                </div>
                <div class="cloture-item">
                    <h4 class="cloture-title">Question difficile de l'épouse</h4>
                    <div class="cloture-content">[Pensez-vous que c'est quelque chose comme la maladie d'Alzheimer ?]</div>
                </div>
                <div class="cloture-item">
                    <h4 class="cloture-title">Réponse appropriée du candidat</h4>
                    <div class="cloture-content cloture-content-green">La maladie d'Alzheimer est une maladie préoccupante qui peut avoir certaines des caractéristiques que vous décrivez, mais il est trop tôt pour le dire maintenant. La maladie d'Alzheimer et d'autres maladies qui causent ce qu'on appelle la "démence" sont souvent difficiles à diagnostiquer. Avant de poser ce diagnostic, j'aimerais poser plus de questions et faire quelques tests. Il est possible que si nous sommes capables de trouver la raison de ces symptômes, cela pourrait être réversible, auquel cas nous pourrions certainement le traiter.</div>
                </div>
            </div>
        </div>
        <!-- COMMUNICATION -->
        <div class="section communication-section-container">
            <div class="section-header">
                <span>Communication (25%)</span>
                <span class="score">Score : <span id="communicationScore">0</span>/20</span>
            </div>
            <div class="section-content">
                <div class="header-row communication-header">
                    <div>Critères</div>
                    <div>A</div>
                    <div>B</div>
                    <div>C</div>
                    <div>D</div>
                    <div>E</div>
                </div>
                <div class="communication-section" id="criteria-c1">
                    <div>
                        <div class="communication-text">1. Réponse aux sentiments et besoins du patient <button class="comment-button" onclick="toggleComment('c1')" title="Ajouter un commentaire">📝</button></div>
                        <div class="communication-desc">Empathie, écoute active, validation des émotions<br />
Explique le déroulement de la consultation et vérifie les préoccupations du patient, commence l'anamnèse par une question ouverte ; reconnaît, verbalise et légitime les émotions, fournit du soutient</div>
                        <div class="criterion-comment-section" id="comment-section-c1">
                            <textarea class="comment-textarea" id="comment-c1" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('c1'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="A" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="B" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="C" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="D" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="E" data-criteria="Réponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c2">
                    <div>
                        <div class="communication-text">2. Structure de l'entretien <button class="comment-button" onclick="toggleComment('c2')" title="Ajouter un commentaire">📝</button></div>
                        <div class="communication-desc">Organisation logique, transitions fluides, gestion du temps<br />
Se présente par son nom et sa fonction, les étapes de l'entretien sont identifiables et s'enchaînent de manière logique, gestion du temps, adaptation à la situation</div>
                        <div class="criterion-comment-section" id="comment-section-c2">
                            <textarea class="comment-textarea" id="comment-c2" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('c2'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="A" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="B" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="C" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="D" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="E" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c3">
                    <div>
                        <div class="communication-text">3. Expression verbale <button class="comment-button" onclick="toggleComment('c3')" title="Ajouter un commentaire">📝</button></div>
                        <div class="communication-desc">Clarté, vocabulaire adapté, vérification de la compréhension<br />
Langage adapté au niveau du patient, pas de jargon, explications compréhensibles, reformulations quand nécessaire, répétitions des points clés, fait une synthèse de la consultation, bonne articulation, ton et volume adéquats</div>
                        <div class="criterion-comment-section" id="comment-section-c3">
                            <textarea class="comment-textarea" id="comment-c3" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('c3'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="A" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="B" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="C" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="D" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="E" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c4">
                    <div>
                        <div class="communication-text">4. Expression non verbale <button class="comment-button" onclick="toggleComment('c4')" title="Ajouter un commentaire">📝</button></div>
                        <div class="communication-desc">Contact visuel, posture, gestuelle appropriée<br />
Distance interpersonnelle adéquate, posture adéquate, gestes adéquats, contact visuel et expression faciale adéquats, pauses quand nécessaire</div>
                        <div class="criterion-comment-section" id="comment-section-c4">
                            <textarea class="comment-textarea" id="comment-c4" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('c4'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="A" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="B" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="C" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="D" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="E" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c5">
                    <div>
                        <div class="communication-text">5. Évaluation générale de la communication <button class="comment-button" onclick="toggleComment('c5')" title="Ajouter un commentaire">📝</button></div>
                        <div class="communication-desc">Qualité globale de l'interaction médecin-patient</div>
                        <div class="criterion-comment-section" id="comment-section-c5">
                            <textarea class="comment-textarea" id="comment-c5" placeholder="Commentaire sur ce critère..." oninput="updateCommentButton('c5'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="A" data-criteria="Évaluation générale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="B" data-criteria="Évaluation générale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="C" data-criteria="Évaluation générale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="D" data-criteria="Évaluation générale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="E" data-criteria="Évaluation générale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('communication')" title="Commentaire sur cette section">📝 Commentaire sur la section Communication</button>
                </div>
                <div class="section-comment-section" id="section-comment-communication">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur la communication</h4>
                    <textarea class="comment-textarea" id="comment-section-communication" placeholder="Commentaire sur la section communication..." oninput="updateSectionComment('communication'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- TOTAUX -->
        <div class="total-sections">
            <div class="total-section">
                <div class="total-label">Score Global</div>
                <div class="total-body">
                    <div class="total-score" id="totalScore">0/129</div>
                </div>
            </div>
            <div class="total-section">
                <div class="total-label">% par Section</div>
                <div class="total-pourcent-body">
                    <div class="total-pourcent-sections">
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Anamnèse</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="anamnese-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Examen clinique</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="examen-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Management</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="management-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Communication</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="communication-percentage">0</span>%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="total-section">
                <div class="total-label">Note Globale</div>
                <div class="total-body">
                    <div class="total-note-globale" id="globalGrade">E</div>
                </div>
            </div>
        </div>
        <!-- ÉCHELLE DE NOTATION -->
        <div class="grade-scale" style="padding: 10px 15px; background: #f8f9fa; border-radius: 8px;">
            <h3 style="margin: 0 0 10px 0; font-size: 16px;">Échelle de notation</h3>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; text-align: center;">
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #2c974b;">A</div>
                    <div style="font-size: 12px; color: #666;">≥90%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #4e9cf0;">B</div>
                    <div style="font-size: 12px; color: #666;">80-89%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #f0ad4e;">C</div>
                    <div style="font-size: 12px; color: #666;">70-79%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #e67e22;">D</div>
                    <div style="font-size: 12px; color: #666;">60-69%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #d9534f;">E</div>
                    <div style="font-size: 12px; color: #666;">&lt;60%</div>
                </div>
            </div>
        </div>
        <!-- ÉLÉMENTS MANQUANTS (MASQUÉS) -->
        <!-- <div class="missing-items" id="missingItems" style="display: none;">
            <h3>Éléments non évalués</h3>
            <div id="missingList"></div>
        </div> -->
<div class="annexes">
<h3>Annexes</h3>
<div class="annexes-grid">
<div class="annexe-item annexe-scenario">
    <div class="annexe-title">Instructions pour le patient standardisé et son épouse</div>
    <div class="annexe-scenario-content">
        <div class="scenario-info">
            <strong>Nom :</strong> Jack Plaster |             <strong>Âge :</strong> 78 ans<br>
            <strong>Contexte :</strong> Homme âgé avec troubles mnésiques progressifs accompagné de son épouse
        </div>
        <div class="scenario-section">
            <h4>Motif de consultation</h4>
            <p><strong>Plainte principale :</strong> «Perte de mémoire»</p>
            <p><strong>Si on demande s'il y a autre chose :</strong> «Ma femme dit que je me suis aggravé»</p>
        </div>
        <div class="scenario-section">
            <h4>Histoire actuelle</h4>
            <div class="scenario-subsection">
                <strong>Troubles mnésiques :</strong>
                <ul>
                    <li>Oubli du chemin pour rentrer du magasin (1 pâté de maisons)</li>
                    <li>Questions sur la banque fréquentée depuis 20 ans</li>
                    <li>Oubli du nom du chat qu'il a nommé</li>
                    <li>Oubli du nom de la petite-fille (Emily)</li>
                    <li>Non-reconnaissance occasionnelle des voisins</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Troubles de la marche :</strong>
                <ul>
                    <li>Instabilité depuis quelques semaines</li>
                    <li>Besoin de se tenir aux meubles</li>
                    <li>Sensation qu'il pourrait tomber</li>
                    <li>Pas de vertiges, juste instable</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Incontinence :</strong>
                <ul>
                    <li>Quelques épisodes de fuites</li>
                    <li>Pas de sensation du besoin d'uriner</li>
                    <li>Découverte d'humidité en regardant la TV</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Attitude du patient :</strong>
                <ul>
                    <li>Minimise ses problèmes</li>
                    <li>Dit avoir toujours eu mauvaise mémoire</li>
                    <li>Embarrassé par ses oublis</li>
                    <li>Coopératif mais défensif</li>
                </ul>
            </div>
        </div>
        <div class="scenario-section">
            <h4>Médicaments actuels</h4>
            <div class="scenario-subsection">
                <strong>Médicaments :</strong>
                <ul>
                    <li>Aténolol (HTA)</li>
                    <li>Lisinopril (HTA)</li>
                    <li>Lovastatine (cholestérol)</li>
                    <li>Tamsulosine (prostate)</li>
                    <li>Glyburide (diabète)</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <p><strong>Gestion des médicaments :</strong> Épouse organise tous les médicaments</p>
            </div>
        </div>
        <div class="scenario-section">
            <h4>Habitudes</h4>
            <ul>
                <li><strong>Tabac :</strong> Jamais fumé</li>
                <li><strong>Alcool :</strong> Abstinent depuis 30 ans, consommation modérée avant</li>
            </ul>
        </div>
        <div class="scenario-section">
            <h4>Rôle de l'accompagnant(e)</h4>
            <p><strong>Nom :</strong> Sherry Plaster</p>
            <div class="scenario-subsection">
                <strong>Observations :</strong>
                <ul>
                    <li>Note l'aggravation récente</li>
                    <li>Donne des exemples précis</li>
                    <li>Gère les médicaments</li>
                    <li>Conduit partout</li>
                    <li>Inquiète de la maladie d'Alzheimer</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Attitude :</strong>
                <ul>
                    <li>Protectrice mais réaliste</li>
                    <li>Corrige gentiment son mari</li>
                    <li>Fournit les détails manquants</li>
                </ul>
            </div>
        </div>
        <div class="scenario-section">
            <h4>Antécédents</h4>
            <div class="scenario-subsection">
                <strong>Antécédents médicaux :</strong>
                <ul>
                    <li>Hypertension artérielle</li>
                    <li>Hypercholestérolémie</li>
                    <li>Diabète type 2</li>
                    <li>Hypertrophie bénigne de la prostate</li>
                    <li>Cors aux pieds (opérés)</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Antécédents chirurgicaux :</strong>
                <ul>
                    <li>Ablation des cors</li>
                    <li>Chirurgie pour blessure par balle à la jambe (guerre)</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Antécédents professionnels :</strong>
                <ul>
                    <li>Facteur postal pendant 28 ans (retraité)</li>
                    <li>Vétéran de guerre</li>
                </ul>
            </div>
        </div>
        <div class="scenario-section">
            <h4>Simulation</h4>
            <div class="scenario-subsection">
                <strong>Durant l'entretien :</strong>
                <ul>
                    <li>Patient : Regarder son épouse pour confirmation</li>
                    <li>Patient : Minimiser les symptômes</li>
                    <li>Patient : Montrer de la frustration quand il oublie</li>
                    <li>Épouse : Intervenir pour clarifier ou corriger</li>
                    <li>Épouse : Donner des exemples concrets</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Durant l'examen :</strong>
                <ul>
                    <li>Marche lente et prudente</li>
                    <li>Se tenir au mobilier si possible</li>
                    <li>Difficulté marquée pour marche talons/pointes</li>
                    <li>Coopératif pour l'examen neurologique</li>
                </ul>
            </div>
        </div>
        <div class="scenario-section">
            <h4>Contexte social</h4>
            <p><strong>Famille :</strong> Marié, 2 enfants (fils en faculté de droit, fille avec 3 filles)</p>
            <p><strong>Logement :</strong> Même maison depuis 26 ans</p>
            <p><strong>Capacité de conduite :</strong> Épouse conduit maintenant partout</p>
            <p><strong>Autonomie :</strong> Dépendant de son épouse pour médicaments et transport</p>
        </div>
    </div>
</div>
<div class="annexe-item annexe-informations-expert">
    <div class="annexe-title">Points clés pour l'évaluation</div>
    <div class="annexe-informations-content">
        <div class="info-section">
            <h4>Points clés</h4>
            <ul>
                <li>Présentation de la triade classique d'hydrocéphalie à pression normale</li>
                <li>Troubles cognitifs + troubles de la marche + incontinence urinaire</li>
                <li>Importance de l'anamnèse collatérale (épouse)</li>
                <li>Patient minimise ses symptômes, épouse plus inquiète</li>
                <li>Multiples facteurs de risque vasculaires</li>
                <li>Démarche à base large sans autres signes parkinsoniens</li>
                <li>Incontinence sans urgence mictionnelle (signe clé)</li>
            </ul>
        </div>
        <div class="info-section">
            <h4>Pièges</h4>
            <ul>
                <li>Ne pas se focaliser uniquement sur Alzheimer</li>
                <li>Oublier l'hydrocéphalie à pression normale (potentiellement réversible)</li>
                <li>Ne pas faire l'examen neurologique complet</li>
                <li>Négliger l'examen de la marche</li>
                <li>Oublier de rechercher une infection occulte chez le diabétique</li>
                <li>Ne pas impliquer l'épouse dans la discussion</li>
                <li>Manquer l'incontinence urinaire dans l'anamnèse</li>
            </ul>
        </div>
    </div>
</div>
<div class="annexe-item annexe-theorie-pratique">
    <div class="annexe-title">Rappels théoriques - Troubles cognitifs chez la personne âgée</div>
    <div class="annexe-theorie-content">
        <div class="theorie-section">
            <h4>Hydrocéphalie à pression normale</h4>
            <p>Triade classique : troubles cognitifs + apraxie de la marche + incontinence urinaire. Cause potentiellement réversible de démence. Diagnostic : IRM (dilatation ventriculaire disproportionnée), ponction lombaire soustractive. Traitement : dérivation ventriculo-péritonéale si amélioration après PL.</p>
        </div>
        <div class="theorie-section">
            <h4>Démences et diagnostic différentiel</h4>
            <p>Alzheimer : troubles mnésiques prédominants, évolution progressive. Vasculaire : facteurs de risque CV, évolution par paliers. Corps de Lewy : hallucinations, fluctuations, parkinsonisme. Fronto-temporale : troubles comportementaux précoces.</p>
        </div>
        <div class="theorie-section">
            <h4>Bilan de démence</h4>
            <p>Biologie : NFS, iono, urée/créat, B12, folates, TSH, syphilis. Imagerie : IRM > TDM. Tests cognitifs : MMSE, MoCA. Éliminer causes réversibles : médicaments, dépression, hypothyroïdie, carence B12.</p>
        </div>
    </div>
</div>
<div class="annexe-item annexe-rappels-therapeutiques">
    <div class="annexe-title">Rappels thérapeutiques</div>
    <div class="annexe-theorie-content">
        <ul class="rappels-list">
            <li>HPN : dérivation VP si réponse positive à PL soustractive</li>
            <li>Alzheimer : inhibiteurs cholinestérase (donépézil, rivastigmine, galantamine)</li>
            <li>Stade modéré-sévère : ajouter mémantine</li>
            <li>Mesures non pharmacologiques : stimulation cognitive, activité physique</li>
            <li>Support aux aidants : formation, répit, groupes de soutien</li>
        </ul>
    </div>
</div>
<div class="annexe-item annexe-examens-complementaires">
    <div class="annexe-title">Examens complémentaires</div>
    <div class="annexe-theorie-content">
        <ul class="examens-list">
            <li>IRM cérébrale : gold standard pour HPN et atrophie</li>
            <li>Ponction lombaire : pression d'ouverture, protéines, test soustractif</li>
            <li>MMSE/MoCA : évaluation cognitive standardisée</li>
            <li>Bilan métabolique complet : éliminer causes réversibles</li>
            <li>EEG si suspicion de crises épileptiques</li>
        </ul>
    </div>
</div>
</div>
</div>
        <!-- COMMENTAIRE GÉNÉRAL -->
        <div class="section-comment-section global">
            <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 18px;">Commentaire général</h4>
            <textarea class="comment-textarea" id="comment-general" placeholder="Commentaire général sur l'évaluation..." oninput="updateGeneralComment(); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <script>
        // Déclaration des variables globales
        window.audioContext = null;
        
        function updateScore(section, element) {
            const value = element.value;
            const name = element.name;
            let pointValue;

            if (section === "communication") {
                const map = { A: 4, B: 3, C: 2, D: 1, E: 0 };
                pointValue = map[value] || 0;
                // Mettre à jour la classe de couleur pour communication
                const criteriaRow = document.getElementById("criteria-" + name);
                if (criteriaRow) {
                    criteriaRow.classList.remove("score-a", "score-b", "score-c", "score-d", "score-e", "lacune-rouge", "lacune-orange", "lacune-verte");
                    criteriaRow.classList.add("score-" + value.toLowerCase());
                    // Ajouter les classes lacune pour communication
                    if (value === "E" || value === "D") {
                        criteriaRow.classList.add("lacune-rouge");
                    } else if (value === "C") {
                        criteriaRow.classList.add("lacune-orange");
                    } else if (value === "A" || value === "B") {
                        criteriaRow.classList.add("lacune-verte");
                    }
                }
            } else {
                pointValue = Number(value) || 0;
                // Mettre à jour la classe de couleur pour autres critères
                const criteriaRow = document.getElementById("criteria-" + name);
                if (criteriaRow) {
                    criteriaRow.classList.remove("score-0", "score-1", "score-2", "lacune-rouge", "lacune-orange", "lacune-verte");
                    criteriaRow.classList.add("score-" + value);
                    // Ajouter les classes lacune pour critères normaux
                    if (pointValue === 0) {
                        criteriaRow.classList.add("lacune-rouge");
                    } else if (pointValue === 1) {
                        criteriaRow.classList.add("lacune-orange");
                    } else if (pointValue >= 2) {
                        criteriaRow.classList.add("lacune-verte");
                    }
                }
            }

            const pointsElement = document.getElementById("points-" + name);
            if (pointsElement) {
                pointsElement.textContent = pointValue;
            }

            calculateScores();
        }

        function updateDetailScore(criterionId, prefix) {
            let totalScore = 0;
            const detailCheckboxes = document.querySelectorAll('input[id^="' + criterionId + '-detail-"]');
            const maxDetailsScore = detailCheckboxes.length;
            
            detailCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    totalScore += Number(checkbox.value) || 0;
                }
            });
            
            const pointsElement = document.getElementById("points-" + criterionId);
            if (pointsElement) {
                pointsElement.textContent = totalScore;
            }
            
            // Mettre à jour la classe de couleur en fonction du score et du max
            const criteriaRow = document.getElementById("criteria-" + criterionId);
            if (criteriaRow) {
                criteriaRow.classList.remove("score-0", "score-1", "score-2", "score-3", "score-4", "score-5", "score-max", "lacune-rouge", "lacune-orange", "lacune-verte");
                
                // Déterminer la classe appropriée avec les seuils 1/3 et 2/3
                const oneThird = maxDetailsScore / 3;
                const twoThirds = (maxDetailsScore * 2) / 3;
                
                if (totalScore < oneThird) {
                    criteriaRow.classList.add("score-0");
                    criteriaRow.classList.add("lacune-rouge");
                } else if (totalScore > twoThirds) {
                    criteriaRow.classList.add("score-max");
                    criteriaRow.classList.add("lacune-verte");
                } else {
                    // Score entre 1/3 et 2/3
                    criteriaRow.classList.add("score-1");
                    criteriaRow.classList.add("lacune-orange");
                }
            }
            
            calculateScores();
        }

        function calculateScores() {
            const isNewFormat = false;
            const missingItems = [];
            let scores = {};
            let maxScores = {};
            let coef = {};
            let sectionInfo = [];

            // Configuration pour le format traditionnel
            scores = {anamnese: 0, examen: 0, management: 0, communication: 0};
            maxScores = {anamnese: 57, examen: 32, management: 20, communication: 20};
            coef = {anamnese: 0.25, examen: 0.25, management: 0.25, communication: 0.25};
            sectionInfo = [
                {key: "anamnese", prefix: "a", count: 15, label: "Anamnèse"},
                {key: "examen", prefix: "e", count: 8, label: "Examen clinique", scoreId: "statusScore"},
                {key: "management", prefix: "m", count: 6, label: "Management"},
                {key: "communication", prefix: "c", count: 5, label: "Communication", isComm: true}
            ];

            // Calcul des scores pour chaque section
            sectionInfo.forEach(section => {
                let sectionScore = 0;
                
                if (section.isComm) {
                    // Section communication spéciale
                    for (let i = 1; i <= section.count; i++) {
                        const radio = document.querySelector("input[name=\"" + section.prefix + i + "\"]:checked");
                        if (radio) {
                            const val = radio.value;
                            const map = { A: 4, B: 3, C: 2, D: 1, E: 0 };
                            sectionScore += map[val] || 0;
                        } else {
                            const criteria = document.querySelector("input[name=\"" + section.prefix + i + "\"][data-criteria]");
                            if (criteria) missingItems.push(section.label + " : " + criteria.dataset.criteria);
                        }
                    }
                } else {
                    // Sections normales
                    for (let i = 1; i <= section.count; i++) {
                        const criterionId = section.prefix + i;
                        // Vérifier si ce critère a des détails avec checkboxes
                        const detailCheckboxes = document.querySelectorAll('input[id^="' + criterionId + '-detail-"]');
                        
                        if (detailCheckboxes.length > 0) {
                            // Ce critère a des détails, on calcule le score basé sur les détails
                            let detailScore = 0;
                            let hasCheckedDetail = false;
                            detailCheckboxes.forEach(checkbox => {
                                if (checkbox.checked) {
                                    detailScore += Number(checkbox.value) || 0;
                                    hasCheckedDetail = true;
                                }
                            });
                            sectionScore += detailScore;
                            
                            if (!hasCheckedDetail) {
                                const criteria = document.querySelector("input[name=\"" + criterionId + "\"][data-criteria]");
                                if (criteria) {
                                    missingItems.push(section.label + " : " + criteria.dataset.criteria);
                                } else {
                                    // Rechercher le texte du critère directement
                                    const criteriaText = document.querySelector("#criteria-" + criterionId + " .criteria-text");
                                    if (criteriaText) {
                                        missingItems.push(section.label + " : " + criteriaText.textContent.split(". ")[1].split(" [")[0]);
                                    }
                                }
                            }
                        } else {
                            // Critère normal sans détails
                            const radio = document.querySelector("input[name=\"" + criterionId + "\"]:checked");
                            if (radio) {
                                sectionScore += Number(radio.value) || 0;
                            } else {
                                const criteria = document.querySelector("input[name=\"" + criterionId + "\"][data-criteria]");
                                if (criteria) missingItems.push(section.label + " : " + criteria.dataset.criteria);
                            }
                        }
                    }
                }
                
                scores[section.key] = sectionScore;
                const scoreId = section.scoreId || section.key + "Score";
                const scoreElement = document.getElementById(scoreId);
                if (scoreElement) scoreElement.textContent = sectionScore;
            });

            // Calcul des pourcentages par section
            let percentages = {};
            let globalPercentage = 0;
            let isStarted = false;
            
            sectionInfo.forEach(section => {
                const score = scores[section.key];
                const max = maxScores[section.key];
                const percentage = max > 0 ? (score / max) * 100 : 0;
                percentages[section.key] = percentage;
                globalPercentage += percentage * coef[section.key];
                if (score > 0) isStarted = true;
            });

            const totalScoreText = isStarted ? Math.round(globalPercentage) : 0;
            document.getElementById("totalScore").textContent = totalScoreText + "%";

            // Mise à jour des pourcentages affichés
            sectionInfo.forEach(section => {
                const percentageElement = document.getElementById(section.key + "-percentage");
                if (percentageElement) {
                    percentageElement.textContent = Math.round(percentages[section.key]);
                }
            });

            const gradeElement = document.getElementById("globalGrade");
            const totalScoreElement = document.getElementById("totalScore");
            const scoreBody = totalScoreElement ? totalScoreElement.closest(".total-body") : null;
            const gradeBody = gradeElement ? gradeElement.closest(".total-body") : null;
            const sections = sectionInfo.map(s => s.key);

            const allClasses = ["note-a", "note-b", "note-c", "note-d", "note-e", "note-neutral"];

            function getClass(p) {
                if (p === 0) return "note-neutral";
                if (p >= 90) return "note-a";
                if (p >= 80) return "note-b";
                if (p >= 70) return "note-c";
                if (p >= 60) return "note-d";
                return "note-e";
            }

            const gradeClass = getClass(globalPercentage);
            const gradeLabel = isStarted ? gradeClass.split("-")[1].toUpperCase() : "A-E";
            if (gradeElement) gradeElement.textContent = gradeLabel;

            const pourcentBody = document.querySelector(".total-pourcent-body");

            [gradeElement, scoreBody, gradeBody, pourcentBody].forEach(el => {
                if (el) {
                    el.classList.remove(...allClasses);
                    el.classList.add(gradeClass);
                }
            });

            sections.forEach(id => {
                const percentageElement = document.getElementById(id + "-percentage");
                if (percentageElement) {
                    const value = parseInt(percentageElement.textContent);
                    const section = percentageElement.closest(".total-pourcent-section");
                    const sectionClass = getClass(value);
                    if (section) {
                        section.classList.remove(...allClasses);
                        section.classList.add(sectionClass);
                    }
                }
            });

            // Appliquer les couleurs aux sections principales
            sectionInfo.forEach(section => {
                const percentage = percentages[section.key];
                const allSections = document.querySelectorAll(".section");
                allSections.forEach(sectionEl => {
                    const headerText = sectionEl.querySelector(".section-header")?.textContent || "";
                    if (headerText.includes(section.label)) {
                        const sectionClass = getClass(percentage);
                        sectionEl.classList.remove(...allClasses);
                        sectionEl.classList.add(sectionClass);
                    }
                });
            });

            if (missingItems.length > 0) {
                document.getElementById("missingItems").style.display = "block";
                document.getElementById("missingList").innerHTML = missingItems.map(item =>
                    "<div class=\"missing-item\">• " + item + "</div>"
                ).join("");
            } else {
                document.getElementById("missingItems").style.display = "none";
            }
        }
        // MINUTEUR ECOS 13 MINUTES
        window.timerInterval = null;
        window.currentSeconds = 13 * 60;
        window.isRunning = false;
        window.hasStarted = false;
        window.hasFinished = false;
        window.hasStoppedManually = false;

        window.currentMode = 'revision';

        function colorPatientResponses() {
            // Version simplifiée inspirée du générateur v1
            const elements = document.querySelectorAll('.criteria-text, .sub-criteria, .redflags-text, .dd-item, .therapy-section, .detail-text, .cloture-content');
            elements.forEach(element => {
                const text = element.innerHTML;
                // Colorer uniquement les réponses patient en bleu (pas les examens complémentaires)
                let coloredText = text.replace(/\[([^\]]+)\]/g, '<span style="color: rgb(44, 90, 160); font-weight: 500;">[$1]</span>');
                element.innerHTML = coloredText;
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            switchMode('revision');
            calculateScores();
            colorPatientResponses();
            // Appeler une deuxième fois après un court délai pour s'assurer que tout est chargé
            setTimeout(function() {
                colorPatientResponses();
            }, 100);
            // Appel supplémentaire après un délai plus long pour garantir que tout est chargé
            setTimeout(function() {
                colorPatientResponses();
            }, 500);
            // Auto-resize tous les textareas au chargement
            const allTextareas = document.querySelectorAll('.comment-textarea');
            allTextareas.forEach(textarea => {
                if (textarea.value) {
                    autoResizeTextarea(textarea);
                }
            });
        });
        
        // S'assurer que la hauteur est bien définie avant l'impression
        window.addEventListener('beforeprint', function() {
            const allTextareas = document.querySelectorAll('.comment-textarea');
            allTextareas.forEach(textarea => {
                if (textarea.value && textarea.value.trim()) {
                    // S'assurer que le textarea a une hauteur définie
                    if (!textarea.style.height || textarea.style.height === 'auto') {
                        autoResizeTextarea(textarea);
                    }
                }
            });
        });


        function initAudio() {
            if (!window.audioContext) {
                window.audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playBeep() {
            initAudio();
            const oscillator = window.audioContext.createOscillator();
            const gainNode = window.audioContext.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(window.audioContext.destination);
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            gainNode.gain.setValueAtTime(0.3, window.audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, window.audioContext.currentTime + 0.5);
            oscillator.start(window.audioContext.currentTime);
            oscillator.stop(window.audioContext.currentTime + 0.5);
        }

        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'fr-FR';
                utterance.rate = 0.9;
                utterance.volume = 0.8;
                speechSynthesis.speak(utterance);
            }
        }

        function playSound(message) {
            playBeep();
            setTimeout(() => speak(message), 500);
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return minutes + ":" + secs.toString().padStart(2, "0");
        }

        function toggleCheckboxes(disabled) {
            const radios = document.querySelectorAll('input[type="radio"]');
            radios.forEach(radio => {
                radio.disabled = disabled;
            });
            const detailCheckboxes = document.querySelectorAll('.detail-checkbox input[type="checkbox"]');
            detailCheckboxes.forEach(checkbox => {
                checkbox.disabled = disabled;
            });
        }

        function colorCriteriaByScore() {
            if (!window.hasFinished && !window.hasStoppedManually) return;

            const normalCriteriaRows = document.querySelectorAll('.criteria-row');
            normalCriteriaRows.forEach(row => {
                const id = row.id;
                if (!id) return;
                const criteriaName = id.replace('criteria-', '');
                const checkedRadio = document.querySelector('input[name="' + criteriaName + '"]:checked');
                row.classList.remove('criteria-zero-points', 'criteria-one-point', 'criteria-full-points', 'criteria-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
                if (checkedRadio) {
                    const score = Number(checkedRadio.value) || 0;
                    if (score === 0) {
                        row.classList.add('criteria-zero-points');
                        row.classList.add('lacune-rouge');
                    } else if (score === 1) {
                        row.classList.add('criteria-one-point');
                        row.classList.add('lacune-orange');
                    } else if (score >= 2) {
                        row.classList.add('criteria-full-points');
                        row.classList.add('lacune-verte');
                    }
                } else {
                    row.classList.add('criteria-not-answered');
                    row.classList.add('lacune-rouge');
                }
            });

            const communicationRows = document.querySelectorAll('.communication-section');
            communicationRows.forEach(row => {
                const id = row.id;
                if (!id) return;
                const criteriaName = id.replace('criteria-', '');
                const checkedRadio = document.querySelector('input[name="' + criteriaName + '"]:checked');
                row.classList.remove('communication-note-a', 'communication-note-b', 'communication-note-c', 'communication-note-d', 'communication-note-e', 'communication-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
                if (checkedRadio) {
                    const grade = checkedRadio.value.toLowerCase();
                    row.classList.add("communication-note-" + grade);
                    if (grade === 'e' || grade === 'd') {
                        row.classList.add('lacune-rouge');
                    } else if (grade === 'c') {
                        row.classList.add('lacune-orange');
                    } else if (grade === 'a' || grade === 'b') {
                        row.classList.add('lacune-verte');
                    }
                } else {
                    row.classList.add('communication-not-answered');
                    row.classList.add('lacune-rouge');
                }
            });
        }

        function startTimer() {
            if (window.isRunning || window.currentMode !== 'exam') return;
            window.isRunning = true;
            window.hasStarted = true;
            window.hasStoppedManually = false;
            document.body.classList.add('timer-running');
            toggleCheckboxes(false);
            playSound("Début de la station");
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('stopBtn').style.display = 'inline-block';
            document.getElementById('resetBtn').disabled = true;
            document.getElementById('timerStatus').textContent = 'En cours';
            document.getElementById('timerStatus').className = 'timer-status status-running';
            
            window.timerInterval = setInterval(() => {
                window.currentSeconds--;
                document.getElementById('timerDisplay').textContent = formatTime(window.currentSeconds);
                const container = document.getElementById('timerContainer');
                if (window.currentSeconds === 2 * 60) {
                    if (window.currentMode === 'exam') {
                        playSound("Il vous reste 2 minutes");
                    }
                    container.classList.add('timer-warning');
                    document.getElementById('timerStatus').textContent = '2 min restantes';
                    document.getElementById('timerStatus').className = 'timer-status status-warning';
                }
                if (window.currentSeconds <= 30) {
                    container.classList.add('timer-critical');
                }
                if (window.currentSeconds <= 0) {
                    endTimer();
                }
            }, 1000);
        }

        function stopTimer() {
            if (!window.isRunning) return;
            clearInterval(window.timerInterval);
            window.isRunning = false;
            window.hasStoppedManually = true;
            document.body.classList.remove('timer-running');
            // Ne pas désactiver les checkboxes pour permettre de continuer à cocher après arrêt
            // toggleCheckboxes(true);
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            document.getElementById('resetBtn').disabled = false;
            document.getElementById('timerStatus').textContent = 'Arrêté';
            document.getElementById('timerStatus').className = 'timer-status';
            colorCriteriaByScore();
        }

        function endTimer() {
            clearInterval(window.timerInterval);
            window.isRunning = false;
            window.hasFinished = true;
            window.currentSeconds = 0;
            document.body.classList.remove('timer-running');
            if (window.currentMode === 'exam') {
                playSound("Fin de la station. Veuillez sortir");
                // Repasser automatiquement en mode révision après la fin du timer
                switchMode('revision');
            }
            document.getElementById('timerDisplay').textContent = '0:00';
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            document.getElementById('resetBtn').disabled = false;
            document.getElementById('timerStatus').textContent = 'Terminé';
            document.getElementById('timerStatus').className = 'timer-status status-finished';
            document.getElementById('timerStatus').style.display = 'block';
            document.getElementById('timerContainer').className = 'timer-container';
            // Ne pas désactiver les checkboxes après la fin pour permettre de continuer
            // toggleCheckboxes(true);
            colorCriteriaByScore();
        }

        function resetTimer() {
            clearInterval(window.timerInterval);
            window.timerInterval = null;
            window.currentSeconds = 13 * 60;
            window.isRunning = false;
            window.hasStarted = false;
            window.hasFinished = false;
            window.hasStoppedManually = false;
            document.getElementById('timerDisplay').textContent = '13:00';
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            // Supprimer la coloration des critères
            const criteriaAndCommRows = document.querySelectorAll('.criteria-row, .communication-section');
            criteriaAndCommRows.forEach(row => {
                row.classList.remove('score-0', 'score-1', 'score-2', 'score-a', 'score-b', 'score-c', 'score-d', 'score-e');
            });
            // Supprimer la coloration des sections
            const allSections = document.querySelectorAll('.section');
            allSections.forEach(section => {
                section.classList.remove('note-a', 'note-b', 'note-c', 'note-d', 'note-e');
                section.classList.add('note-neutral');
            });
            document.getElementById('timerStatus').style.display = 'none';
            document.getElementById('timerContainer').className = 'timer-container';
            // En mode révision, ne pas désactiver les checkboxes
            if (window.currentMode === 'exam') {
                toggleCheckboxes(true);
            }
            const allRadios = document.querySelectorAll('input[type="radio"]');
            allRadios.forEach(radio => {
                radio.checked = false;
            });
            // Réinitialiser les detail-checkboxes
            const allDetailCheckboxes = document.querySelectorAll('.detail-checkbox input[type="checkbox"]');
            allDetailCheckboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            const allPointsDisplays = document.querySelectorAll('.points-display');
            allPointsDisplays.forEach(display => {
                display.textContent = '0';
            });
            const allCriteriaRows = document.querySelectorAll('.criteria-row');
            allCriteriaRows.forEach(row => {
                row.classList.remove('criteria-zero-points', 'criteria-one-point', 'criteria-full-points', 'criteria-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
            });
            const allCommunicationRows = document.querySelectorAll('.communication-section');
            allCommunicationRows.forEach(row => {
                row.classList.remove('communication-note-a', 'communication-note-b', 'communication-note-c', 'communication-note-d', 'communication-note-e', 'communication-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
            });
            calculateScores();
            // Supprimer tous les commentaires et cacher les textareas
            const allTextareas = document.querySelectorAll('.comment-textarea');
            allTextareas.forEach(textarea => {
                textarea.value = '';
                textarea.style.height = textarea.classList.contains('comment-textarea') && textarea.closest('.section-comment-section.global') ? '30px' : (textarea.closest('.section-comment-section') ? '28px' : '26px');
            });
            // Cacher toutes les sections de commentaires ouvertes
            const allCommentSections = document.querySelectorAll('.criterion-comment-section.show, .section-comment-section.show');
            allCommentSections.forEach(section => {
                section.classList.remove('show');
            });
            // Mettre à jour les boutons de commentaires
            const allCommentButtons = document.querySelectorAll('.comment-button, .section-comment-button');
            allCommentButtons.forEach(button => {
                button.classList.remove('has-content');
            });
        }
        
        function switchMode(mode) {
            window.currentMode = mode;
            const body = document.body;
            body.className = mode + '-mode';
            const buttons = document.querySelectorAll('.mode-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            buttons.forEach(btn => {
                if (btn.textContent.includes(mode === "revision" ? "Révision" : "Examen")) {
                    btn.classList.add("active");
                }
            });
            if (mode === 'revision') {
                toggleCheckboxes(false);
                showLacunesButton();
            } else {
                if (!window.hasStarted) {
                    toggleCheckboxes(true);
                }
                hideLacunesButton();
            }
        }
        
        function showLacunesButton() {
            const btn = document.querySelector('.lacune-button');
            if (btn) btn.style.display = 'block';
        }
        
        function hideLacunesButton() {
            const btn = document.querySelector('.lacune-button');
            if (btn) btn.style.display = 'none';
        }
        
        function identifyLacunes() {
            // Critères standards (anamnèse, examen, management)
            const criteria = document.querySelectorAll(".criteria-row");
            criteria.forEach(criterion => {
                const id = criterion.id.replace("criteria-", "");
                const pointsElement = document.getElementById("points-" + id);
                const points = pointsElement ? parseInt(pointsElement.textContent) : 0;
                
                criterion.classList.remove("lacune-rouge", "lacune-orange", "lacune-verte");
                
                if (points === 0) {
                    criterion.classList.add("lacune-rouge");
                } else if (points === 1) {
                    criterion.classList.add("lacune-orange");
                } else if (points >= 2) {
                    criterion.classList.add("lacune-verte");
                }
            });
            
            // Critères communication (échelle A-E)
            const commCriteria = document.querySelectorAll(".communication-section");
            commCriteria.forEach(criterion => {
                const id = criterion.id.replace("criteria-", "");
                const radio = document.querySelector("input[name=\"" + id + "\"]:checked");
                
                criterion.classList.remove("lacune-rouge", "lacune-orange", "lacune-verte");
                
                if (!radio) {
                    criterion.classList.add("lacune-rouge");
                } else {
                    const grade = radio.value;
                    if (grade === "E" || grade === "D") {
                        criterion.classList.add("lacune-rouge");
                    } else if (grade === "C") {
                        criterion.classList.add("lacune-orange");
                    } else if (grade === "A" || grade === "B") {
                        criterion.classList.add("lacune-verte");
                    }
                }
            });
        }
        function toggleComment(id) {
            const section = document.getElementById("comment-section-" + id);
            const textarea = document.getElementById("comment-" + id);
            if (section) {
                section.classList.toggle("show");
                // Focus automatiquement sur le textarea quand on ouvre la section
                if (section.classList.contains("show") && textarea) {
                    textarea.focus();
                }
            }
        }

        function updateCommentButton(id) {
            const textarea = document.getElementById("comment-" + id);
            const criterionRow = document.getElementById("criteria-" + id);
            const commentSection = document.getElementById("comment-section-" + id);
            if (textarea && criterionRow) {
                const button = criterionRow.querySelector(".comment-button");
                if (button) {
                    if (textarea.value.trim()) {
                        button.classList.add("has-content");
                        if (commentSection) commentSection.classList.add("has-content");
                    } else {
                        button.classList.remove("has-content");
                        if (commentSection) commentSection.classList.remove("has-content");
                    }
                }
            }
        }

        function toggleSectionComment(section) {
            const commentSection = document.getElementById("section-comment-" + section);
            const textarea = document.getElementById("comment-section-" + section);
            if (commentSection) {
                commentSection.classList.toggle("show");
                // Focus automatiquement sur le textarea quand on ouvre la section
                if (commentSection.classList.contains("show") && textarea) {
                    textarea.focus();
                }
            }
        }

        function updateSectionComment(section) {
            const textarea = document.getElementById("comment-section-" + section);
            const commentSection = document.getElementById("section-comment-" + section);
            const buttons = document.querySelectorAll(".section-comment-button");
            buttons.forEach(button => {
                if (button.getAttribute("onclick") && button.getAttribute("onclick").includes(section)) {
                    if (textarea && textarea.value.trim()) {
                        button.classList.add("has-content");
                        if (commentSection) commentSection.classList.add("has-content");
                    } else {
                        button.classList.remove("has-content");
                        if (commentSection) commentSection.classList.remove("has-content");
                    }
                }
            });
        }

        function updateGeneralComment() {
            const textarea = document.getElementById("comment-general");
            if (textarea) {
                const section = textarea.closest(".section-comment-section");
                if (section) {
                    if (textarea.value.trim()) {
                        section.classList.add("has-content");
                    } else {
                        section.classList.remove("has-content");
                    }
                }
            }
        }

        function autoResizeTextarea(textarea) {
            // Reset height to auto to get correct scrollHeight
            textarea.style.height = "auto";
            // Set new height based on content
            const newHeight = textarea.scrollHeight + 2;
            textarea.style.height = newHeight + "px";
        }

    </script>
    <!-- BOUTON IMPRIMER EN PDF -->
    <button class="print-button" onclick="window.print()">🖨️ Imprimer en PDF</button>
    <script>
        // Appel final pour s'assurer que tout est coloré
        // Forcer la coloration finale
        if (window.colorPatientResponses) {
            window.colorPatientResponses();
        }
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USMLE Triage 6 - Troubles du Sommeil - Grille ECOS</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); }
        .header { background: #2c5aa0; color: white; padding: 15px; margin: -20px -20px 20px -20px; border-radius: 8px 8px 0 0; }
        .section { margin-bottom: 30px; border: 2px solid #ddd; border-radius: 8px; overflow: hidden; background-color: #ffffff; }
        .section-header { background: #f8f9fa; padding: 15px; font-weight: bold; font-size: 18px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; }
        .section-content { padding: 15px; background-color: #ffffff; }
        .header-row { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px; gap: 10px; padding: 10px 0; border-bottom: 2px solid #ddd; font-weight: bold; text-align: center; color: #333333; }
        .header-row.communication-header { grid-template-columns: 2fr 80px 80px 80px 80px 80px; }
        .header-row div:first-child { text-align: left; }
        .criteria-row { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px; gap: 10px; align-items: start; padding: 15px 0 15px 5px; border-bottom: 1px solid #eeeeee; }
        .criteria-row:last-child { border-bottom: none; }
        .criteria-text { font-weight: 500; }
        .sub-criteria { font-size: 0.9em; color: #333; margin-top: 5px; padding-left: 18px; line-height: 1.2; }
        .details-with-checkboxes { margin-top: 8px; }
        .detail-row { display: grid; grid-template-columns: 1fr 100px; align-items: center; padding: 2px 0 2px 18px; gap: 10px; line-height: 1.1; }
        .detail-text { font-size: 0.9em; color: #333; }
        .patient-response-highlight { color: rgb(44, 90, 160) !important; }
        .detail-text .patient-response-highlight { color: rgb(44, 90, 160) !important; }
        .criteria-detail .patient-response-highlight { color: rgb(44, 90, 160) !important; }
        .detail-checkboxes { text-align: center; }
        .detail-checkbox input[type="checkbox"] { cursor: pointer; transform: scale(1.1); }
        .patient-response { font-size: 0.9em; color: rgb(44, 90, 160); font-weight: 500; }
        .exemples-phrases { margin-top: 8px; padding-left: 20px; }
        .exemple-phrase { font-size: 0.9em; color: rgba(112, 188, 123, 0.95); font-style: italic; line-height: 1.4; margin: 3px 0; }
        .checkbox-group { text-align: center; }
        .points-display { text-align: center; font-weight: bold; color: #2c5aa0; font-size: 18px; }
        .scoring-rule { font-size: 0.85em; color: #888; font-style: italic; margin-top: 8px; padding-left: 20px; }
        .criteria-subheader { background: #fffbe6; padding: 10px 15px; margin: 10px 0 5px 0; border-left: 4px solid #faad14; font-weight: bold; color: #8b6914; }
        input[type="radio"] { cursor: pointer; transform: scale(1.2); }
        input[type="radio"]:disabled { opacity: 0.3; cursor: not-allowed; }
        .score { font-weight: bold; color: hsl(216, 57%, 40%); font-size: 18px; }
        .total-sections { display: grid; grid-template-columns: 1fr 2fr 1fr; gap: 20px; margin-bottom: 30px; }
        .total-section { display: flex; flex-direction: column; justify-content: space-between; text-align: center; background: #f0f8ff; border: 1px solid #ddd; border-radius: 8px; transition: all 0.3s; }
        .total-label { background: #f8f9fa; padding: 5px; font-weight: bold; font-size: 20px; border-bottom: 1px solid #ddd; }
        .total-body { flex: 1; display: flex; align-items: center; justify-content: center; padding: 5px; }
        .total-pourcent-body { flex: 1; padding: 10px; }
        .total-score, .total-note-globale { font-size: 56px; font-weight: bold; line-height: 1; }
        .total-pourcent-sections { display: flex; flex-wrap: nowrap; gap: 10px; height: 100%; align-items: stretch; }
        .total-pourcent-section { flex: 1 1 auto; min-width: 0; display: flex; flex-direction: column; text-align: center; background: #416caa; padding: 10px; border-radius: 5px; transition: all 0.3s; border: none; }
        .total-pourcent-section:last-child { border-right: none; }
        .total-section-label { color: #eeeeee; font-size: 14px; font-weight: normal; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .pourcent-body { flex: 1; display: flex; align-items: center; justify-content: center; }
        .total-pourcent-value { font-weight: bold; font-size: 28px; line-height: 1; color: white; transition: all 0.3s; }
        .note-a { background-color: #e6f4ea; color: #2c974b; }
        .note-a.total-pourcent-section { background-color: #2c974b; }
        .note-b { background-color: #e9f3fd; color: #4e9cf0; }
        .note-b.total-pourcent-section { background-color: #4e9cf0; }
        .note-c { background-color: #fdf5e6; color: #f0ad4e; }
        .note-c.total-pourcent-section { background-color: #f0ad4e; }
        .note-d { background-color: #fceee3; color: #e67e22; }
        .note-d.total-pourcent-section { background-color: #e67e22; }
        .note-e { background-color: #fbeaea; color: #d9534f; }
        .note-e.total-pourcent-section { background-color: #d9534f; }
        .note-neutral { background-color: #f0f8ff; color: #2c5aa0; }
        .note-neutral.total-pourcent-section { background-color: #6B8BC3; }
        .note-a.total-pourcent-body { background-color: #e6f4ea; }
        .note-b.total-pourcent-body { background-color: #e9f3fd; }
        .note-c.total-pourcent-body { background-color: #fdf5e6; }
        .note-d.total-pourcent-body { background-color: #fceee3; }
        .note-e.total-pourcent-body { background-color: #fbeaea; }
        .note-neutral.total-pourcent-body { background-color: #f0f8ff; }
        /* Styles pour les sections avec coloration selon le score */
        .section.note-a { border-color: #2c974b; }
        .section.note-a .section-header { background-color: #e6f4ea; color: #2c974b; }
        .section.note-b { border-color: #4e9cf0; }
        .section.note-b .section-header { background-color: #e9f3fd; color: #4e9cf0; }
        .section.note-c { border-color: #f0ad4e; }
        .section.note-c .section-header { background-color: #fdf5e6; color: #f0ad4e; }
        .section.note-d { border-color: #e67e22; }
        .section.note-d .section-header { background-color: #fceee3; color: #e67e22; }
        .section.note-e { border-color: #d9534f; }
        .section.note-e .section-header { background-color: #fbeaea; color: #d9534f; }
        .section.note-neutral { border-color: #ddd; }
        .section.note-neutral .section-header { background-color: #f8f9fa; color: #333333; }
        /* Styles pour les crit√®res individuels */
        .criteria-row.score-2 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-2 .criteria-text { color: #2c974b; }
        .criteria-row.score-max { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-max .criteria-text { color: #2c974b; }
        .criteria-row.score-1 { background-color: rgba(240, 173, 78, 0.1); }
        .criteria-row.score-1 .criteria-text { color: #f0ad4e; }
        .criteria-row.score-0 { background-color: rgba(217, 83, 79, 0.1); }
        .criteria-row.score-0 .criteria-text { color: #d9534f; }
        .criteria-row:not(.score-0):not(.score-1):not(.score-2):not(.score-max) .criteria-text { color: #000; }
        /* Styles suppl√©mentaires pour les scores plus √©lev√©s */
        .criteria-row.score-3 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-3 .criteria-text { color: #2c974b; }
        .criteria-row.score-4 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-4 .criteria-text { color: #2c974b; }
        .criteria-row.score-5 { background-color: rgba(44, 151, 75, 0.1); }
        .criteria-row.score-5 .criteria-text { color: #2c974b; }
        .communication-section.score-a { background-color: rgba(44, 151, 75, 0.1); }
        .communication-section.score-a .communication-text { color: #2c974b; }
        .communication-section.score-b { background-color: rgba(78, 156, 240, 0.1); }
        .communication-section.score-b .communication-text { color: #4e9cf0; }
        .communication-section.score-c { background-color: rgba(240, 173, 78, 0.1); }
        .communication-section.score-c .communication-text { color: #f0ad4e; }
        .communication-section.score-d { background-color: rgba(230, 126, 34, 0.1); }
        .communication-section.score-d .communication-text { color: #e67e22; }
        .communication-section.score-e { background-color: rgba(217, 83, 79, 0.1); }
        .communication-section.score-e .communication-text { color: #d9534f; }
        .grade-scale { margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; }
        .grade-scale h3 { margin-top: 0; }
        .grade-row { display: flex; justify-content: space-between; padding: 5px 0; }
        .missing-items { display: none !important; }
        .missing-items h3 { margin-top: 0; }
        .missing-item { color: #dc3545; font-weight: bold; }
        .redflags-main-section { margin-top: 30px; padding: 20px; background: #fff5f5; border-radius: 8px; border: 1px solid #f5c6cb; }
        .redflags-main-section h3 { margin-top: 0; border-bottom: 2px solid #f5c6cb; padding-bottom: 10px; }
        .redflags-category-section { margin: 15px 0; padding: 10px; background: white; border-radius: 5px; border-left: 4px solid #dc3545; }
        .annexes { margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #ddd; }
        .annexes h3 { margin-top: 0; color: #2c5aa0; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        .annexes-grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin-top: 20px; }
        .annexe-item { padding: 15px; background: white; border-radius: 5px; border: 1px solid #e0e0e0; }
        .annexe-title { font-weight: bold; color: #2c5aa0; margin-bottom: 8px; font-size: 16px; }
        .annexe-description { color: #666; font-style: italic; margin-bottom: 10px; font-size: 14px; }
        .annexe-image { text-align: center; margin: 10px 0; }
        .annexe-image img { max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .annexe-document { background: #f0f8ff; padding: 10px; border-radius: 4px; border-left: 4px solid #2c5aa0; white-space: pre-wrap; font-family: "Courier New", monospace; font-size: 13px; }
        
        /* Styles pour le sc√©nario de la patiente standardis√©e */
        .annexe-scenario { grid-column: 1 / -1; max-width: none; }
        .annexe-scenario-content { padding: 15px; background: #fafafa; border-radius: 4px; }
        .scenario-info { background: #e8f4f8; padding: 10px 15px; border-radius: 4px; margin-bottom: 15px; font-size: 15px; }
        .scenario-section { margin-bottom: 20px; }
        .scenario-subsection { margin-bottom: 15px; }
        .scenario-subsection strong { color: #2c5aa0; }
        .scenario-section h4 { color: #2c5aa0; margin: 15px 0 10px 0; font-size: 16px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        .scenario-section ul { margin: 10px 0; padding-left: 25px; }
        .scenario-section li { margin: 5px 0; line-height: 1.5; }
        .scenario-subsection { margin: 10px 0 15px 0; }
        .scenario-subsection strong { color: #555; }
        .scenario-subsection ul { margin-top: 5px; }
        
        /* Styles pour les interventions de l'expert */
        .annexe-interventions { grid-column: 1 / -1; max-width: none; }
        .annexe-interventions-content { padding: 15px; }
        .intervention-item { background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 12px; margin-bottom: 12px; }
        .intervention-header { font-size: 15px; margin-bottom: 8px; color: #856404; }
        .intervention-moment { font-weight: normal; font-style: italic; color: #666; }
        .intervention-instruction { margin: 8px 0; color: #333; }
        .intervention-message { background: #fff; padding: 8px 12px; border-left: 3px solid #ffc107; font-style: italic; color: #721c24; margin-top: 8px; }
        
        /* Styles pour les informations de l'expert */
        .annexe-informations-expert { grid-column: 1 / -1; max-width: none; }
        .annexe-informations-content { padding: 15px; background: #f5f5f5; border-radius: 4px; }
        .info-section { margin-bottom: 20px; }
        .info-section:last-child { margin-bottom: 0; }
        .info-section h4 { color: #2c5aa0; margin: 0 0 10px 0; font-size: 16px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        .info-section h5 { color: #4a7ba7; margin: 15px 0 8px 0; font-size: 14px; font-weight: 600; }
        .info-section p { margin: 10px 0; line-height: 1.6; }
        .info-section ul { margin: 10px 0; padding-left: 25px; }
        .info-section li { margin: 5px 0; line-height: 1.5; }
        
        /* Styles pour les diagnostics diff√©rentiels dans annexes */
        .annexe-dd-section { grid-column: 1 / -1; max-width: none; }
        .annexe-dd-content { padding: 15px; background: #fff5f0; border-radius: 4px; }
        .dd-category { margin-bottom: 20px; }
        .dd-category:last-child { margin-bottom: 0; }
        .dd-category h4 { color: #a92117; margin: 0 0 15px 0; font-size: 16px; border-bottom: 1px solid #e0d0c8; padding-bottom: 5px; }
        .dd-items { display: flex; flex-direction: column; gap: 15px; }
        .dd-item { background: white; border: 1px solid #e5e5e5; border-radius: 4px; padding: 12px; }
        .dd-item-header { margin-bottom: 8px; }
        .dd-diagnosis { color: #a92117; font-weight: 600; font-size: 15px; }
        .dd-cause { margin-bottom: 8px; line-height: 1.5; font-size: 14px; }
        .dd-test { font-size: 14px; margin-top: 5px; }
        
        /* Styles pour la th√©orie pratique */
        .annexe-theorie-pratique { grid-column: 1 / -1; max-width: none; }
        .annexe-theorie-content { padding: 15px; background: #f0f5ff; border-radius: 4px; }
        .theorie-text { line-height: 1.6; color: #333; }
        .theorie-section { margin-bottom: 20px; }
        .theorie-section:last-child { margin-bottom: 0; }
        .theorie-section h4 { color: #1a4b84; margin: 0 0 10px 0; font-size: 16px; }
        .theorie-section p { margin: 10px 0; line-height: 1.6; }
        .theorie-section ul { margin: 10px 0; padding-left: 25px; }
        .theorie-section li { margin: 5px 0; line-height: 1.5; }
        /* Styles pour rappels th√©rapeutiques et examens compl√©mentaires */
        .annexe-rappels-therapeutiques, .annexe-examens-complementaires { grid-column: 1 / -1; max-width: none; }
        .rappels-list, .examens-list { margin: 0; padding-left: 25px; }
        .rappels-list li, .examens-list li { margin: 8px 0; line-height: 1.6; color: #333; }
        .annexe-rappels-therapeutiques .annexe-title { color: #998800; }
        .annexe-examens-complementaires .annexe-title { color: #346929; }
        
        /* Styles pour le tableau clinique */
        .tableau-clinique { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 14px; }
        .tableau-clinique thead { background-color: #2c5aa0; color: white; }
        .tableau-clinique th { padding: 10px; text-align: left; border: 1px solid #ddd; }
        .tableau-clinique tbody tr:nth-child(even) { background-color: #f9f9f9; }
        .tableau-clinique tbody tr:hover { background-color: #e8f4f8; }
        .tableau-clinique td { padding: 8px; border: 1px solid #ddd; }
        
        .communication-section { display: grid; grid-template-columns: 2fr 80px 80px 80px 80px 80px; gap: 10px; align-items: start; padding: 15px 0 15px 5px; border-bottom: 1px solid #eee; }
        .communication-text { font-weight: 500; }
        .communication-desc { font-size: 0.85em; color: #666; margin-top: 5px; font-style: italic; }
        /* Section Cl√¥ture */
        .cloture-section { margin-bottom: 20px; }
        .cloture-section .section-header { background-color: #f0f4f8; }
        .cloture-item { margin-bottom: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 5px; }
        .cloture-title { color: #2c5aa0; margin: 0 0 10px 0; font-size: 16px; font-weight: bold; }
        .cloture-content { color: #333; line-height: 1.6; font-style: italic; }
        .cloture-content-green { color: rgb(112, 188, 123); font-weight: 500; }
        .communication-desc-detail { font-size: 0.8em; color: #666; margin-left: 20px; font-style: normal; }
        .vital-signs { margin-top: 10px; margin-bottom: 0px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; font-size: 0.9em; }
        .vital-sign { text-align: center; background: #416caa; padding: 10px; border-radius: 5px; }
        .vital-sign-label { color: #eeeeee; }
        .vital-sign-value { color: rgb(255, 255, 255); margin-top: 2px; }
        .dd-section { background: #f0f8ff; padding: 15px; margin: 0 0 10px 0; border-radius: 5px; }
        .dd-title { font-weight: bold; margin-bottom: 10px; color: #2c5aa0; }
        .dd-category { margin: 10px 0; font-weight: bold; color: #2c5aa0; }
        .dd-item { margin-left: 20px; margin-top: 5px; font-weight: bold; color: rgb(169, 34, 23); }
        .dd-test { color: #666; font-style: italic; margin-left: 10px; }
        .therapy-section { background: rgba(255, 250, 230, 0.4); padding: 10px 10px 0 20px; margin: 0; border-radius: 5px; color: #000; }
        .therapy-title { font-weight: bold; margin-bottom: 5px; color: #998800; }
        .redflags-section { background: #fff5f5; padding: 10px; margin: 5px 0; border-radius: 5px; }
        .redflags-title { font-weight: bold; margin-bottom: 8px; color: #dc3545; }
        .redflags-item { margin-bottom: 6px; padding-left: 22px; }
        .redflags-text { color: #dc3545; font-weight: 500; }
        .redflags-description { color: #666; font-size: 0.9em; margin-top: 2px; margin-left: 20px; }
        .annexes { margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #ddd; }
        .annexes h3 { margin-top: 0; color: #2c5aa0; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        .annexes-grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin-top: 20px; }
        .annexe-item { padding: 15px; background: white; border-radius: 5px; border: 1px solid #e0e0e0; }
        .annexe-title { font-weight: bold; color: #2c5aa0; margin-bottom: 8px; font-size: 16px; }
        .annexe-description { color: #666; font-style: italic; margin-bottom: 10px; font-size: 14px; }
        .annexe-image { text-align: center; margin: 10px 0; }
        .annexe-image img { max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .annexe-document { background: #f0f8ff; padding: 10px; border-radius: 4px; border-left: 4px solid #2c5aa0; white-space: pre-wrap; font-family: "Courier New", monospace; font-size: 13px; }
        
        /* MINUTEUR */
        .timer-container {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.75);
            border: 3px solid #2c5aa0;
            border-radius: 15px;
            padding: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            z-index: 1000;
            text-align: center;
            min-width: 200px;
        }
        .timer-display {
            font-size: 40px;
            font-weight: bold;
            color: #2c5aa0;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
        }
        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
        }
        .timer-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
            font-size: 14px;
        }
        .start-btn {
            background: #28a745;
            color: white;
        }
        .start-btn:hover {
            background: #218838;
        }
        .stop-btn {
            background: #dc3545;
            color: white;
        }
        .stop-btn:hover {
            background: #c82333;
        }
        .reset-btn {
            background: #6c757d;
            color: white;
        }
        .reset-btn:hover {
            background: #5a6268;
        }
        .timer-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .timer-btn:disabled:hover {
            background: #6c757d;
        }
        .timer-status {
            font-size: 14px;
            font-weight: bold;
            margin-top: 10px;
            padding: 5px 10px;
            border-radius: 5px;
        }
        .status-running {
            background: #e3f2fd;
            color: #1976d2;
        }
        .status-warning {
            background: #fff3cd;
            color: #ff6f00;
        }
        .status-finished {
            background: #f8d7da;
            color: #721c24;
        }
        .timer-warning {
            animation: pulse-warning 2s infinite;
        }
        .timer-critical {
            animation: pulse-critical 1s infinite;
        }
        @keyframes pulse-warning {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes pulse-critical {
            0%, 100% { transform: scale(1); border-color: #dc3545; }
            50% { transform: scale(1.1); border-color: #ff0000; }
        }
        
        /* COLORATION POST-MINUTEUR */
        .criteria-zero-points {
            background-color: rgba(251, 234, 234, 0.6) !important;
        }
        .criteria-one-point {
            background-color: rgba(253, 245, 230, 0.6) !important;
        }
        .criteria-full-points {
            background-color: rgba(230, 244, 234, 0.6) !important;
        }
        .criteria-not-answered {
            background-color: rgba(240, 248, 255, 0.6) !important;
        }
        
        /* COLORATION COMMUNICATION */
        .communication-note-a {
            background-color: rgba(230, 244, 234, 0.6) !important;
        }
        .communication-note-b {
            background-color: rgba(233, 243, 253, 0.6) !important;
        }
        .communication-note-c {
            background-color: rgba(253, 245, 230, 0.6) !important;
        }
        .communication-note-d {
            background-color: rgba(252, 238, 227, 0.6) !important;
        }
        .communication-note-e {
            background-color: rgba(251, 234, 234, 0.6) !important;
        }
        .communication-not-answered {
            background-color: rgba(240, 248, 255, 0.6) !important;
        }
        
        /* MODE SELECTOR */
        .mode-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 2px solid #2c5aa0;
            border-radius: 30px;
            padding: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1001;
            display: flex;
            gap: 5px;
        }
        .mode-button {
            padding: 8px 16px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            background: transparent;
            color: #2c5aa0;
        }
        .mode-button.active {
            background: #2c5aa0;
            color: white;
        }
        .mode-button:hover:not(.active) {
            background: #e8f0fe;
        }
        
        /* Mode-specific hiding and showing - CORRIG√â */
        .revision-mode .timer-container {
            display: none !important;
        }
        .exam-mode .timer-container {
            display: block !important;
        }
        .exam-mode .revision-controls {
            display: none !important;
        }
        /* Masquer les descriptions et titres d'annexes en mode examen quand le timer est actif */
        .exam-mode.timer-running .annexe-item .annexe-title,
        .exam-mode.timer-running .annexe-item .annexe-description {
            display: none !important;
        }
        
        /* Revision controls */
        .revision-controls {
            position: fixed;
            top: 70px;
            right: 20px;
            background: white;
            border: 2px solid #4CAF50;
            border-radius: 30px;
            padding: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            gap: 5px;
            z-index: 1000;
        }
        .lacune-button {
            background: transparent;
            color: #4CAF50;
            border: none;
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }
        .lacune-button:hover {
            background: #4CAF50;
            color: white;
        }
        .reset-revision-button {
            background: transparent;
            color: #6c757d;
            border: none;
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }
        .reset-revision-button:hover {
            background: #6c757d;
            color: white;
        }
        
        /* Styles pour les commentaires discrets */
        .comment-button { 
            background: none; 
            border: none; 
            color: #2c5aa0; 
            cursor: pointer; 
            font-size: 14px; 
            padding: 2px 6px; 
            margin-left: 8px; 
            border-radius: 3px; 
            opacity: 0.6;
            transition: all 0.2s;
        }
        .comment-button:hover { opacity: 1; background: rgba(44, 90, 160, 0.1); }
        .comment-button.has-content { opacity: 1; color: #d9534f; }
        .criterion-comment-section { 
            display: none; 
            margin: 8px 0 12px 20px; 
            padding: 10px; 
            background: #fafafa; 
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .criterion-comment-section.show { display: block; }
        .section-comment-button {
            background: rgba(44, 90, 160, 0.1);
            border: 1px solid #2c5aa0;
            color: #2c5aa0;
            cursor: pointer;
            font-size: 12px;
            padding: 4px 8px;
            margin-left: 10px;
            border-radius: 15px;
            opacity: 0.8;
            transition: all 0.2s;
            font-weight: 500;
        }
        .section-comment-button:hover { 
            opacity: 1; 
            background: rgba(44, 90, 160, 0.2); 
            transform: scale(1.05);
        }
        .section-comment-button.has-content { 
            background: rgba(220, 53, 69, 0.1);
            border-color: #d9534f;
            color: #d9534f; 
        }
        .section-comment-section { 
            display: none;
            margin: 20px 0; 
            padding: 12px; 
            background: #f8f9fa; 
            border-radius: 6px;
        }
        .section-comment-section.show { display: block; }
        .section-comment-section.global { 
            display: block; 
            background: #f0f8ff; 
        }
        /* La section commentaire global reste toujours visible sauf √† l'impression */
        .comment-textarea { 
            width: calc(100% - 0px); 
            min-height: 26px; 
            padding: 5px; 
            margin-right: 0px;
            border: 1px solid #ddd; 
            border-radius: 3px; 
            font-family: Arial, sans-serif;
            font-size: 12px; 
            resize: vertical;
            box-sizing: border-box;
            overflow-y: hidden;
            color: #7b3f00;
            height: 26px;
        }
        .section-comment-section .comment-textarea {
            min-height: 28px;
            font-size: 14px;
            height: 28px;
        }
        .section-comment-section.global .comment-textarea {
            min-height: 30px;
            font-size: 16px;
            height: 30px;
        }
        .comment-textarea:focus {
            outline: none;
            border-color: #2c5aa0;
            box-shadow: 0 0 0 2px rgba(44, 90, 160, 0.1);
        }
        
        /* Masquer les boutons √† l'impression */
        @media print {
            .comment-button,
            .section-comment-button {
                display: none !important;
            }
            .criterion-comment-section:not(.has-content),
            .section-comment-section:not(.has-content) {
                display: none !important;
            }
            .criterion-comment-section.has-content,
            .section-comment-section.has-content {
                display: block !important;
                page-break-inside: avoid;
            }
        }
        
        /* Styles pour les lacunes */
        .lacune-rouge {
            background-color: #ffebee !important;
        }
        .lacune-orange {
            background-color: #fff3e0 !important;
        }
        .lacune-verte {
            background-color: #e8f5e8 !important;
        }
        
        /* Bouton d'impression */
        .print-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2c5aa0;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 4px 12px rgba(44, 90, 160, 0.3);
            z-index: 1000;
        }
        .print-button:hover {
            background: #1e3f70;
        }
        @media print {
            /* Masquer les √©l√©ments interactifs */
            .print-button, .mode-selector, .revision-controls, .missing-items { display: none !important; }
            .comment-button, .section-comment-button { display: none !important; }
            /* IMPORTANT: MASQUER LE MINUTEUR √† L'IMPRESSION! */
            .timer-container {
                display: none !important;
                visibility: hidden !important;
                position: absolute !important;
                left: -9999px !important;
            }
            /* Supprimer les bordures gauches √† l'impression */
            .criteria-row { border-left: none !important; }
            .communication-section { border-left: none !important; }
            .lacune-rouge { border-left: none !important; }
            .lacune-orange { border-left: none !important; }
            .lacune-verte { border-left: none !important; }
            
            /* Gestion des commentaires √† l'impression */
            .criterion-comment-section:not(.has-content),
            .section-comment-section:not(.has-content) { display: none !important; }
            .section-comment-section.global:not(.has-content) { display: none !important; }
            .criterion-comment-section.has-content,
            .section-comment-section.has-content { display: block !important; }
            
            /* Les textareas conservent leur hauteur actuelle √† l'impression */
            .comment-textarea {
                border: 1px solid #ccc !important;
                background: white !important;
                padding: 4px !important;
                margin-right: 15px !important;
                resize: none !important;
                font-size: 8pt !important;
                font-family: Arial, sans-serif !important;
                font-style: italic !important;
                color: #333 !important;
                border-radius: 2px !important;
                /* Conserver la hauteur actuelle */
                overflow: hidden !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            /* Sections commentaires */
            .criterion-comment-section {
                page-break-inside: avoid;
                margin: 6px 0 8px 15px !important;
                padding: 6px 8px !important;
                background: #f9f9f9 !important;
                border-left: 2px solid #666 !important;
                border-radius: 0 3px 3px 0 !important;
                box-shadow: none !important;
            }
            
            /* Cacher les sections de commentaires vides */
            .criterion-comment-section:not(.show) {
                display: none !important;
            }
            .criterion-comment-section.show:not(.has-content) {
                display: none !important;
            }
            
            .section-comment-section {
                page-break-inside: avoid;
                margin: 5px 0 10px 0 !important;
                padding: 6px 8px !important;
                background: #f5f5f5 !important;
                border: 1px solid #ccc !important;
                border-radius: 4px !important;
            }
            
            /* Cacher toutes les sections de commentaires vides √† l'impression */
            .section-comment-section {
                display: none !important;
            }
            /* Montrer seulement les sections avec contenu */
            .section-comment-section.has-content {
                display: block !important;
            }
            
            /* Configuration de la page */
            @page { size: A4; margin: 10mm 9mm 10mm 10mm; }
            body { margin: 0; background: white !important; font-size: 9pt; }
            
            /* Optimisation du container et des marges */
            .container { 
                max-width: 100%; 
                margin: 0; 
                box-shadow: none; 
                padding: 0; 
                background: white !important;
            }
            
            /* Gestion du header pour qu'il ne soit jamais seul */
            .header { 
                page-break-after: avoid; 
                margin: 0;
                margin-bottom: 10px;
                padding: 10px;
                font-size: 8pt;
            }
            .header h1 { font-size: 14pt; margin: 0 0 5px 0; }
            
            /* Optimisation des signes vitaux */
            .vital-signs { gap: 10px; margin: 5px 0; }
            .vital-sign { padding: 5px; font-size: 8pt; }
            
            /* Forcer l'anamn√®se √† commencer sur la page 1 */
            .section:first-of-type { page-break-before: avoid !important; }
            .section:first-of-type .section-header { 
                page-break-after: avoid; 
                min-height: 20px;
            }
            .section:first-of-type .criteria-row:first-child { 
                page-break-before: avoid !important; 
            }
            
            /* Les autres sections peuvent se diviser si n√©cessaire */
            .section { 
                page-break-inside: auto; 
                margin-bottom: 15px;
            }
            .section-header { 
                page-break-after: avoid;
                font-size: 12pt;
                padding: 8px;
            }
            .section-content { padding: 8px; }
            
            /* Optimisation de la grille */
            .header-row { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px; 
                font-size: 8pt;
            }
            .header-row.communication-header { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px 60px; 
                padding: 5px 0;
            }
            .criteria-row { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px; 
                page-break-inside: avoid;
                padding: 8px 0 8px 5px;
            }
            .criteria-text { font-size: 8.5pt; line-height: 1.1 !important; }
            .sub-criteria { font-size: 7.5pt; padding-left: 15px; line-height: 1.1 !important; }
            .detail-row { font-size: 7.5pt; padding: 1px 0 1px 15px; line-height: 1.0; }
            .detail-text { font-size: 7.5pt; line-height: 1.1 !important; }
            .patient-response { font-size: 7.5pt; }
            .points-display { font-size: 14px; }
            
            /* Communication section */
            .communication-section-container {
                page-break-inside: avoid !important;
            }
            
            /* Cloture section */
            .cloture-section {
                page-break-inside: avoid !important;
            }
            .cloture-item {
                page-break-inside: avoid !important;
                margin-bottom: 10px;
                padding: 10px;
            }
            .cloture-title { font-size: 10pt; }
            .cloture-content { font-size: 8.5pt; line-height: 1.2 !important; }
            .communication-section { 
                grid-template-columns: 2.5fr 60px 60px 60px 60px 60px;
                padding: 8px 0;
            }
            .communication-text { font-size: 8.5pt; }
            .communication-desc { font-size: 7pt; }
            
            /* Optimisation des sections sp√©ciales */
            .dd-section { padding: 8px; margin: 0 0 5px 0; font-size: 8pt; }
            .dd-title { font-size: 9pt; }
            .dd-item { font-size: 8pt; margin-left: 15px; }
            
            .therapy-section { 
                padding: 8px; 
                margin: 0; 
                font-size: 8pt;
                background: rgba(255, 250, 230, 0.3) !important;
                color: #000 !important;
            }
            .therapy-title { font-size: 9pt; }
            
            .redflags-section { padding: 8px; margin: 5px 0; }
            .redflags-title { font-size: 9pt; }
            .redflags-text { font-size: 8.5pt; }
            .redflags-description { font-size: 7.5pt; }
            
            /* Optimisation des totaux */
            .total-sections { 
                gap: 6px;
                margin-bottom: 6px;
            }
            .total-label { 
                padding: 4px;
                font-size: 16px;
                border-radius: 8px 8px 0 0;
            }
            .total-body {
                padding: 3px;
                border-radius: 0 0 8px 8px;
            }
            .total-score,
            .total-note-globale {
                font-size: 32px;
            }
            .total-pourcent-body {
                padding: 6px;
                border-radius: 0 0 8px 8px;
            }
            .total-pourcent-sections {
                display: flex;
                flex-wrap: nowrap;
                gap: 4px;
                align-items: stretch;
            }
            .total-pourcent-section {
                flex: 0 0 auto;
                min-width: 60px;
                padding: 6px 8px;
                white-space: nowrap;
            }
            .total-section-label {
                font-size: 11px;
                margin-bottom: 3px;
                white-space: nowrap;
            }
            .total-pourcent-value {
                font-size: 20px;
            }
            .pourcent-body {
                padding: 2px 0;
            }
            
            /* √âchelle de notation */
            .grade-scale { 
                padding: 10px; 
                margin-top: 15px;
                page-break-inside: avoid;
            }
            .grade-scale h3 { font-size: 11pt; margin: 0 0 5px 0; }
            .grade-row { padding: 3px 0; font-size: 8pt; }
            
            /* Optimisations pour les annexes √† l'impression */
            .annexes { 
                page-break-before: always !important;
                margin-top: 0 !important;
                padding-top: 15px !important;
            }
            
            .annexes-grid { 
                display: grid !important; 
                grid-template-columns: repeat(2, 1fr) !important; 
                gap: 15px !important; 
                margin-top: 15px !important; 
            }
            
            .annexe-item { 
                page-break-inside: avoid !important;
                padding: 15px !important;
                border: 1px solid #ddd !important;
            }
            
            .annexe-title { 
                font-size: 10pt !important;
                margin-bottom: 5px !important;
            }
            
            .annexe-description { 
                font-size: 8pt !important;
                line-height: 1.3 !important;
                margin-bottom: 8px !important;
            }
            
            /* R√©duire l'interligne des detail-row */
            .detail-row { 
                line-height: 1.1 !important; 
                padding: 2px 0 2px 15px !important;
            }
            
            /* R√©duire et ajuster les checkboxes des d√©tails */
            .detail-checkboxes { 
                text-align: right !important;
                padding-right: 5px !important;
            }
            .detail-checkbox input[type="checkbox"] { 
                transform: scale(0.8) !important;
                margin: 0 !important;
            }
            
            /* Page-break pour DD section et th√©orie pratique */
            .annexe-dd-section,
            .annexe-theorie-pratique { 
                page-break-before: always !important; 
            }
            
            /* Pas de page-break dans les scenario-section */
            .scenario-section, 
            .scenario-subsection { 
                page-break-inside: avoid !important; 
            }
            
            /* R√©duire l'interligne dans toutes les annexes */
            .annexe-scenario-content,
            .annexe-interventions-content,
            .annexe-informations-content,
            .annexe-theorie-content { 
                line-height: 1.15 !important; 
            }
            
            /* Styles sp√©cifiques pour les sections du sc√©nario */
            .scenario-section {
                margin-bottom: 8px !important;
                padding: 4px !important;
            }
            
            .scenario-section h4 {
                font-size: 9.5pt !important;
                margin: 0 0 4px 0 !important;
                line-height: 1.1 !important;
                color: #2c5aa0 !important;
            }
            
            .scenario-subsection {
                margin-bottom: 4px !important;
                line-height: 1.1 !important;
            }
            
            .scenario-subsection strong {
                font-size: 8pt !important;
                color: #333 !important;
            }
            
            /* Listes dans les annexes */
            .annexe-scenario-content ul,
            .annexe-interventions-content ul,
            .annexe-informations-content ul,
            .annexe-theorie-content ul,
            .scenario-section ul,
            .scenario-subsection ul {
                margin: 2px 0 !important;
                padding-left: 16px !important;
            }
            
            .annexe-scenario-content li,
            .annexe-interventions-content li,
            .annexe-informations-content li,
            .annexe-theorie-content li,
            .scenario-section li,
            .scenario-subsection li {
                margin-bottom: 1px !important;
                line-height: 1.1 !important;
                font-size: 7.5pt !important;
            }
            
            /* Texte dans les sections */
            .scenario-section p,
            .scenario-subsection p {
                margin: 2px 0 !important;
                line-height: 1.1 !important;
                font-size: 7.5pt !important;
            }
            
            /* Info de base du patient */
            .scenario-info {
                font-size: 8pt !important;
                padding: 6px !important;
                margin-bottom: 8px !important;
                line-height: 1.2 !important;
            }
            
            /* Forcer les couleurs */
            * { 
                -webkit-print-color-adjust: exact !important; 
                print-color-adjust: exact !important; 
            }
            
            /* Fond blanc partout */
            body, .container, .section, .section-content { background: white !important; }
            
        }
    </style>
</head>
<body class="revision-mode">
    <!-- MODE SELECTOR -->
    <div class="mode-selector">
        <button class="mode-button active" onclick="switchMode('revision')">üîç R√©vision</button>
        <button class="mode-button" onclick="switchMode('exam')">üìù Examen</button>
    </div>
    
    <!-- BOUTONS R√âVISION (Mode R√©vision uniquement) -->
    <div class="revision-controls">
        <button class="lacune-button" onclick="identifyLacunes()">üéØ Identifier les lacunes</button>
        <button class="reset-revision-button" onclick="resetTimer()">‚Üª Reset</button>
    </div>
    
    <!-- MINUTEUR ECOS -->
    <div class="timer-container" id="timerContainer">
        <div class="timer-display" id="timerDisplay">13:00</div>
        <div class="timer-controls">
            <button id="startBtn" class="timer-btn start-btn" onclick="startTimer()">‚ñ∂ D√©marrer</button>
            <button id="stopBtn" class="timer-btn stop-btn" onclick="stopTimer()" style="display: none;">‚è∏ Arr√™ter</button>
            <button id="resetBtn" class="timer-btn reset-btn" onclick="resetTimer()">‚Üª Reset</button>
        </div>
        <div class="timer-status" id="timerStatus" style="display: none;"></div>
    </div>

    <div class="container">
        <div class="header">
            <h1>Grille d'√©valuation ECOS - USMLE Triage 6 - Troubles du Sommeil</h1>
            <p style="margin: 5px 0;">üìç Clinique de m√©decine g√©n√©rale</p>
            <p style="margin: 5px 0;">üë§ Pej Lei, un homme de 33 ans, s'est pr√©sent√© √† la consultation externe pour des probl√®mes de sommeil.</p>
            <div class="vital-signs">
                <div class="vital-sign">
                    <div class="vital-sign-label">TA</div>
                    <div class="vital-sign-value">122/78 mmHg</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">FC</div>
                    <div class="vital-sign-value">60 bpm</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">FR</div>
                    <div class="vital-sign-value">12/min</div>
                </div>
                <div class="vital-sign">
                    <div class="vital-sign-label">T¬∞</div>
                    <div class="vital-sign-value">36.8¬∞C</div>
                </div>
            </div>
        </div>
        <!-- ANAMN√àSE -->
        <div class="section">
            <div class="section-header">
                <span>Anamn√®se (25%)</span>
                <span class="score">Score : <span id="anamneseScore">0</span>/41</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Crit√®res</div>
                    <div>Oui</div>
                    <div>¬±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row" id="criteria-a1">
    <div>
        <div class="criteria-text">1. Introduction et approche empathique (nom, fonction et questions ouvertes) <button class="comment-button" onclick="toggleComment('a1')" title="Ajouter un commentaire">üìù</button></div>
<div class="exemples-phrases"><div class="exemple-phrase">"Bonjour M. Lei, je suis le Dr Henney."</div><div class="exemple-phrase">"Je comprends que vous avez eu des difficult√©s √† dormir r√©cemment. Pouvez-vous me dire quel semble √™tre le probl√®me ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a1">
            <textarea class="comment-textarea" id="comment-a1" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a1'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a1" value="2" data-criteria="Introduction et approche empathique (nom, fonction et questions ouvertes)" onchange="updateScore('a', this)" />
    </div>
    <div class="checkbox-group" style="visibility: hidden;">
        <input type="radio" disabled />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="a1" value="0" onchange="updateScore('a', this)" />
    </div>
    <div class="points-display" id="points-a1">0</div>
</div>
<div class="criteria-row" id="criteria-a2">
    <div>
        <div class="criteria-text">2. Caract√©risation des troubles du sommeil <button class="comment-button" onclick="toggleComment('a2')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Difficult√© d'endormissement <span class="patient-response">[oui, quelques heures]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-0" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Difficult√© de maintien du sommeil <span class="patient-response">[oui]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-1" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Dur√©e des sympt√¥mes <span class="patient-response">[9 mois, depuis d√©part de l'√©pouse]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-2" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Fatigue matinale <span class="patient-response">[oui]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-3" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Capacit√© de faire la grasse matin√©e <span class="patient-response">[peut-√™tre, mais jamais essay√©]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a2-detail-4" value="1" onchange="updateDetailScore('a2', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Cela doit √™tre frustrant. Avez-vous l'impression d'avoir du mal √† vous endormir ou √† rester endormi ?"</div><div class="exemple-phrase">"Combien de temps estimez-vous qu'il vous faut pour vous endormir, si vous y arrivez ?"</div><div class="exemple-phrase">"√ätes-vous somnolent le matin quand vous vous r√©veillez ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a2">
            <textarea class="comment-textarea" id="comment-a2" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a2'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a2">0</div>
</div>
<div class="criteria-row" id="criteria-a3">
    <div>
        <div class="criteria-text">3. Hygi√®ne du sommeil <button class="comment-button" onclick="toggleComment('a3')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Heure du coucher <span class="patient-response">[environ 23h]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-0" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Heure du lever <span class="patient-response">[5h30]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-1" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Temps r√©serv√© au sommeil <span class="patient-response">[6 heures]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-2" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">T√©l√©vision au lit <span class="patient-response">[oui, minuterie 30 min]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-3" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Siestes diurnes <span class="patient-response">[parfois devant TV, quelques minutes]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-4" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Caf√©ine <span class="patient-response">[2 tasses caf√© le matin, pas de changement]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a3-detail-5" value="1" onchange="updateDetailScore('a3', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Permettez-moi de vous poser quelques questions sur ce que j'appelle 'l'hygi√®ne du sommeil'."</div><div class="exemple-phrase">"√Ä quelle heure environ vous couchez-vous le soir ?"</div><div class="exemple-phrase">"Regardez-vous la t√©l√©vision ou lisez-vous au lit ?"</div><div class="exemple-phrase">"Faites-vous des siestes pendant la journ√©e ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a3">
            <textarea class="comment-textarea" id="comment-a3" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a3'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a3">0</div>
</div>
<div class="criteria-row" id="criteria-a4">
    <div>
        <div class="criteria-text">4. Contexte psychosocial et √©v√©nement d√©clenchant <button class="comment-button" onclick="toggleComment('a4')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">D√©part de l'√©pouse <span class="patient-response">[il y a 9 mois]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-0" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Circonstances <span class="patient-response">[disputes, elle a abandonn√© famille]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-1" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Impact √©motionnel <span class="patient-response">[tr√®s dur, larmes aux yeux]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-2" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Responsabilit√© parentale <span class="patient-response">[3 enfants seul]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-3" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Soutien spirituel <span class="patient-response">[parle avec pr√™tre √† l'√©glise]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a4-detail-4" value="1" onchange="updateDetailScore('a4', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Avez-vous un partenaire pour vous aider ?"</div><div class="exemple-phrase">"C'est tr√®s difficile √† accepter pour n'importe qui. Comment vous en sortez-vous ?"</div><div class="exemple-phrase">"C'est vraiment une position difficile. Je suis d√©sol√© que cela vous soit arriv√©."</div></div>        <div class="criterion-comment-section" id="comment-section-a4">
            <textarea class="comment-textarea" id="comment-a4" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a4'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a4">0</div>
</div>
<div class="criteria-row" id="criteria-a5">
    <div>
        <div class="criteria-text">5. Sympt√¥mes d√©pressifs associ√©s <button class="comment-button" onclick="toggleComment('a5')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Diminution de l'app√©tit <span class="patient-response">[oui]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-0" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Anh√©donie <span class="patient-response">[n'attend plus les choses avec impatience]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-1" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Concentration <span class="patient-response">[ok sauf si distrait]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-2" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">√ânergie <span class="patient-response">[toujours fatigu√©, probl√®me d'√©nergie]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-3" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Id√©es suicidaires <span class="patient-response">[non, ne pourrait pas faire √ßa aux enfants]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-4" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Id√©es homicides <span class="patient-response">[non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a5-detail-5" value="1" onchange="updateDetailScore('a5', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Avez-vous d'autres probl√®mes, comme l'alimentation ?"</div><div class="exemple-phrase">"Avez-vous d√©j√† ce sentiment ? C'est-√†-dire, est-il difficile pour vous d'attendre des choses avec impatience ?"</div><div class="exemple-phrase">"Avez-vous d√©j√† pens√© au suicide ou qu'il serait peut-√™tre mieux si vous n'√©tiez pas l√† ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a5">
            <textarea class="comment-textarea" id="comment-a5" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a5'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a5">0</div>
</div>
<div class="criteria-row" id="criteria-a6">
    <div>
        <div class="criteria-text">6. R√©seau de soutien <button class="comment-button" onclick="toggleComment('a6')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Parents <span class="patient-response">[viennent 1 week-end sur 2, aident avec enfants]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-0" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Belle-m√®re <span class="patient-response">[vient parfois, se sent horrible]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-1" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Voisins <span class="patient-response">[r√©cup√®rent enfants √† l'√©cole, donnent d√Æner]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-2" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">√âglise <span class="patient-response">[enfants participent aux activit√©s]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a6-detail-3" value="1" onchange="updateDetailScore('a6', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Avez-vous quelqu'un, comme un parent ou un ami, √† qui vous pouvez parler de ce qui se passe ?"</div><div class="exemple-phrase">"Ce r√©seau de soutien social peut √™tre tr√®s utile lorsque les gens traversent des moments difficiles."</div></div>        <div class="criterion-comment-section" id="comment-section-a6">
            <textarea class="comment-textarea" id="comment-a6" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a6'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a6">0</div>
</div>
<div class="criteria-row" id="criteria-a7">
    <div>
        <div class="criteria-text">7. Habitudes de vie <button class="comment-button" onclick="toggleComment('a7')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Alcool <span class="patient-response">[non, n'y touche jamais]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a7-detail-0" value="1" onchange="updateDetailScore('a7', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Tabac <span class="patient-response">[non]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a7-detail-1" value="1" onchange="updateDetailScore('a7', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Drogues <span class="patient-response">[non, ne ferait pas √ßa]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a7-detail-2" value="1" onchange="updateDetailScore('a7', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Profession <span class="patient-response">[superviseur contr√¥le a√©rien]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a7-detail-3" value="1" onchange="updateDetailScore('a7', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Buvez-vous de l'alcool ?"</div><div class="exemple-phrase">"Qu'en est-il de fumer ou d'utiliser du tabac ?"</div><div class="exemple-phrase">"Y a-t-il d'autres drogues que vous prenez ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a7">
            <textarea class="comment-textarea" id="comment-a7" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a7'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a7">0</div>
</div>
<div class="criteria-row" id="criteria-a8">
    <div>
        <div class="criteria-text">8. Ant√©c√©dents m√©dicaux et m√©dicaments <button class="comment-button" onclick="toggleComment('a8')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Migraines <span class="patient-response">[traitement rizatriptan 1x/mois]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a8-detail-0" value="1" onchange="updateDetailScore('a8', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Tylenol <span class="patient-response">[occasionnel pour migraines]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a8-detail-1" value="1" onchange="updateDetailScore('a8', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Traitement de canal <span class="patient-response">[le mois dernier]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a8-detail-2" value="1" onchange="updateDetailScore('a8', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">L√©sion cutan√©e <span class="patient-response">[biopsie b√©nigne il y a quelques mois]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a8-detail-3" value="1" onchange="updateDetailScore('a8', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Allergies <span class="patient-response">[aucune]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a8-detail-4" value="1" onchange="updateDetailScore('a8', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Hospitalisations <span class="patient-response">[jamais]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a8-detail-5" value="1" onchange="updateDetailScore('a8', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Prenez-vous des m√©dicaments ?"</div><div class="exemple-phrase">"√Ä quelle fr√©quence prenez-vous cela ?"</div><div class="exemple-phrase">"Avez-vous eu d'autres probl√®mes de sant√© dans le pass√© ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a8">
            <textarea class="comment-textarea" id="comment-a8" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a8'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a8">0</div>
</div>
<div class="criteria-row" id="criteria-a9">
    <div>
        <div class="criteria-text">9. Histoire familiale <button class="comment-button" onclick="toggleComment('a9')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Parents <span class="patient-response">[travaillent dans l'√©dition en Californie]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-0" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Sant√© des parents <span class="patient-response">[pas de probl√®mes]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-1" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Enfants <span class="patient-response">[2 filles et 1 fils]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="a9-detail-2" value="1" onchange="updateDetailScore('a9', 'a')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Qu'en est-il des maladies dans votre famille ? Quelqu'un dans la famille a-t-il des probl√®mes de sant√© ?"</div></div>        <div class="criterion-comment-section" id="comment-section-a9">
            <textarea class="comment-textarea" id="comment-a9" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('a9'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-a9">0</div>
</div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('anamnese')" title="Commentaire sur cette section">üìù Commentaire sur la section Anamn√®se</button>
                </div>
                <div class="section-comment-section" id="section-comment-anamnese">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur l'anamn√®se</h4>
                    <textarea class="comment-textarea" id="comment-section-anamnese" placeholder="Commentaire sur la section anamn√®se..." oninput="updateSectionComment('anamnese'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- EXAMEN CLINIQUE -->
        <div class="section">
            <div class="section-header">
                <span>Examen clinique (25%)</span>
                <span class="score">Score : <span id="statusScore">0</span>/18</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Crit√®res</div>
                    <div>Oui</div>
                    <div>¬±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row" id="criteria-e1">
    <div>
        <div class="criteria-text">1. Pr√©paration √† l'examen <button class="comment-button" onclick="toggleComment('e1')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Se laver les mains</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e1-detail-0" value="1" onchange="updateDetailScore('e1', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Expliquer l'examen au patient</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e1-detail-1" value="1" onchange="updateDetailScore('e1', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Commenter les signes vitaux</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e1-detail-2" value="1" onchange="updateDetailScore('e1', 'e')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"D'accord. J'aimerais faire un examen physique maintenant si cela ne vous d√©range pas."</div><div class="exemple-phrase">"Laissez-moi juste me laver les mains."</div><div class="exemple-phrase">"Il semble que vos signes vitaux soient normaux, alors permettez-moi d'abord de regarder dans vos oreilles..."</div></div>        <div class="criterion-comment-section" id="comment-section-e1">
            <textarea class="comment-textarea" id="comment-e1" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('e1'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e1">0</div>
</div>
<div class="criteria-row" id="criteria-e2">
    <div>
        <div class="criteria-text">2. Examen g√©n√©ral et psychiatrique <button class="comment-button" onclick="toggleComment('e2')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Apparence g√©n√©rale <span class="patient-response">[poids normal, √¢ge apparent appropri√©]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-0" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">√âtat mental <span class="patient-response">[non n√©glig√©]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-1" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Processus de pens√©e <span class="patient-response">[ordonn√©s et logiques]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-2" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Affect <span class="patient-response">[euthymique mais d√©prim√©]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-3" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Humeur <span class="patient-response">[appropri√©e mais d√©prim√©e]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-4" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Pens√©es d√©lirantes <span class="patient-response">[absentes]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-5" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Id√©ation suicidaire/homicide <span class="patient-response">[ni√©e]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e2-detail-6" value="1" onchange="updateDetailScore('e2', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e2">
            <textarea class="comment-textarea" id="comment-e2" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('e2'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e2">0</div>
</div>
<div class="criteria-row" id="criteria-e3">
    <div>
        <div class="criteria-text">3. Examen thyro√Ødien <button class="comment-button" onclick="toggleComment('e3')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Observation de la glande thyro√Øde</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e3-detail-0" value="1" onchange="updateDetailScore('e3', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Palpation bimanuelle post√©rieure</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e3-detail-1" value="1" onchange="updateDetailScore('e3', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Test de d√©glutition</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e3-detail-2" value="1" onchange="updateDetailScore('e3', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Recherche d'hypertrophie <span class="patient-response">[absente]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e3-detail-3" value="1" onchange="updateDetailScore('e3', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Recherche de nodules <span class="patient-response">[absents]</span></div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e3-detail-4" value="1" onchange="updateDetailScore('e3', 'e')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-e3">
            <textarea class="comment-textarea" id="comment-e3" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('e3'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e3">0</div>
</div>
<div class="criteria-row" id="criteria-e4">
    <div>
        <div class="criteria-text">4. Examen ORL basique <button class="comment-button" onclick="toggleComment('e4')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Otoscopie bilat√©rale</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-0" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Examen pharyng√©</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-1" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Palpation ganglionnaire cervicale</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="e4-detail-2" value="1" onchange="updateDetailScore('e4', 'e')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"Avez-vous mal aux oreilles ?"</div></div>        <div class="criterion-comment-section" id="comment-section-e4">
            <textarea class="comment-textarea" id="comment-e4" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('e4'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-e4">0</div>
</div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('examen')" title="Commentaire sur cette section">üìù Commentaire sur la section Examen</button>
                </div>
                <div class="section-comment-section" id="section-comment-examen">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur l'examen clinique</h4>
                    <textarea class="comment-textarea" id="comment-section-examen" placeholder="Commentaire sur la section examen clinique..." oninput="updateSectionComment('examen'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- MANAGEMENT -->
        <div class="section">
            <div class="section-header">
                <span>Management (25%)</span>
                <span class="score">Score : <span id="managementScore">0</span>/18</span>
            </div>
            <div class="section-content">
                <div class="header-row">
                    <div>Crit√®res</div>
                    <div>Oui</div>
                    <div>¬±</div>
                    <div>Non</div>
                    <div>Points</div>
                </div>
<div class="criteria-row" id="criteria-m1">
    <div>
        <div class="criteria-text">1. Diagnostics diff√©rentiels <button class="comment-button" onclick="toggleComment('m1')" title="Ajouter un commentaire">üìù</button></div>
        <div class="criterion-comment-section" id="comment-section-m1">
            <textarea class="comment-textarea" id="comment-m1" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('m1'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="2" data-criteria="Diagnostics diff√©rentiels" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="1" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m1" value="0" onchange="updateScore('m', this)" />
    </div>
    <div class="points-display" id="points-m1">0</div>
</div>
<div class="dd-section">
    <div class="dd-title">Diagnostics diff√©rentiels des troubles du sommeil avec sympt√¥mes d√©pressifs</div>
    <div class="dd-category">Troubles psychiatriques primaires</div>
    <div class="dd-item">‚Ä¢ √âpisode d√©pressif majeur/Trouble d√©pressif majeur <span class="dd-test">‚Üí √âchelle de d√©pression (PHQ-9, Hamilton)</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Insomnie depuis 9 mois<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Diminution app√©tit<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Anh√©donie (n'attend plus les choses)<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Fatigue/perte d'√©nergie<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Humeur d√©pressive avec larmes<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° √âv√©nement d√©clenchant majeur (abandon par √©pouse)<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Dur√©e > 2 semaines<br><strong>Arguments CONTRE:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Concentration pr√©serv√©e<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Pas d'id√©es suicidaires</div>
    <div class="dd-item">‚Ä¢ Trouble de l'adaptation avec humeur d√©pressive <span class="dd-test">‚Üí √âvaluation psychiatrique compl√®te</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Facteur de stress identifiable (d√©part √©pouse)<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° D√©but dans les 3 mois du stresseur<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° D√©tresse cliniquement significative<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Alt√©ration du fonctionnement<br><strong>Arguments CONTRE:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Dur√©e > 6 mois<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Crit√®res complets de d√©pression majeure</div>
    <div class="dd-item">‚Ä¢ Dysthymie <span class="dd-test">‚Üí Suivi longitudinal des sympt√¥mes</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Humeur d√©pressive chronique<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Insomnie<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Faible √©nergie<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Diminution app√©tit<br><strong>Arguments CONTRE:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Dur√©e < 2 ans<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Intensit√© sugg√®re √©pisode majeur</div>
    <div class="dd-item">‚Ä¢ Deuil compliqu√© <span class="dd-test">‚Üí √âvaluation du processus de deuil</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Perte significative (√©pouse partie)<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Pr√©occupation par la perte<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° D√©tresse √©motionnelle intense<br><strong>Arguments CONTRE:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Pas un d√©c√®s<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Col√®re plut√¥t que tristesse pure</div>
    <div class="dd-category">Causes organiques √† exclure</div>
    <div class="dd-item">‚Ä¢ Hypothyro√Ødie <span class="dd-test">‚Üí TSH, T4 libre</span></div>
    <div class="dd-causes" style="margin-left: 40px; color: rgb(80, 90, 110); font-size: 0.9em;"><strong>Arguments POUR:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Fatigue<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Troubles du sommeil<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Sympt√¥mes d√©pressifs<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Diminution √©nergie<br><strong>Arguments CONTRE:</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Pas de prise de poids<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Pas de constipation mentionn√©e<br>&nbsp;&nbsp;&nbsp;&nbsp;‚ñ° Pas de bradycardie significative</div>
</div>
<div class="criteria-row" id="criteria-m2">
    <div>
        <div class="criteria-text">2. Examens biologiques de d√©pistage <button class="comment-button" onclick="toggleComment('m2')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">TSH et T4 libre (hypothyro√Ødie)</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-0" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">NFS (an√©mie, autre cause de fatigue)</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-1" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Ionogramme sanguin</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-2" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Glyc√©mie √† jeun</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-3" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Fonction h√©patique et r√©nale</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m2-detail-4" value="1" onchange="updateDetailScore('m2', 'm')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-m2">
            <textarea class="comment-textarea" id="comment-m2" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('m2'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m2">0</div>
</div>
<div class="criteria-row" id="criteria-m3">
    <div>
        <div class="criteria-text">3. √âvaluation cardiaque <button class="comment-button" onclick="toggleComment('m3')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">ECG (bradycardie relative √† 60 bpm)</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m3-detail-0" value="1" onchange="updateDetailScore('m3', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Recherche de troubles du rythme</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m3-detail-1" value="1" onchange="updateDetailScore('m3', 'm')" /></label>    </div></div></div>        <div class="criterion-comment-section" id="comment-section-m3">
            <textarea class="comment-textarea" id="comment-m3" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('m3'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m3">0</div>
</div>
<div class="criteria-row" id="criteria-m4">
    <div>
        <div class="criteria-text">4. Prise en charge th√©rapeutique <button class="comment-button" onclick="toggleComment('m4')" title="Ajouter un commentaire">üìù</button></div>
        <div class="therapy-section">
            <div class="therapy-title">Orientation psychiatrique urgente</div>
            <div><span style="margin-left: 10px;">‚Ä¢</span> R√©f√©rence √† un psychiatre ou psychologue<br />
            <span style="margin-left: 10px;">‚Ä¢</span> √âvaluation approfondie de la d√©pression<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Mise en place d'un suivi r√©gulier<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Th√©rapie de soutien imm√©diate<br />
            <span style="margin-left: 10px;">‚Ä¢</span> √âvaluation du risque suicidaire ongoing</div>
        </div>
        <div class="therapy-section">
            <div class="therapy-title">Traitement pharmacologique si confirm√©</div>
            <div><span style="margin-left: 10px;">‚Ä¢</span> ISRS premi√®re ligne : sertraline, escitalopram<br />
            <span style="margin-left: 10px;">‚Ä¢</span> D√©but √† faible dose avec titration progressive<br />
            <span style="margin-left: 10px;">‚Ä¢</span> √âducation sur d√©lai d'action (4-6 semaines)<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Surveillance effets secondaires initiaux<br />
            <span style="margin-left: 10px;">‚Ä¢</span> √âviter benzodiaz√©pines (risque d√©pendance)</div>
        </div>
        <div class="therapy-section">
            <div class="therapy-title">Th√©rapie non pharmacologique</div>
            <div><span style="margin-left: 10px;">‚Ä¢</span> Th√©rapie cognitivo-comportementale (TCC)<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Th√©rapie de soutien pour deuil/adaptation<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Groupe de soutien pour parents isol√©s<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Techniques de relaxation<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Hygi√®ne du sommeil stricte</div>
        </div>
        <div class="therapy-section">
            <div class="therapy-title">Mesures d'hygi√®ne du sommeil</div>
            <div><span style="margin-left: 10px;">‚Ä¢</span> √âviter TV au lit<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Routine de coucher r√©guli√®re<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Chambre sombre et calme<br />
            <span style="margin-left: 10px;">‚Ä¢</span> √âviter siestes > 20 min<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Activit√© physique r√©guli√®re (pas le soir)<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Limitation caf√©ine apr√®s-midi</div>
        </div>
        <div class="therapy-section">
            <div class="therapy-title">Support social et familial</div>
            <div><span style="margin-left: 10px;">‚Ä¢</span> Renforcer r√©seau de soutien existant<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Services sociaux pour aide parentale<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Respite care pour soulagement parental<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Maintien activit√©s √©glise<br />
            <span style="margin-left: 10px;">‚Ä¢</span> Coordination avec famille √©largie</div>
        </div>
        <div class="criterion-comment-section" id="comment-section-m4">
            <textarea class="comment-textarea" id="comment-m4" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('m4'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m4" value="2" data-criteria="Prise en charge th√©rapeutique" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m4" value="1" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m4" value="0" onchange="updateScore('m', this)" />
    </div>
    <div class="points-display" id="points-m4">0</div>
</div>
<div class="criteria-row" id="criteria-m5">
    <div>
        <div class="criteria-text">5. Communication et plan de s√©curit√© <button class="comment-button" onclick="toggleComment('m5')" title="Ajouter un commentaire">üìù</button></div>
<div class="details-with-checkboxes"><div class="detail-row">    <div class="detail-text criteria-detail">Explication des diagnostics en termes simples</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-0" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Normalisation de la r√©action au stress</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-1" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Plan de crise avec num√©ros d'urgence</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-2" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Ressources locales de sant√© mentale</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-3" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div><div class="detail-row">    <div class="detail-text criteria-detail">Suivi rapproch√© programm√©</div>    <div class="detail-checkboxes">        <label class="detail-checkbox"><input type="checkbox" id="m5-detail-4" value="1" onchange="updateDetailScore('m5', 'm')" /></label>    </div></div></div><div class="exemples-phrases"><div class="exemple-phrase">"M. Lei, d'apr√®s notre conversation et votre examen physique, il y a quelques choses qui pourraient causer ces probl√®mes de sommeil."</div><div class="exemple-phrase">"La premi√®re est un trouble de l'humeur, comme la d√©pression."</div><div class="exemple-phrase">"Il est important que vous vous sentiez soutenu et que vous sachiez qu'il y aura toujours une place pour vous dans cette clinique si vous vous sentez en crise."</div></div>        <div class="criterion-comment-section" id="comment-section-m5">
            <textarea class="comment-textarea" id="comment-m5" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('m5'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="checkbox-group"></div>
    <div class="points-display" id="points-m5">0</div>
</div>
<div class="criteria-row" id="criteria-m6">
    <div>
        <div class="criteria-text">6. Red flags et surveillance <button class="comment-button" onclick="toggleComment('m6')" title="Ajouter un commentaire">üìù</button></div>
        <div class="redflags-section">
            <div class="redflags-title">‚ö†Ô∏è Signes d'alerte n√©cessitant une intervention urgente</div>
            <div class="redflags-item">
                <div class="redflags-text">1. Id√©es suicidaires √©mergentes</div>
                <div class="redflags-description">Hospitalisation imm√©diate</div>
            </div>
            <div class="redflags-item">
                <div class="redflags-text">2. N√©gligence des enfants</div>
                <div class="redflags-description">Services de protection de l'enfance</div>
            </div>
            <div class="redflags-item">
                <div class="redflags-text">3. Psychose ou d√©compensation</div>
                <div class="redflags-description">√âvaluation psychiatrique urgente</div>
            </div>
            <div class="redflags-item">
                <div class="redflags-text">4. Abus de substances</div>
                <div class="redflags-description">Programme de d√©sintoxication</div>
            </div>
            <div class="redflags-item">
                <div class="redflags-text">5. Incapacit√© fonctionnelle au travail</div>
                <div class="redflags-description">Arr√™t maladie et traitement intensif</div>
            </div>
        </div>
        <div class="criterion-comment-section" id="comment-section-m6">
            <textarea class="comment-textarea" id="comment-m6" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('m6'); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m6" value="2" data-criteria="Red flags et surveillance" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m6" value="1" onchange="updateScore('m', this)" />
    </div>
    <div class="checkbox-group">
        <input type="radio" name="m6" value="0" onchange="updateScore('m', this)" />
    </div>
    <div class="points-display" id="points-m6">0</div>
</div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('management')" title="Commentaire sur cette section">üìù Commentaire sur la section Management</button>
                </div>
                <div class="section-comment-section" id="section-comment-management">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur le management</h4>
                    <textarea class="comment-textarea" id="comment-section-management" placeholder="Commentaire sur la section management..." oninput="updateSectionComment('management'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- CL√îTURE -->
        <div class="section cloture-section">
            <div class="section-header">
                <span>Cl√¥ture de consultation</span>
            </div>
            <div class="section-content">
                <div class="cloture-item">
                    <h4 class="cloture-title">Explication diagnostique et plan</h4>
                    <div class="cloture-content cloture-content-green">M. Lei, d'apr√®s notre conversation et votre examen physique, il y a quelques choses qui pourraient causer ces probl√®mes de sommeil. La premi√®re est un trouble de l'humeur, comme la d√©pression. Vous avez certainement eu un grand facteur de stress dans votre vie r√©cemment et avez maintenant d√ª assumer un √©norme changement. On pourrait raisonnablement s'attendre √† ce que cela affecte lourdement n'importe qui. La d√©pression est quelque chose qui peut affecter de nombreux domaines de votre vie, et le sommeil et l'app√©tit en font partie. Elle peut certainement emp√™cher un horaire de sommeil solide et, ainsi, causer de la somnolence diurne. Il y a quelques autres possibilit√©s pour vos sympt√¥mes, qui incluent des variantes de la d√©pression ‚Äî c'est-√†-dire des troubles psychologiques li√©s mais diff√©rents de la d√©pression ‚Äî ou il pourrait y avoir quelque chose de biologiquement anormal. Un probl√®me biologique pourrait √™tre quelque chose comme une thyro√Øde hypoactive. Pour cela, j'aimerais faire des analyses de sang aujourd'hui pour v√©rifier. Je pense que dans l'ensemble, nous devons finalement vous orienter vers un professionnel de la sant√© mentale afin que vous puissiez √™tre mieux diagnostiqu√© et trait√© pour ce probl√®me. Ils peuvent aussi dire plus pr√©cis√©ment quel trouble vous avez et vous soutenir pendant ces moments difficiles. Pendant tout ce processus, cependant, il est important que vous vous sentiez soutenu et que vous sachiez qu'il y aura toujours une place pour vous dans cette clinique si vous vous sentez en crise. Si vous avez des pens√©es de vous faire du mal ou de faire du mal √† quelqu'un d'autre, sachez que vous pouvez toujours venir ici et nous pouvons en parler. Avant de partir, j'aimerais vous donner une liste de ressources locales qui peuvent vous aider si vous vous sentez d√©pass√©. Permettez-moi de sortir et d'aller les chercher pour vous. Je vais aussi m'arranger pour que mon infirmi√®re vienne pr√©lever ce sang dont nous avons parl√©.

Y a-t-il un autre aspect de vos soins de sant√© dont nous n'avons pas d√©j√† discut√© ? D'accord alors, merci.</div>
                </div>
                <div class="cloture-item">
                    <h4 class="cloture-title">Question difficile du patient</h4>
                    <div class="cloture-content">[Est-ce que je suis en train de devenir fou ?]</div>
                </div>
                <div class="cloture-item">
                    <h4 class="cloture-title">R√©ponse appropri√©e du candidat</h4>
                    <div class="cloture-content cloture-content-green">Non, vous n'√™tes pas en train de devenir fou. Vous traversez une p√©riode extr√™mement difficile et votre r√©action est tout √† fait compr√©hensible. La d√©pression est une maladie m√©dicale r√©elle qui peut √™tre trait√©e efficacement. Avec le bon soutien et traitement, vous irez mieux.</div>
                </div>
            </div>
        </div>
        <!-- COMMUNICATION -->
        <div class="section communication-section-container">
            <div class="section-header">
                <span>Communication (25%)</span>
                <span class="score">Score : <span id="communicationScore">0</span>/20</span>
            </div>
            <div class="section-content">
                <div class="header-row communication-header">
                    <div>Crit√®res</div>
                    <div>A</div>
                    <div>B</div>
                    <div>C</div>
                    <div>D</div>
                    <div>E</div>
                </div>
                <div class="communication-section" id="criteria-c1">
                    <div>
                        <div class="communication-text">1. R√©ponse aux sentiments et besoins du patient <button class="comment-button" onclick="toggleComment('c1')" title="Ajouter un commentaire">üìù</button></div>
                        <div class="communication-desc">Empathie, √©coute active, validation des √©motions<br />
Explique le d√©roulement de la consultation et v√©rifie les pr√©occupations du patient, commence l'anamn√®se par une question ouverte ; reconna√Æt, verbalise et l√©gitime les √©motions, fournit du soutient</div>
                        <div class="criterion-comment-section" id="comment-section-c1">
                            <textarea class="comment-textarea" id="comment-c1" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('c1'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="A" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="B" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="C" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="D" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c1" value="E" data-criteria="R√©ponse aux sentiments du patient" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c2">
                    <div>
                        <div class="communication-text">2. Structure de l'entretien <button class="comment-button" onclick="toggleComment('c2')" title="Ajouter un commentaire">üìù</button></div>
                        <div class="communication-desc">Organisation logique, transitions fluides, gestion du temps<br />
Se pr√©sente par son nom et sa fonction, les √©tapes de l'entretien sont identifiables et s'encha√Ænent de mani√®re logique, gestion du temps, adaptation √† la situation</div>
                        <div class="criterion-comment-section" id="comment-section-c2">
                            <textarea class="comment-textarea" id="comment-c2" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('c2'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="A" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="B" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="C" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="D" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c2" value="E" data-criteria="Structure de l'entretien" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c3">
                    <div>
                        <div class="communication-text">3. Expression verbale <button class="comment-button" onclick="toggleComment('c3')" title="Ajouter un commentaire">üìù</button></div>
                        <div class="communication-desc">Clart√©, vocabulaire adapt√©, v√©rification de la compr√©hension<br />
Langage adapt√© au niveau du patient, pas de jargon, explications compr√©hensibles, reformulations quand n√©cessaire, r√©p√©titions des points cl√©s, fait une synth√®se de la consultation, bonne articulation, ton et volume ad√©quats</div>
                        <div class="criterion-comment-section" id="comment-section-c3">
                            <textarea class="comment-textarea" id="comment-c3" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('c3'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="A" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="B" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="C" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="D" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c3" value="E" data-criteria="Expression verbale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c4">
                    <div>
                        <div class="communication-text">4. Expression non verbale <button class="comment-button" onclick="toggleComment('c4')" title="Ajouter un commentaire">üìù</button></div>
                        <div class="communication-desc">Contact visuel, posture, gestuelle appropri√©e<br />
Distance interpersonnelle ad√©quate, posture ad√©quate, gestes ad√©quats, contact visuel et expression faciale ad√©quats, pauses quand n√©cessaire</div>
                        <div class="criterion-comment-section" id="comment-section-c4">
                            <textarea class="comment-textarea" id="comment-c4" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('c4'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="A" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="B" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="C" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="D" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c4" value="E" data-criteria="Expression non verbale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div class="communication-section" id="criteria-c5">
                    <div>
                        <div class="communication-text">5. √âvaluation g√©n√©rale de la communication <button class="comment-button" onclick="toggleComment('c5')" title="Ajouter un commentaire">üìù</button></div>
                        <div class="communication-desc">Qualit√© globale de l'interaction m√©decin-patient</div>
                        <div class="criterion-comment-section" id="comment-section-c5">
                            <textarea class="comment-textarea" id="comment-c5" placeholder="Commentaire sur ce crit√®re..." oninput="updateCommentButton('c5'); autoResizeTextarea(this);"></textarea>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="A" data-criteria="√âvaluation g√©n√©rale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="B" data-criteria="√âvaluation g√©n√©rale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="C" data-criteria="√âvaluation g√©n√©rale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="D" data-criteria="√âvaluation g√©n√©rale" onchange="updateScore('communication', this)" />
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="c5" value="E" data-criteria="√âvaluation g√©n√©rale" onchange="updateScore('communication', this)" />
                    </div>
                </div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="section-comment-button" onclick="toggleSectionComment('communication')" title="Commentaire sur cette section">üìù Commentaire sur la section Communication</button>
                </div>
                <div class="section-comment-section" id="section-comment-communication">
                    <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 16px;">Commentaires sur la communication</h4>
                    <textarea class="comment-textarea" id="comment-section-communication" placeholder="Commentaire sur la section communication..." oninput="updateSectionComment('communication'); autoResizeTextarea(this);"></textarea>
                </div>
            </div>
        </div>
        <!-- TOTAUX -->
        <div class="total-sections">
            <div class="total-section">
                <div class="total-label">Score Global</div>
                <div class="total-body">
                    <div class="total-score" id="totalScore">0/97</div>
                </div>
            </div>
            <div class="total-section">
                <div class="total-label">% par Section</div>
                <div class="total-pourcent-body">
                    <div class="total-pourcent-sections">
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Anamn√®se</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="anamnese-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Examen clinique</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="examen-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Management</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="management-percentage">0</span>%</div>
                            </div>
                        </div>
                        <div class="total-pourcent-section">
                            <div class="total-section-label">Communication</div>
                            <div class="pourcent-body">
                                <div class="total-pourcent-value"><span id="communication-percentage">0</span>%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="total-section">
                <div class="total-label">Note Globale</div>
                <div class="total-body">
                    <div class="total-note-globale" id="globalGrade">E</div>
                </div>
            </div>
        </div>
        <!-- √âCHELLE DE NOTATION -->
        <div class="grade-scale" style="padding: 10px 15px; background: #f8f9fa; border-radius: 8px;">
            <h3 style="margin: 0 0 10px 0; font-size: 16px;">√âchelle de notation</h3>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; text-align: center;">
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #2c974b;">A</div>
                    <div style="font-size: 12px; color: #666;">‚â•90%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #4e9cf0;">B</div>
                    <div style="font-size: 12px; color: #666;">80-89%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #f0ad4e;">C</div>
                    <div style="font-size: 12px; color: #666;">70-79%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #e67e22;">D</div>
                    <div style="font-size: 12px; color: #666;">60-69%</div>
                </div>
                <div>
                    <div style="font-weight: bold; font-size: 24px; color: #d9534f;">E</div>
                    <div style="font-size: 12px; color: #666;">&lt;60%</div>
                </div>
            </div>
        </div>
        <!-- √âL√âMENTS MANQUANTS (MASQU√âS) -->
        <!-- <div class="missing-items" id="missingItems" style="display: none;">
            <h3>√âl√©ments non √©valu√©s</h3>
            <div id="missingList"></div>
        </div> -->
<div class="annexes">
<h3>Annexes</h3>
<div class="annexes-grid">
<div class="annexe-item annexe-scenario">
    <div class="annexe-title">Instructions pour le patient standardis√©</div>
    <div class="annexe-scenario-content">
        <div class="scenario-info">
            <strong>Nom :</strong> Pej Lei |             <strong>√Çge :</strong> 33 ans<br>
            <strong>Contexte :</strong> P√®re c√©libataire de 3 enfants, contr√¥leur a√©rien, abandonn√© par son √©pouse
        </div>
        <div class="scenario-section">
            <h4>Motif de consultation</h4>
            <p><strong>Plainte principale :</strong> ¬´Difficult√©s √† dormir¬ª</p>
            <p><strong>Si on demande s'il y a autre chose :</strong> ¬´Je me couche et j'ai l'impression de ne pas pouvoir dormir de toute la nuit¬ª</p>
        </div>
        <div class="scenario-section">
            <h4>Histoire actuelle</h4>
            <div class="scenario-subsection">
                <strong>Troubles du sommeil :</strong>
                <ul>
                    <li>Difficult√© d'endormissement (quelques heures)</li>
                    <li>Difficult√© de maintien du sommeil</li>
                    <li>Fatigue matinale constante</li>
                    <li>Dur√©e : 9 mois (depuis d√©part √©pouse)</li>
                    <li>6 heures r√©serv√©es au sommeil (23h-5h30)</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>√âv√©nement d√©clenchant :</strong>
                <ul>
                    <li>√âpouse partie il y a 9 mois</li>
                    <li>Disputes fr√©quentes avant</li>
                    <li>Elle a abandonn√© famille sans pr√©venir</li>
                    <li>Laiss√© les enfants √† l'√©cole</li>
                    <li>Contact 1 mois apr√®s pour dire qu'elle partait d√©finitivement</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Sympt√¥mes d√©pressifs :</strong>
                <ul>
                    <li>Diminution de l'app√©tit</li>
                    <li>N'attend plus les choses avec impatience</li>
                    <li>Toujours fatigu√©, probl√®me d'√©nergie</li>
                    <li>Humeur d√©pressive (larmes pendant entretien)</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Attitude du patient :</strong>
                <ul>
                    <li>Devient √©motionnel en parlant du d√©part de sa femme</li>
                    <li>Minimise ses difficult√©s ('Je fais ce que j'ai √† faire')</li>
                    <li>Protecteur envers ses enfants</li>
                    <li>Accepte le soutien mais se sent d√©pass√©</li>
                </ul>
            </div>
        </div>
        <div class="scenario-section">
            <h4>M√©dicaments actuels</h4>
            <div class="scenario-subsection">
                <strong>M√©dicaments :</strong>
                <ul>
                    <li>Rizatriptan PRN pour migraines (1x/mois)</li>
                    <li>Tylenol occasionnel</li>
                </ul>
            </div>
        </div>
        <div class="scenario-section">
            <h4>Habitudes</h4>
            <ul>
                <li><strong>Alcool :</strong> Jamais</li>
                <li><strong>Tabac :</strong> Non</li>
                <li><strong>Drogues illicites :</strong> Non</li>
            </ul>
        </div>
        <div class="scenario-section">
            <h4>Hygi√®ne du sommeil</h4>
            <ul>
                <li><strong>Heure de coucher :</strong> Vers 23h</li>
                <li><strong>Heure de lever :</strong> 5h30 (pr√©parer enfants)</li>
                <li><strong>T√©l√©vision au lit :</strong> 30 minutes avec minuterie</li>
                <li><strong>Siestes :</strong> Parfois quelques minutes devant TV</li>
                <li><strong>Consommation de caf√©ine :</strong> 2 tasses caf√© le matin seulement</li>
            </ul>
        </div>
        <div class="scenario-section">
            <h4>Ant√©c√©dents</h4>
            <div class="scenario-subsection">
                <strong>Ant√©c√©dents m√©dicaux :</strong>
                <ul>
                    <li>Migraines (traitement mensuel)</li>
                    <li>Traitement de canal r√©cent</li>
                    <li>Biopsie cutan√©e b√©nigne</li>
                </ul>
            </div>
        </div>
        <div class="scenario-section">
            <h4>Simulation</h4>
            <div class="scenario-subsection">
                <strong>Durant la consultation :</strong>
                <ul>
                    <li>Apparence fatigu√©e mais soign√©e</li>
                    <li>Devient √©motionnel (larmes) en parlant du d√©part de l'√©pouse</li>
                    <li>Se ressaisit rapidement</li>
                    <li>Parle avec fiert√© de ses enfants</li>
                    <li>Montre la cicatrice sur la jambe si mentionn√©e</li>
                </ul>
            </div>
            <div class="scenario-subsection">
                <strong>Durant l'examen :</strong>
                <ul>
                    <li>Coop√©ratif</li>
                    <li>Pas de signes physiques anormaux</li>
                    <li>Affect d√©prim√© mais contact pr√©serv√©</li>
                </ul>
            </div>
        </div>
        <div class="scenario-section">
            <h4>Contexte social</h4>
            <p><strong>Profession :</strong> Superviseur contr√¥le a√©rien</p>
            <p><strong>Enfants :</strong> 3 (2 filles, 1 fils) - Lacy (a√Æn√©e) aide au d√Æner</p>
            <div class="scenario-subsection">
                <strong>Soutien :</strong>
                <ul>
                    <li><strong>Parents :</strong> Viennent 1 week-end sur 2</li>
                    <li><strong>Belle-m√®re :</strong> Vient parfois, se sent horrible</li>
                    <li><strong>Voisins :</strong> Aident avec enfants apr√®s √©cole</li>
                    <li><strong>√âglise :</strong> Parle avec pr√™tre, enfants aux activit√©s</li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="annexe-item annexe-informations-expert">
    <div class="annexe-title">Points cl√©s pour l'√©valuation</div>
    <div class="annexe-informations-content">
        <div class="info-section">
            <h4>Points cl√©s</h4>
            <ul>
                <li>Homme de 33 ans avec insomnie depuis 9 mois</li>
                <li>√âv√©nement d√©clenchant majeur : abandon par l'√©pouse</li>
                <li>P√®re c√©libataire de 3 enfants avec stress important</li>
                <li>Sympt√¥mes d√©pressifs classiques : insomnie, anh√©donie, fatigue, diminution app√©tit</li>
                <li>Contr√¥leur a√©rien (profession √† haute responsabilit√©)</li>
                <li>R√©seau de soutien pr√©sent mais intermittent</li>
                <li>Pas d'id√©ation suicidaire mais √† surveiller</li>
                <li>Accepte l'aide et reconna√Æt ses difficult√©s</li>
            </ul>
        </div>
        <div class="info-section">
            <h4>Pi√®ges</h4>
            <ul>
                <li>Ne pas explorer en d√©tail l'√©v√©nement d√©clenchant</li>
                <li>Minimiser l'impact de devenir parent c√©libataire</li>
                <li>Oublier d'√©valuer le risque suicidaire</li>
                <li>Ne pas explorer le r√©seau de soutien</li>
                <li>Oublier les causes organiques (hypothyro√Ødie)</li>
                <li>Ne pas proposer de ressources concr√®tes</li>
                <li>N√©gliger l'impact sur sa profession (s√©curit√© a√©rienne)</li>
            </ul>
        </div>
    </div>
</div>
<div class="annexe-item annexe-theorie-pratique">
    <div class="annexe-title">Rappels th√©oriques - Troubles du sommeil et d√©pression</div>
    <div class="annexe-theorie-content">
        <div class="theorie-section">
            <h4>Crit√®res DSM-5 √âpisode d√©pressif majeur</h4>
            <p>Au moins 5 sympt√¥mes pendant 2 semaines dont humeur d√©pressive ou anh√©donie. Autres : insomnie/hypersomnie, fatigue, culpabilit√© excessive, troubles concentration, modifications app√©tit/poids, agitation/ralentissement, id√©es suicidaires. Alt√©ration fonctionnement significative.</p>
        </div>
        <div class="theorie-section">
            <h4>Trouble de l'adaptation</h4>
            <p>Sympt√¥mes √©motionnels/comportementaux dans les 3 mois d'un stresseur identifiable. D√©tresse disproportionn√©e ou alt√©ration fonctionnement. R√©solution dans les 6 mois apr√®s disparition stresseur. Ne remplit pas crit√®res autre trouble mental.</p>
        </div>
        <div class="theorie-section">
            <h4>Hygi√®ne du sommeil</h4>
            <p>Horaires r√©guliers, √©viter √©crans avant coucher, chambre sombre/fra√Æche/calme, pas de caf√©ine apr√®s 14h, activit√© physique r√©guli√®re (pas le soir), √©viter alcool, pas de siestes > 20 min, lit r√©serv√© au sommeil.</p>
        </div>
    </div>
</div>
<div class="annexe-item annexe-rappels-therapeutiques">
    <div class="annexe-title">Rappels th√©rapeutiques</div>
    <div class="annexe-theorie-content">
        <ul class="rappels-list">
            <li>D√©pression : ISRS premi√®re ligne (sertraline 50mg, escitalopram 10mg)</li>
            <li>Insomnie : √©viter benzodiaz√©pines, pr√©f√©rer trazodone 25-50mg si besoin</li>
            <li>Psychoth√©rapie : TCC efficacit√© prouv√©e, th√©rapie interpersonnelle</li>
            <li>Urgence : hospitalisation si risque suicidaire</li>
            <li>Support social : groupes de soutien, services sociaux</li>
        </ul>
    </div>
</div>
<div class="annexe-item annexe-examens-complementaires">
    <div class="annexe-title">Examens compl√©mentaires</div>
    <div class="annexe-theorie-content">
        <ul class="examens-list">
            <li>TSH, T4 libre : √©liminer hypothyro√Ødie</li>
            <li>NFS : an√©mie comme cause de fatigue</li>
            <li>Bilan m√©tabolique : d√©s√©quilibres √©lectrolytiques</li>
            <li>ECG : si bradycardie ou avant antid√©presseurs</li>
            <li>√âchelles : PHQ-9, √©chelle de Hamilton pour suivi</li>
        </ul>
    </div>
</div>
</div>
</div>
        <!-- COMMENTAIRE G√âN√âRAL -->
        <div class="section-comment-section global">
            <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 18px;">Commentaire g√©n√©ral</h4>
            <textarea class="comment-textarea" id="comment-general" placeholder="Commentaire g√©n√©ral sur l'√©valuation..." oninput="updateGeneralComment(); autoResizeTextarea(this);"></textarea>
        </div>
    </div>
    <script>
        // D√©claration des variables globales
        window.audioContext = null;
        
        function updateScore(section, element) {
            const value = element.value;
            const name = element.name;
            let pointValue;

            if (section === "communication") {
                const map = { A: 4, B: 3, C: 2, D: 1, E: 0 };
                pointValue = map[value] || 0;
                // Mettre √† jour la classe de couleur pour communication
                const criteriaRow = document.getElementById("criteria-" + name);
                if (criteriaRow) {
                    criteriaRow.classList.remove("score-a", "score-b", "score-c", "score-d", "score-e", "lacune-rouge", "lacune-orange", "lacune-verte");
                    criteriaRow.classList.add("score-" + value.toLowerCase());
                    // Ajouter les classes lacune pour communication
                    if (value === "E" || value === "D") {
                        criteriaRow.classList.add("lacune-rouge");
                    } else if (value === "C") {
                        criteriaRow.classList.add("lacune-orange");
                    } else if (value === "A" || value === "B") {
                        criteriaRow.classList.add("lacune-verte");
                    }
                }
            } else {
                pointValue = Number(value) || 0;
                // Mettre √† jour la classe de couleur pour autres crit√®res
                const criteriaRow = document.getElementById("criteria-" + name);
                if (criteriaRow) {
                    criteriaRow.classList.remove("score-0", "score-1", "score-2", "lacune-rouge", "lacune-orange", "lacune-verte");
                    criteriaRow.classList.add("score-" + value);
                    // Ajouter les classes lacune pour crit√®res normaux
                    if (pointValue === 0) {
                        criteriaRow.classList.add("lacune-rouge");
                    } else if (pointValue === 1) {
                        criteriaRow.classList.add("lacune-orange");
                    } else if (pointValue >= 2) {
                        criteriaRow.classList.add("lacune-verte");
                    }
                }
            }

            const pointsElement = document.getElementById("points-" + name);
            if (pointsElement) {
                pointsElement.textContent = pointValue;
            }

            calculateScores();
        }

        function updateDetailScore(criterionId, prefix) {
            let totalScore = 0;
            const detailCheckboxes = document.querySelectorAll('input[id^="' + criterionId + '-detail-"]');
            const maxDetailsScore = detailCheckboxes.length;
            
            detailCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    totalScore += Number(checkbox.value) || 0;
                }
            });
            
            const pointsElement = document.getElementById("points-" + criterionId);
            if (pointsElement) {
                pointsElement.textContent = totalScore;
            }
            
            // Mettre √† jour la classe de couleur en fonction du score et du max
            const criteriaRow = document.getElementById("criteria-" + criterionId);
            if (criteriaRow) {
                criteriaRow.classList.remove("score-0", "score-1", "score-2", "score-3", "score-4", "score-5", "score-max", "lacune-rouge", "lacune-orange", "lacune-verte");
                
                // D√©terminer la classe appropri√©e avec les seuils 1/3 et 2/3
                const oneThird = maxDetailsScore / 3;
                const twoThirds = (maxDetailsScore * 2) / 3;
                
                if (totalScore < oneThird) {
                    criteriaRow.classList.add("score-0");
                    criteriaRow.classList.add("lacune-rouge");
                } else if (totalScore > twoThirds) {
                    criteriaRow.classList.add("score-max");
                    criteriaRow.classList.add("lacune-verte");
                } else {
                    // Score entre 1/3 et 2/3
                    criteriaRow.classList.add("score-1");
                    criteriaRow.classList.add("lacune-orange");
                }
            }
            
            calculateScores();
        }

        function calculateScores() {
            const isNewFormat = false;
            const missingItems = [];
            let scores = {};
            let maxScores = {};
            let coef = {};
            let sectionInfo = [];

            // Configuration pour le format traditionnel
            scores = {anamnese: 0, examen: 0, management: 0, communication: 0};
            maxScores = {anamnese: 41, examen: 18, management: 18, communication: 20};
            coef = {anamnese: 0.25, examen: 0.25, management: 0.25, communication: 0.25};
            sectionInfo = [
                {key: "anamnese", prefix: "a", count: 9, label: "Anamn√®se"},
                {key: "examen", prefix: "e", count: 4, label: "Examen clinique", scoreId: "statusScore"},
                {key: "management", prefix: "m", count: 6, label: "Management"},
                {key: "communication", prefix: "c", count: 5, label: "Communication", isComm: true}
            ];

            // Calcul des scores pour chaque section
            sectionInfo.forEach(section => {
                let sectionScore = 0;
                
                if (section.isComm) {
                    // Section communication sp√©ciale
                    for (let i = 1; i <= section.count; i++) {
                        const radio = document.querySelector("input[name=\"" + section.prefix + i + "\"]:checked");
                        if (radio) {
                            const val = radio.value;
                            const map = { A: 4, B: 3, C: 2, D: 1, E: 0 };
                            sectionScore += map[val] || 0;
                        } else {
                            const criteria = document.querySelector("input[name=\"" + section.prefix + i + "\"][data-criteria]");
                            if (criteria) missingItems.push(section.label + " : " + criteria.dataset.criteria);
                        }
                    }
                } else {
                    // Sections normales
                    for (let i = 1; i <= section.count; i++) {
                        const criterionId = section.prefix + i;
                        // V√©rifier si ce crit√®re a des d√©tails avec checkboxes
                        const detailCheckboxes = document.querySelectorAll('input[id^="' + criterionId + '-detail-"]');
                        
                        if (detailCheckboxes.length > 0) {
                            // Ce crit√®re a des d√©tails, on calcule le score bas√© sur les d√©tails
                            let detailScore = 0;
                            let hasCheckedDetail = false;
                            detailCheckboxes.forEach(checkbox => {
                                if (checkbox.checked) {
                                    detailScore += Number(checkbox.value) || 0;
                                    hasCheckedDetail = true;
                                }
                            });
                            sectionScore += detailScore;
                            
                            if (!hasCheckedDetail) {
                                const criteria = document.querySelector("input[name=\"" + criterionId + "\"][data-criteria]");
                                if (criteria) {
                                    missingItems.push(section.label + " : " + criteria.dataset.criteria);
                                } else {
                                    // Rechercher le texte du crit√®re directement
                                    const criteriaText = document.querySelector("#criteria-" + criterionId + " .criteria-text");
                                    if (criteriaText) {
                                        missingItems.push(section.label + " : " + criteriaText.textContent.split(". ")[1].split(" [")[0]);
                                    }
                                }
                            }
                        } else {
                            // Crit√®re normal sans d√©tails
                            const radio = document.querySelector("input[name=\"" + criterionId + "\"]:checked");
                            if (radio) {
                                sectionScore += Number(radio.value) || 0;
                            } else {
                                const criteria = document.querySelector("input[name=\"" + criterionId + "\"][data-criteria]");
                                if (criteria) missingItems.push(section.label + " : " + criteria.dataset.criteria);
                            }
                        }
                    }
                }
                
                scores[section.key] = sectionScore;
                const scoreId = section.scoreId || section.key + "Score";
                const scoreElement = document.getElementById(scoreId);
                if (scoreElement) scoreElement.textContent = sectionScore;
            });

            // Calcul des pourcentages par section
            let percentages = {};
            let globalPercentage = 0;
            let isStarted = false;
            
            sectionInfo.forEach(section => {
                const score = scores[section.key];
                const max = maxScores[section.key];
                const percentage = max > 0 ? (score / max) * 100 : 0;
                percentages[section.key] = percentage;
                globalPercentage += percentage * coef[section.key];
                if (score > 0) isStarted = true;
            });

            const totalScoreText = isStarted ? Math.round(globalPercentage) : 0;
            document.getElementById("totalScore").textContent = totalScoreText + "%";

            // Mise √† jour des pourcentages affich√©s
            sectionInfo.forEach(section => {
                const percentageElement = document.getElementById(section.key + "-percentage");
                if (percentageElement) {
                    percentageElement.textContent = Math.round(percentages[section.key]);
                }
            });

            const gradeElement = document.getElementById("globalGrade");
            const totalScoreElement = document.getElementById("totalScore");
            const scoreBody = totalScoreElement ? totalScoreElement.closest(".total-body") : null;
            const gradeBody = gradeElement ? gradeElement.closest(".total-body") : null;
            const sections = sectionInfo.map(s => s.key);

            const allClasses = ["note-a", "note-b", "note-c", "note-d", "note-e", "note-neutral"];

            function getClass(p) {
                if (p === 0) return "note-neutral";
                if (p >= 90) return "note-a";
                if (p >= 80) return "note-b";
                if (p >= 70) return "note-c";
                if (p >= 60) return "note-d";
                return "note-e";
            }

            const gradeClass = getClass(globalPercentage);
            const gradeLabel = isStarted ? gradeClass.split("-")[1].toUpperCase() : "A-E";
            if (gradeElement) gradeElement.textContent = gradeLabel;

            const pourcentBody = document.querySelector(".total-pourcent-body");

            [gradeElement, scoreBody, gradeBody, pourcentBody].forEach(el => {
                if (el) {
                    el.classList.remove(...allClasses);
                    el.classList.add(gradeClass);
                }
            });

            sections.forEach(id => {
                const percentageElement = document.getElementById(id + "-percentage");
                if (percentageElement) {
                    const value = parseInt(percentageElement.textContent);
                    const section = percentageElement.closest(".total-pourcent-section");
                    const sectionClass = getClass(value);
                    if (section) {
                        section.classList.remove(...allClasses);
                        section.classList.add(sectionClass);
                    }
                }
            });

            // Appliquer les couleurs aux sections principales
            sectionInfo.forEach(section => {
                const percentage = percentages[section.key];
                const allSections = document.querySelectorAll(".section");
                allSections.forEach(sectionEl => {
                    const headerText = sectionEl.querySelector(".section-header")?.textContent || "";
                    if (headerText.includes(section.label)) {
                        const sectionClass = getClass(percentage);
                        sectionEl.classList.remove(...allClasses);
                        sectionEl.classList.add(sectionClass);
                    }
                });
            });

            if (missingItems.length > 0) {
                document.getElementById("missingItems").style.display = "block";
                document.getElementById("missingList").innerHTML = missingItems.map(item =>
                    "<div class=\"missing-item\">‚Ä¢ " + item + "</div>"
                ).join("");
            } else {
                document.getElementById("missingItems").style.display = "none";
            }
        }
        // MINUTEUR ECOS 13 MINUTES
        window.timerInterval = null;
        window.currentSeconds = 13 * 60;
        window.isRunning = false;
        window.hasStarted = false;
        window.hasFinished = false;
        window.hasStoppedManually = false;

        window.currentMode = 'revision';

        function colorPatientResponses() {
            // Version simplifi√©e inspir√©e du g√©n√©rateur v1
            const elements = document.querySelectorAll('.criteria-text, .sub-criteria, .redflags-text, .dd-item, .therapy-section, .detail-text, .cloture-content');
            elements.forEach(element => {
                const text = element.innerHTML;
                // Colorer uniquement les r√©ponses patient en bleu (pas les examens compl√©mentaires)
                let coloredText = text.replace(/\[([^\]]+)\]/g, '<span style="color: rgb(44, 90, 160); font-weight: 500;">[$1]</span>');
                element.innerHTML = coloredText;
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            switchMode('revision');
            calculateScores();
            colorPatientResponses();
            // Appeler une deuxi√®me fois apr√®s un court d√©lai pour s'assurer que tout est charg√©
            setTimeout(function() {
                colorPatientResponses();
            }, 100);
            // Appel suppl√©mentaire apr√®s un d√©lai plus long pour garantir que tout est charg√©
            setTimeout(function() {
                colorPatientResponses();
            }, 500);
            // Auto-resize tous les textareas au chargement
            const allTextareas = document.querySelectorAll('.comment-textarea');
            allTextareas.forEach(textarea => {
                if (textarea.value) {
                    autoResizeTextarea(textarea);
                }
            });
        });
        
        // S'assurer que la hauteur est bien d√©finie avant l'impression
        window.addEventListener('beforeprint', function() {
            const allTextareas = document.querySelectorAll('.comment-textarea');
            allTextareas.forEach(textarea => {
                if (textarea.value && textarea.value.trim()) {
                    // S'assurer que le textarea a une hauteur d√©finie
                    if (!textarea.style.height || textarea.style.height === 'auto') {
                        autoResizeTextarea(textarea);
                    }
                }
            });
        });


        function initAudio() {
            if (!window.audioContext) {
                window.audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playBeep() {
            initAudio();
            const oscillator = window.audioContext.createOscillator();
            const gainNode = window.audioContext.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(window.audioContext.destination);
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            gainNode.gain.setValueAtTime(0.3, window.audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, window.audioContext.currentTime + 0.5);
            oscillator.start(window.audioContext.currentTime);
            oscillator.stop(window.audioContext.currentTime + 0.5);
        }

        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'fr-FR';
                utterance.rate = 0.9;
                utterance.volume = 0.8;
                speechSynthesis.speak(utterance);
            }
        }

        function playSound(message) {
            playBeep();
            setTimeout(() => speak(message), 500);
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return minutes + ":" + secs.toString().padStart(2, "0");
        }

        function toggleCheckboxes(disabled) {
            const radios = document.querySelectorAll('input[type="radio"]');
            radios.forEach(radio => {
                radio.disabled = disabled;
            });
            const detailCheckboxes = document.querySelectorAll('.detail-checkbox input[type="checkbox"]');
            detailCheckboxes.forEach(checkbox => {
                checkbox.disabled = disabled;
            });
        }

        function colorCriteriaByScore() {
            if (!window.hasFinished && !window.hasStoppedManually) return;

            const normalCriteriaRows = document.querySelectorAll('.criteria-row');
            normalCriteriaRows.forEach(row => {
                const id = row.id;
                if (!id) return;
                const criteriaName = id.replace('criteria-', '');
                const checkedRadio = document.querySelector('input[name="' + criteriaName + '"]:checked');
                row.classList.remove('criteria-zero-points', 'criteria-one-point', 'criteria-full-points', 'criteria-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
                if (checkedRadio) {
                    const score = Number(checkedRadio.value) || 0;
                    if (score === 0) {
                        row.classList.add('criteria-zero-points');
                        row.classList.add('lacune-rouge');
                    } else if (score === 1) {
                        row.classList.add('criteria-one-point');
                        row.classList.add('lacune-orange');
                    } else if (score >= 2) {
                        row.classList.add('criteria-full-points');
                        row.classList.add('lacune-verte');
                    }
                } else {
                    row.classList.add('criteria-not-answered');
                    row.classList.add('lacune-rouge');
                }
            });

            const communicationRows = document.querySelectorAll('.communication-section');
            communicationRows.forEach(row => {
                const id = row.id;
                if (!id) return;
                const criteriaName = id.replace('criteria-', '');
                const checkedRadio = document.querySelector('input[name="' + criteriaName + '"]:checked');
                row.classList.remove('communication-note-a', 'communication-note-b', 'communication-note-c', 'communication-note-d', 'communication-note-e', 'communication-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
                if (checkedRadio) {
                    const grade = checkedRadio.value.toLowerCase();
                    row.classList.add("communication-note-" + grade);
                    if (grade === 'e' || grade === 'd') {
                        row.classList.add('lacune-rouge');
                    } else if (grade === 'c') {
                        row.classList.add('lacune-orange');
                    } else if (grade === 'a' || grade === 'b') {
                        row.classList.add('lacune-verte');
                    }
                } else {
                    row.classList.add('communication-not-answered');
                    row.classList.add('lacune-rouge');
                }
            });
        }

        function startTimer() {
            if (window.isRunning || window.currentMode !== 'exam') return;
            window.isRunning = true;
            window.hasStarted = true;
            window.hasStoppedManually = false;
            document.body.classList.add('timer-running');
            toggleCheckboxes(false);
            playSound("D√©but de la station");
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('stopBtn').style.display = 'inline-block';
            document.getElementById('resetBtn').disabled = true;
            document.getElementById('timerStatus').textContent = 'En cours';
            document.getElementById('timerStatus').className = 'timer-status status-running';
            
            window.timerInterval = setInterval(() => {
                window.currentSeconds--;
                document.getElementById('timerDisplay').textContent = formatTime(window.currentSeconds);
                const container = document.getElementById('timerContainer');
                if (window.currentSeconds === 2 * 60) {
                    if (window.currentMode === 'exam') {
                        playSound("Il vous reste 2 minutes");
                    }
                    container.classList.add('timer-warning');
                    document.getElementById('timerStatus').textContent = '2 min restantes';
                    document.getElementById('timerStatus').className = 'timer-status status-warning';
                }
                if (window.currentSeconds <= 30) {
                    container.classList.add('timer-critical');
                }
                if (window.currentSeconds <= 0) {
                    endTimer();
                }
            }, 1000);
        }

        function stopTimer() {
            if (!window.isRunning) return;
            clearInterval(window.timerInterval);
            window.isRunning = false;
            window.hasStoppedManually = true;
            document.body.classList.remove('timer-running');
            // Ne pas d√©sactiver les checkboxes pour permettre de continuer √† cocher apr√®s arr√™t
            // toggleCheckboxes(true);
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            document.getElementById('resetBtn').disabled = false;
            document.getElementById('timerStatus').textContent = 'Arr√™t√©';
            document.getElementById('timerStatus').className = 'timer-status';
            colorCriteriaByScore();
        }

        function endTimer() {
            clearInterval(window.timerInterval);
            window.isRunning = false;
            window.hasFinished = true;
            window.currentSeconds = 0;
            document.body.classList.remove('timer-running');
            if (window.currentMode === 'exam') {
                playSound("Fin de la station. Veuillez sortir");
                // Repasser automatiquement en mode r√©vision apr√®s la fin du timer
                switchMode('revision');
            }
            document.getElementById('timerDisplay').textContent = '0:00';
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            document.getElementById('resetBtn').disabled = false;
            document.getElementById('timerStatus').textContent = 'Termin√©';
            document.getElementById('timerStatus').className = 'timer-status status-finished';
            document.getElementById('timerStatus').style.display = 'block';
            document.getElementById('timerContainer').className = 'timer-container';
            // Ne pas d√©sactiver les checkboxes apr√®s la fin pour permettre de continuer
            // toggleCheckboxes(true);
            colorCriteriaByScore();
        }

        function resetTimer() {
            clearInterval(window.timerInterval);
            window.timerInterval = null;
            window.currentSeconds = 13 * 60;
            window.isRunning = false;
            window.hasStarted = false;
            window.hasFinished = false;
            window.hasStoppedManually = false;
            document.getElementById('timerDisplay').textContent = '13:00';
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'none';
            // Supprimer la coloration des crit√®res
            const criteriaAndCommRows = document.querySelectorAll('.criteria-row, .communication-section');
            criteriaAndCommRows.forEach(row => {
                row.classList.remove('score-0', 'score-1', 'score-2', 'score-a', 'score-b', 'score-c', 'score-d', 'score-e');
            });
            // Supprimer la coloration des sections
            const allSections = document.querySelectorAll('.section');
            allSections.forEach(section => {
                section.classList.remove('note-a', 'note-b', 'note-c', 'note-d', 'note-e');
                section.classList.add('note-neutral');
            });
            document.getElementById('timerStatus').style.display = 'none';
            document.getElementById('timerContainer').className = 'timer-container';
            // En mode r√©vision, ne pas d√©sactiver les checkboxes
            if (window.currentMode === 'exam') {
                toggleCheckboxes(true);
            }
            const allRadios = document.querySelectorAll('input[type="radio"]');
            allRadios.forEach(radio => {
                radio.checked = false;
            });
            // R√©initialiser les detail-checkboxes
            const allDetailCheckboxes = document.querySelectorAll('.detail-checkbox input[type="checkbox"]');
            allDetailCheckboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            const allPointsDisplays = document.querySelectorAll('.points-display');
            allPointsDisplays.forEach(display => {
                display.textContent = '0';
            });
            const allCriteriaRows = document.querySelectorAll('.criteria-row');
            allCriteriaRows.forEach(row => {
                row.classList.remove('criteria-zero-points', 'criteria-one-point', 'criteria-full-points', 'criteria-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
            });
            const allCommunicationRows = document.querySelectorAll('.communication-section');
            allCommunicationRows.forEach(row => {
                row.classList.remove('communication-note-a', 'communication-note-b', 'communication-note-c', 'communication-note-d', 'communication-note-e', 'communication-not-answered', 'lacune-rouge', 'lacune-orange', 'lacune-verte');
            });
            calculateScores();
            // Supprimer tous les commentaires et cacher les textareas
            const allTextareas = document.querySelectorAll('.comment-textarea');
            allTextareas.forEach(textarea => {
                textarea.value = '';
                textarea.style.height = textarea.classList.contains('comment-textarea') && textarea.closest('.section-comment-section.global') ? '30px' : (textarea.closest('.section-comment-section') ? '28px' : '26px');
            });
            // Cacher toutes les sections de commentaires ouvertes
            const allCommentSections = document.querySelectorAll('.criterion-comment-section.show, .section-comment-section.show');
            allCommentSections.forEach(section => {
                section.classList.remove('show');
            });
            // Mettre √† jour les boutons de commentaires
            const allCommentButtons = document.querySelectorAll('.comment-button, .section-comment-button');
            allCommentButtons.forEach(button => {
                button.classList.remove('has-content');
            });
        }
        
        function switchMode(mode) {
            window.currentMode = mode;
            const body = document.body;
            body.className = mode + '-mode';
            const buttons = document.querySelectorAll('.mode-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            buttons.forEach(btn => {
                if (btn.textContent.includes(mode === "revision" ? "R√©vision" : "Examen")) {
                    btn.classList.add("active");
                }
            });
            if (mode === 'revision') {
                toggleCheckboxes(false);
                showLacunesButton();
            } else {
                if (!window.hasStarted) {
                    toggleCheckboxes(true);
                }
                hideLacunesButton();
            }
        }
        
        function showLacunesButton() {
            const btn = document.querySelector('.lacune-button');
            if (btn) btn.style.display = 'block';
        }
        
        function hideLacunesButton() {
            const btn = document.querySelector('.lacune-button');
            if (btn) btn.style.display = 'none';
        }
        
        function identifyLacunes() {
            // Crit√®res standards (anamn√®se, examen, management)
            const criteria = document.querySelectorAll(".criteria-row");
            criteria.forEach(criterion => {
                const id = criterion.id.replace("criteria-", "");
                const pointsElement = document.getElementById("points-" + id);
                const points = pointsElement ? parseInt(pointsElement.textContent) : 0;
                
                criterion.classList.remove("lacune-rouge", "lacune-orange", "lacune-verte");
                
                if (points === 0) {
                    criterion.classList.add("lacune-rouge");
                } else if (points === 1) {
                    criterion.classList.add("lacune-orange");
                } else if (points >= 2) {
                    criterion.classList.add("lacune-verte");
                }
            });
            
            // Crit√®res communication (√©chelle A-E)
            const commCriteria = document.querySelectorAll(".communication-section");
            commCriteria.forEach(criterion => {
                const id = criterion.id.replace("criteria-", "");
                const radio = document.querySelector("input[name=\"" + id + "\"]:checked");
                
                criterion.classList.remove("lacune-rouge", "lacune-orange", "lacune-verte");
                
                if (!radio) {
                    criterion.classList.add("lacune-rouge");
                } else {
                    const grade = radio.value;
                    if (grade === "E" || grade === "D") {
                        criterion.classList.add("lacune-rouge");
                    } else if (grade === "C") {
                        criterion.classList.add("lacune-orange");
                    } else if (grade === "A" || grade === "B") {
                        criterion.classList.add("lacune-verte");
                    }
                }
            });
        }
        function toggleComment(id) {
            const section = document.getElementById("comment-section-" + id);
            const textarea = document.getElementById("comment-" + id);
            if (section) {
                section.classList.toggle("show");
                // Focus automatiquement sur le textarea quand on ouvre la section
                if (section.classList.contains("show") && textarea) {
                    textarea.focus();
                }
            }
        }

        function updateCommentButton(id) {
            const textarea = document.getElementById("comment-" + id);
            const criterionRow = document.getElementById("criteria-" + id);
            const commentSection = document.getElementById("comment-section-" + id);
            if (textarea && criterionRow) {
                const button = criterionRow.querySelector(".comment-button");
                if (button) {
                    if (textarea.value.trim()) {
                        button.classList.add("has-content");
                        if (commentSection) commentSection.classList.add("has-content");
                    } else {
                        button.classList.remove("has-content");
                        if (commentSection) commentSection.classList.remove("has-content");
                    }
                }
            }
        }

        function toggleSectionComment(section) {
            const commentSection = document.getElementById("section-comment-" + section);
            const textarea = document.getElementById("comment-section-" + section);
            if (commentSection) {
                commentSection.classList.toggle("show");
                // Focus automatiquement sur le textarea quand on ouvre la section
                if (commentSection.classList.contains("show") && textarea) {
                    textarea.focus();
                }
            }
        }

        function updateSectionComment(section) {
            const textarea = document.getElementById("comment-section-" + section);
            const commentSection = document.getElementById("section-comment-" + section);
            const buttons = document.querySelectorAll(".section-comment-button");
            buttons.forEach(button => {
                if (button.getAttribute("onclick") && button.getAttribute("onclick").includes(section)) {
                    if (textarea && textarea.value.trim()) {
                        button.classList.add("has-content");
                        if (commentSection) commentSection.classList.add("has-content");
                    } else {
                        button.classList.remove("has-content");
                        if (commentSection) commentSection.classList.remove("has-content");
                    }
                }
            });
        }

        function updateGeneralComment() {
            const textarea = document.getElementById("comment-general");
            if (textarea) {
                const section = textarea.closest(".section-comment-section");
                if (section) {
                    if (textarea.value.trim()) {
                        section.classList.add("has-content");
                    } else {
                        section.classList.remove("has-content");
                    }
                }
            }
        }

        function autoResizeTextarea(textarea) {
            // Reset height to auto to get correct scrollHeight
            textarea.style.height = "auto";
            // Set new height based on content
            const newHeight = textarea.scrollHeight + 2;
            textarea.style.height = newHeight + "px";
        }

    </script>
    <!-- BOUTON IMPRIMER EN PDF -->
    <button class="print-button" onclick="window.print()">üñ®Ô∏è Imprimer en PDF</button>
    <script>
        // Appel final pour s'assurer que tout est color√©
        // Forcer la coloration finale
        if (window.colorPatientResponses) {
            window.colorPatientResponses();
        }
    </script>
</body>
</html>